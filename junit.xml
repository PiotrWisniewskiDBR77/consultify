<?xml version="1.0" encoding="UTF-8" ?>
<testsuites name="vitest tests" tests="1420" failures="225" errors="0" time="24.517766834">
    <testsuite name="tests/unit/actionProposalEngine.test.js" timestamp="2025-12-21T11:37:25.768Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.19318075">
        <testcase classname="tests/unit/actionProposalEngine.test.js" name="ActionProposalEngine &gt; should generate proposals for USER_AT_RISK" time="0.006309542">
        </testcase>
        <testcase classname="tests/unit/actionProposalEngine.test.js" name="ActionProposalEngine &gt; should generate proposals for BLOCKED_INITIATIVE" time="0.000172375">
        </testcase>
        <testcase classname="tests/unit/actionProposalEngine.test.js" name="ActionProposalEngine &gt; should generate proposals for STRONG_TEAM_MEMBER" time="0.000152917">
        </testcase>
        <testcase classname="tests/unit/actionProposalEngine.test.js" name="ActionProposalEngine &gt; should be deterministic (return same output for same input)" time="0.000147542">
        </testcase>
        <testcase classname="tests/unit/actionProposalEngine.test.js" name="ActionProposalEngine &gt; should return sorted proposals by proposal_id" time="0.000292875">
        </testcase>
        <testcase classname="tests/unit/actionProposalEngine.test.js" name="ActionProposalEngine &gt; should adhere to the mandatory output model" time="0.0003265">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/aiPlaybookRoutingEngine.test.js" timestamp="2025-12-21T11:37:25.769Z" hostname="MacBook-Pro-Piotr.local" tests="29" failures="0" errors="0" skipped="0" time="0.199590083">
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; metric_lte &gt; should match when metric is less than threshold" time="0.000698917">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; metric_lte &gt; should match when metric equals threshold" time="0.000097208">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; metric_lte &gt; should not match when metric is greater than threshold" time="0.000070375">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; metric_lte &gt; should not match when metric is not found" time="0.000069084">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; metric_lte &gt; should return false for invalid format" time="0.000069958">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; metric_gte &gt; should match when metric is greater than threshold" time="0.000064041">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; metric_gte &gt; should match when metric equals threshold" time="0.000050709">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; metric_gte &gt; should not match when metric is less than threshold" time="0.000041541">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; flag_eq &gt; should match when flag equals expected value" time="0.000054458">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; flag_eq &gt; should not match when flag does not equal expected value" time="0.000061542">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; flag_eq &gt; should work with string values" time="0.000050292">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; has_open_tasks &gt; should match when open tasks exist and condition is true" time="0.000050125">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; has_open_tasks &gt; should match when no open tasks and condition is false" time="0.00003825">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; has_open_tasks &gt; should recognize in_progress as open" time="0.000037459">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; has_open_tasks &gt; should recognize PENDING as open" time="0.000034375">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; signal_present &gt; should match when signal is present" time="0.000053292">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; signal_present &gt; should not match when signal is not present" time="0.000037125">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; signal_present &gt; should handle simple string signals" time="0.000050292">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; time_since_step_gte &gt; should match when enough time has passed" time="0.000170209">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; time_since_step_gte &gt; should not match when not enough time has passed" time="0.000062042">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; time_since_step_gte &gt; should not match when step timestamp not found" time="0.000051375">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; unknown conditions &gt; should fail safely for unknown condition type" time="0.000184416">
            <system-err>
[AIPlaybookRoutingEngine] Unknown condition type: unknown_condition

            </system-err>
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateCondition &gt; unknown conditions &gt; should fail safely for empty condition" time="0.000061708">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateRouting &gt; should select first matching rule in first_match mode" time="0.000131666">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateRouting &gt; should use else_goto when no rules match" time="0.000046791">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateRouting &gt; should return null when no rules match and no else_goto" time="0.000049125">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateRouting &gt; should use linear flow when no branch_rules defined" time="0.000035041">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateRouting &gt; should record evaluation trace" time="0.000336166">
        </testcase>
        <testcase classname="tests/unit/aiPlaybookRoutingEngine.test.js" name="AIPlaybookRoutingEngine &gt; evaluateRouting &gt; should skip rules with invalid conditions" time="0.000049208">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/aiResponsePostProcessor.test.js" timestamp="2025-12-21T11:37:25.772Z" hostname="MacBook-Pro-Piotr.local" tests="20" failures="0" errors="0" skipped="0" time="0.200977292">
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Memory Prefix &gt; should add memory prefix when memory count &gt; 0" time="0.000596167">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Memory Prefix &gt; should NOT add memory prefix when memory count is 0" time="0.000156666">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Memory Prefix &gt; should NOT duplicate memory prefix if already present" time="0.000082917">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; External Sources Prefix &gt; should add external prefix when external sources are used" time="0.000082875">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; External Sources Prefix &gt; should NOT add external prefix when no external sources" time="0.000075375">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; External Sources Prefix &gt; should NOT duplicate external prefix if already present" time="0.000052708">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Combined Prefixes &gt; should add both prefixes when both memory and external sources exist" time="0.000064083">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Combined Prefixes &gt; should maintain correct order: memory first, then external" time="0.000055958">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Edge Cases &gt; should handle empty response safely" time="0.000042083">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Edge Cases &gt; should handle null response safely" time="0.000051042">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Edge Cases &gt; should handle undefined context safely" time="0.000035625">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Edge Cases &gt; should handle null context safely" time="0.000030291">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Edge Cases &gt; should trim whitespace from response" time="0.000030458">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; getMemoryCount &gt; should count previous decisions" time="0.000036791">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; getMemoryCount &gt; should return memoryCount from projectMemory" time="0.000046042">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; getMemoryCount &gt; should return 1 when PMO health snapshot exists" time="0.000039708">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; getExternalSources &gt; should return externalSourcesUsed array" time="0.000281334">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; getExternalSources &gt; should derive sources from fetchedData" time="0.00033375">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; stripPrefixes &gt; should remove memory and external prefixes" time="0.000095792">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; stripPrefixes &gt; should handle text without prefixes" time="0.00004175">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/aiRoleGuard.test.js" timestamp="2025-12-21T11:37:25.773Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="0" errors="0" skipped="0" time="0.173204292">
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Role Definitions &gt; should define three roles in correct hierarchy" time="0.000751042">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Role Definitions &gt; should define capabilities for each role" time="0.000188333">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Role Descriptions &gt; should return correct description for each role" time="0.000125917">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Role Descriptions &gt; should default to ADVISOR description for unknown role" time="0.000054667">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; ADVISOR Role &gt; should allow explain actions" time="0.000182083">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; ADVISOR Role &gt; should block draft creation" time="0.000089875">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; ADVISOR Role &gt; should block execution actions" time="0.00005375">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; MANAGER Role &gt; should allow draft creation with approval required" time="0.00006625">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; MANAGER Role &gt; should block execution actions" time="0.000058917">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; OPERATOR Role &gt; should allow execution actions" time="0.000072958">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; OPERATOR Role &gt; should allow entity modifications" time="0.000060208">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Mutation Validation &gt; should block all mutations for ADVISOR" time="0.000066375">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Mutation Validation &gt; should allow mutations as drafts for MANAGER" time="0.000054541">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Mutation Validation &gt; should allow direct mutations for OPERATOR" time="0.000052666">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; isActionBlocked &gt; should return blocked with required role for insufficient permissions" time="0.000082917">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; isActionBlocked &gt; should return not blocked for allowed actions" time="0.000039875">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/analytics.service.test.ts" timestamp="2025-12-21T11:37:25.774Z" hostname="MacBook-Pro-Piotr.local" tests="8" failures="0" errors="0" skipped="0" time="0.288456917">
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; calculateAnalytics &gt; calculates analytics for empty arrays" time="0.001297542">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; calculateAnalytics &gt; calculates completion rate correctly" time="0.000333333">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; calculateAnalytics &gt; calculates initiative statistics" time="0.000159709">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; calculateAnalytics &gt; calculates total cost and benefit" time="0.000073792">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; generateBurnDownData &gt; generates burn down data for date range" time="0.000241041">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; generateBurnDownData &gt; handles empty task list" time="0.000059583">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; generateVelocityData &gt; generates velocity data for specified weeks" time="0.000117625">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; generateVelocityData &gt; uses default 8 weeks when not specified" time="0.000053417">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/api.service.test.ts" timestamp="2025-12-21T11:37:25.774Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.185768167">
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; login: should store token and return user on success" time="0.001943959">
            <system-out>
Api.login called: { email: &apos;test@test.com&apos;, url: &apos;/api/auth/login&apos; }

            </system-out>
        </testcase>
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; login: should throw error on failure" time="0.000664666">
            <system-out>
Api.login called: { email: &apos;test@test.com&apos;, url: &apos;/api/auth/login&apos; }

            </system-out>
        </testcase>
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; getUsers: should send Authorization header" time="0.000311125">
        </testcase>
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; getLLMProviders: should return list" time="0.000097958">
        </testcase>
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; indexKnowledgeFiles: should trigger indexing" time="0.000160959">
        </testcase>
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; saveSession: should post data" time="0.000149959">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/asyncJobService.test.js" timestamp="2025-12-21T11:37:25.775Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="0" errors="0" skipped="0" time="0.298664334">
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; JOB_TYPES Constants &gt; should export EXECUTE_DECISION type" time="0.088232042">
            <system-out>
[Queue] Using Mock Queue for ai-tasks

            </system-out>
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; JOB_TYPES Constants &gt; should export ADVANCE_PLAYBOOK_STEP type" time="0.002507083">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; JOB_STATUSES Constants &gt; should export all required statuses" time="0.002159875">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; JOB_STATUSES Constants &gt; should have 6 status types" time="0.001753459">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; Service Methods Existence &gt; should export enqueueActionExecution" time="0.00244675">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; Service Methods Existence &gt; should export enqueuePlaybookAdvance" time="0.001214333">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; Service Methods Existence &gt; should export getJob" time="0.001079125">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; Service Methods Existence &gt; should export listJobs" time="0.00125275">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; Service Methods Existence &gt; should export retryJob" time="0.001694042">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; Service Methods Existence &gt; should export cancelJob" time="0.001236208">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; Service Methods Existence &gt; should export updateJobStatus" time="0.001301792">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; Service Methods Existence &gt; should export markDeadLetter" time="0.001470458">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobService Constants and Logic &gt; Service Methods Existence &gt; should export incrementAttempts" time="0.001343042">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="Action Error Codes &gt; should include async job error codes" time="0.002953291">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobProcessor &gt; should export processDecisionExecution" time="0.010732292">
        </testcase>
        <testcase classname="tests/unit/asyncJobService.test.js" name="AsyncJobProcessor &gt; should export processPlaybookAdvance" time="0.000651084">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/breakGlassService.test.js" timestamp="2025-12-21T11:37:25.775Z" hostname="MacBook-Pro-Piotr.local" tests="15" failures="0" errors="0" skipped="0" time="0.177618">
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; SCOPES &gt; should define all break-glass scopes" time="0.000618292">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; DEFAULT_DURATION_MINUTES &gt; should be 2 hours (120 minutes)" time="0.000093708">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; MAX_DURATION_MINUTES &gt; should be 24 hours (1440 minutes)" time="0.000060791">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; startSession &gt; should throw error for missing required parameters" time="0.000583">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; startSession &gt; should throw error for invalid scope" time="0.000121208">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; startSession &gt; should throw error if session already exists for scope" time="0.000311958">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; startSession &gt; should create session successfully" time="0.000258584">
            <system-out>
[BreakGlass] Session started: test-uuid-1234 (scope: policy_engine_disabled) by user-1

            </system-out>
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; startSession &gt; should cap duration at MAX_DURATION_MINUTES" time="0.000144625">
            <system-out>
[BreakGlass] Session started: test-uuid-1234 (scope: emergency_access) by user-1

            </system-out>
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; closeSession &gt; should throw error for non-existent session" time="0.00017">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; closeSession &gt; should throw error for already closed session" time="0.000128417">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; closeSession &gt; should close session successfully" time="0.00020625">
            <system-out>
[BreakGlass] Session closed: session-1 by user-1

            </system-out>
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; isBreakGlassActive &gt; should return false when no active session" time="0.0000515">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; isBreakGlassActive &gt; should return true when active session exists" time="0.000054167">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; getActiveSessions &gt; should return empty array when no sessions" time="0.0002695">
        </testcase>
        <testcase classname="tests/unit/breakGlassService.test.js" name="BreakGlassService &gt; getActiveSessions &gt; should return active sessions" time="0.000304292">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/connectorAdapter.test.js" timestamp="2025-12-21T11:37:25.776Z" hostname="MacBook-Pro-Piotr.local" tests="11" failures="0" errors="0" skipped="0" time="0.284408917">
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Dry-run Mode &gt; should return plan without execution in dry-run mode" time="0.006678625">
        </testcase>
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Dry-run Mode &gt; should respect sandbox_mode flag on config" time="0.000349584">
        </testcase>
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Error Handling &gt; should return error for unknown connector" time="0.000231125">
        </testcase>
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Error Handling &gt; should return error for unsupported action" time="0.000169667">
        </testcase>
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Error Handling &gt; should return error when connector not configured" time="0.000222375">
        </testcase>
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Error Handling &gt; should return error when connector disconnected" time="0.000133167">
        </testcase>
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Plan Generation &gt; should generate Jira plan for issue_create" time="0.000493333">
        </testcase>
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Plan Generation &gt; should generate Slack plan for message_send" time="0.000198458">
        </testcase>
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Plan Generation &gt; should generate Google Calendar plan for event_create" time="0.000181583">
        </testcase>
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Execution (Mock) &gt; should execute Slack message_send successfully" time="0.000230083">
        </testcase>
        <testcase classname="tests/unit/connectorAdapter.test.js" name="ConnectorAdapter &gt; Execution (Mock) &gt; should include duration_ms in result" time="0.000133084">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/connectorRegistry.test.js" timestamp="2025-12-21T11:37:25.777Z" hostname="MacBook-Pro-Piotr.local" tests="14" failures="0" errors="0" skipped="0" time="0.217768083">
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; getAllConnectors &gt; should return all available connectors" time="0.002038542">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; getConnector &gt; should return connector by key" time="0.000382125">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; getConnector &gt; should return null for unknown connector" time="0.000228667">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; getConnectorsByCategory &gt; should return connectors filtered by category" time="0.000253666">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; getConnectorsByCategory &gt; should return empty array for unknown category" time="0.00056525">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; hasCapability &gt; should return true for supported capability" time="0.000220792">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; hasCapability &gt; should return false for unsupported capability" time="0.000154">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; hasCapability &gt; should return false for unknown connector" time="0.000112375">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; validateCredentials &gt; should validate all required credentials present" time="0.000212209">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; validateCredentials &gt; should identify missing required credentials" time="0.00027275">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; validateCredentials &gt; should handle unknown connector" time="0.000207875">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; getRequiredCredentials &gt; should return required credentials for connector" time="0.000186917">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; getRequiredCredentials &gt; should return empty array for unknown connector" time="0.0000995">
        </testcase>
        <testcase classname="tests/unit/connectorRegistry.test.js" name="ConnectorRegistry &gt; getAllCategories &gt; should return all categories" time="0.000316667">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/demoGuard.test.js" timestamp="2025-12-21T11:37:25.777Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.261300583">
        <testcase classname="tests/unit/demoGuard.test.js" name="Demo Guard Middleware &gt; should allow regular users to perform write operations" time="0.012012375">
        </testcase>
        <testcase classname="tests/unit/demoGuard.test.js" name="Demo Guard Middleware &gt; should allow demo users to perform read operations" time="0.00146675">
        </testcase>
        <testcase classname="tests/unit/demoGuard.test.js" name="Demo Guard Middleware &gt; should BLOCK demo users from performing write operations on protected routes" time="0.002222875">
            <system-err>
[DemoGuard] Blocked POST /api/tasks for Demo User undefined (Action: CREATE_TASKS)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/demoGuard.test.js" name="Demo Guard Middleware &gt; should ALLOW demo users to perform write operations on ALLOWED routes (AI Chat)" time="0.001090583">
        </testcase>
        <testcase classname="tests/unit/demoGuard.test.js" name="Demo Guard Middleware &gt; should ALLOW demo users to perform write operations on ALLOWED routes (Logout)" time="0.001029917">
        </testcase>
        <testcase classname="tests/unit/demoGuard.test.js" name="Demo Guard Middleware &gt; should passthrough if no user matches (unauthenticated requests handled elsewhere)" time="0.000899458">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/demoIsolation.test.js" timestamp="2025-12-21T11:37:25.778Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.186910458">
        <testcase classname="tests/unit/demoIsolation.test.js" name="Demo Guard Isolation Extension &gt; should allow Normal GET for demo user" time="0.007308792">
        </testcase>
        <testcase classname="tests/unit/demoIsolation.test.js" name="Demo Guard Isolation Extension &gt; should BLOCK demo user if they try to switch context via Query Param" time="0.001362666">
            <system-err>
[DemoGuard] Blocked cross-tenant access attempt by Demo User undefined (Target: org-real, Actual: org-demo)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/demoIsolation.test.js" name="Demo Guard Isolation Extension &gt; should BLOCK demo user if they try to switch context via Body" time="0.006978667">
            <system-err>
[DemoGuard] Blocked cross-tenant access attempt by Demo User undefined (Target: org-real, Actual: org-demo)

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/drdStructure.test.ts" timestamp="2025-12-21T11:37:25.778Z" hostname="MacBook-Pro-Piotr.local" tests="7" failures="0" errors="0" skipped="0" time="0.174754834">
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; exports DRD_STRUCTURE as array" time="0.001108583">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; each axis has required properties" time="0.000709291">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; each area has required properties" time="0.001199083">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; each level has required properties" time="0.005189208">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; getQuestionsForAxis &gt; returns areas for valid axis ID" time="0.0001205">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; getQuestionsForAxis &gt; returns empty array for invalid axis ID" time="0.000285542">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; getQuestionsForAxis &gt; returns areas for different axis IDs" time="0.000086708">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/governanceAudit.test.js" timestamp="2025-12-21T11:37:25.778Z" hostname="MacBook-Pro-Piotr.local" tests="8" failures="0" errors="0" skipped="0" time="0.142997125">
        <testcase classname="tests/unit/governanceAudit.test.js" name="GovernanceAuditService &gt; logAudit &gt; should throw error for missing required parameters" time="0.001246875">
        </testcase>
        <testcase classname="tests/unit/governanceAudit.test.js" name="GovernanceAuditService &gt; logAudit &gt; should throw error for invalid action" time="0.00023575">
        </testcase>
        <testcase classname="tests/unit/governanceAudit.test.js" name="GovernanceAuditService &gt; logAudit &gt; should log audit entry successfully" time="0.000745667">
            <system-out>
[GovernanceAudit] Logged: CREATE on POLICY_RULE/rule-1 by user-1

            </system-out>
        </testcase>
        <testcase classname="tests/unit/governanceAudit.test.js" name="GovernanceAuditService &gt; getAuditLog &gt; should query with organization filter" time="0.000263458">
        </testcase>
        <testcase classname="tests/unit/governanceAudit.test.js" name="GovernanceAuditService &gt; getAuditLog &gt; should bypass org filter for superadmin" time="0.000149042">
        </testcase>
        <testcase classname="tests/unit/governanceAudit.test.js" name="GovernanceAuditService &gt; getAuditLog &gt; should support action filter" time="0.000307791">
        </testcase>
        <testcase classname="tests/unit/governanceAudit.test.js" name="GovernanceAuditService &gt; exportAuditLog &gt; should export as JSON by default" time="0.000148584">
        </testcase>
        <testcase classname="tests/unit/governanceAudit.test.js" name="GovernanceAuditService &gt; exportAuditLog &gt; should export as CSV when specified" time="0.000156042">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/notificationOutboxService.test.js" timestamp="2025-12-21T11:37:25.779Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="0" errors="0" skipped="0" time="0.21436625">
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; NOTIFICATION_TYPES Constants &gt; should export APPROVAL_DUE type" time="0.007557083">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; NOTIFICATION_TYPES Constants &gt; should export PLAYBOOK_STUCK type" time="0.001367292">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; NOTIFICATION_TYPES Constants &gt; should export DEAD_LETTER type" time="0.001477208">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; NOTIFICATION_TYPES Constants &gt; should export ESCALATION type" time="0.001653333">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; NOTIFICATION_TYPES Constants &gt; should have 4 notification types" time="0.003359541">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; OUTBOX_STATUSES Constants &gt; should export QUEUED status" time="0.002185917">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; OUTBOX_STATUSES Constants &gt; should export SENT status" time="0.001673917">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; OUTBOX_STATUSES Constants &gt; should export FAILED status" time="0.001502125">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; MAX_ATTEMPTS &gt; should be 3" time="0.001197125">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; Service Methods Existence &gt; should export enqueue" time="0.002398958">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; Service Methods Existence &gt; should export shouldNotify" time="0.001200583">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; Service Methods Existence &gt; should export getUserPreferences" time="0.00123675">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; Service Methods Existence &gt; should export updateUserPreferences" time="0.00128325">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; Service Methods Existence &gt; should export processQueue" time="0.002333709">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService Constants and Logic &gt; Service Methods Existence &gt; should export getOutboxStats" time="0.002481417">
        </testcase>
        <testcase classname="tests/unit/notificationOutboxService.test.js" name="NotificationOutboxService User Preferences &gt; should return true when no preferences set (default behavior)" time="0.00175575">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/pdfExport.test.ts" timestamp="2025-12-21T11:37:25.779Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.17608075">
        <testcase classname="tests/unit/pdfExport.test.ts" name="Service Test: pdfExport &gt; exportReportToPDF &gt; returns false when element is not found" time="0.002214667">
            <system-err>
Element with id non-existent not found

            </system-err>
        </testcase>
        <testcase classname="tests/unit/pdfExport.test.ts" name="Service Test: pdfExport &gt; exportReportToPDF &gt; exports PDF successfully" time="0.001194084">
        </testcase>
        <testcase classname="tests/unit/pdfExport.test.ts" name="Service Test: pdfExport &gt; exportReportToPDF &gt; handles errors gracefully" time="0.00133575">
            <system-err>
PDF Export failed: Error: Canvas error
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/pdfExport.test.ts:89:52
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:12)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/pdfExport.test.ts" name="Service Test: pdfExport &gt; exportDashboardToPDF &gt; creates PDF with metadata" time="0.0099895">
        </testcase>
        <testcase classname="tests/unit/pdfExport.test.ts" name="Service Test: pdfExport &gt; exportDashboardToPDF &gt; handles optional metadata" time="0.0004785">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/piiRedactor.test.js" timestamp="2025-12-21T11:37:25.780Z" hostname="MacBook-Pro-Piotr.local" tests="17" failures="0" errors="0" skipped="0" time="0.202761917">
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redactEmails &gt; should redact email addresses" time="0.001397542">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redactEmails &gt; should redact multiple emails" time="0.000246083">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redactEmails &gt; should return non-string values unchanged" time="0.000263666">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redactTokens &gt; should redact JWT-like tokens" time="0.000425958">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redactTokens &gt; should handle partial JWT patterns" time="0.000158042">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redact (deep object redaction) &gt; should redact email fields" time="0.000272375">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redact (deep object redaction) &gt; should redact name fields" time="0.000164125">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redact (deep object redaction) &gt; should redact password fields" time="0.000502583">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redact (deep object redaction) &gt; should redact token and secret fields" time="0.000330958">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redact (deep object redaction) &gt; should redact inline emails in string values" time="0.000149916">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redact (deep object redaction) &gt; should handle arrays with email strings" time="0.0001285">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redact (deep object redaction) &gt; should handle nested objects" time="0.000079875">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redact (deep object redaction) &gt; should not mutate original object" time="0.000059334">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redact (deep object redaction) &gt; should handle null and undefined" time="0.000091333">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; redactKeys &gt; should redact specific keys" time="0.000374375">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; createAuditSnapshot &gt; should return JSON string with redacted PII" time="0.000193333">
        </testcase>
        <testcase classname="tests/unit/piiRedactor.test.js" name="PII Redactor &gt; DEFAULT_PII_FIELDS &gt; should include common PII fields" time="0.000873166">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/policyEngine.test.js" timestamp="2025-12-21T11:37:25.781Z" hostname="MacBook-Pro-Piotr.local" tests="21" failures="0" errors="0" skipped="0" time="0.231095833">
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; Safety Guardrails Constants &gt; NEVER_AUTO_APPROVE_RISK_LEVELS should include HIGH" time="0.0012555">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; Safety Guardrails Constants &gt; ALWAYS_MANUAL_ACTION_TYPES should include MEETING_SCHEDULE" time="0.000132333">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; Safety Guardrails Constants &gt; should not include LOW in NEVER_AUTO_APPROVE_RISK_LEVELS" time="0.000114666">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; risk_level_lte &gt; should match when proposal risk is lower or equal" time="0.000154209">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; risk_level_lte &gt; should not match when proposal risk is higher" time="0.000085334">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; action_type_in &gt; should match when action type is in list" time="0.000081">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; action_type_in &gt; should not match when action type is not in list" time="0.000063583">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; action_type_in &gt; should return false for non-array input" time="0.000040542">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; scope_eq &gt; should match when scope equals" time="0.000066">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; scope_eq &gt; should not match when scope differs" time="0.000070167">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; signal_in &gt; should match when signal is in list" time="0.000048208">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; signal_in &gt; should not match when signal is not in list" time="0.000043209">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; signal_in &gt; should return false for non-array input" time="0.000061042">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; time_window &gt; should always match for anytime" time="0.000057084">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; CONDITION_HANDLERS (Pure Functions) &gt; time_window &gt; should return false for unrecognized values" time="0.000034458">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; evaluateConditions (Logic Tests) &gt; should return true when all conditions match" time="0.000067792">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; evaluateConditions (Logic Tests) &gt; should return false when any condition fails" time="0.000034042">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; evaluateConditions (Logic Tests) &gt; should return false for unknown conditions (safety)" time="0.000144166">
            <system-err>
[PolicyEngine] Unknown condition: unknown_condition

            </system-err>
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Core Logic &gt; evaluateConditions (Logic Tests) &gt; should return true for empty conditions" time="0.000034458">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Safety Checks &gt; HIGH risk is in NEVER_AUTO_APPROVE list" time="0.00003275">
        </testcase>
        <testcase classname="tests/unit/policyEngine.test.js" name="PolicyEngine Safety Checks &gt; MEETING_SCHEDULE is in ALWAYS_MANUAL list" time="0.000032917">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/regulatoryModeGuard.test.js" timestamp="2025-12-21T11:37:25.782Z" hostname="MacBook-Pro-Piotr.local" tests="31" failures="0" errors="0" skipped="0" time="0.23818725">
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Action Classification &gt; ALLOWED_ACTIONS &gt; should include all advisory-only actions" time="0.000916167">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Action Classification &gt; BLOCKED_ACTIONS &gt; should include all mutation actions" time="0.000197709">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should allow EXPLAIN_CONTEXT in regulatory mode" time="0.000113208">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should allow ANALYZE_RISKS in regulatory mode" time="0.000051292">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should allow EDUCATE in regulatory mode" time="0.0000575">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK CREATE_DRAFT_TASK in regulatory mode" time="0.000039375">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK CREATE_DRAFT_INITIATIVE in regulatory mode" time="0.000044417">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK UPDATE_STATUS in regulatory mode" time="0.0000455">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK EXECUTE_ACTION in regulatory mode" time="0.000041125">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK MODIFY_ENTITY in regulatory mode" time="0.000052666">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK DELETE_ENTITY in regulatory mode" time="0.000038583">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should block actions containing mutation keywords" time="0.000073">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should allow actions without mutation keywords" time="0.000045166">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should handle null/undefined action gracefully" time="0.000035375">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Regulatory Mode Prompt &gt; should contain prohibition statements" time="0.00006275">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Regulatory Mode Prompt &gt; should forbid action verbs" time="0.000050667">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Regulatory Mode Prompt &gt; should require advisory language" time="0.000041">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Regulatory Mode Prompt &gt; should include example responses" time="0.000033083">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Forbidden Verbs List &gt; should contain all dangerous verbs" time="0.000226125">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Advisory Phrases List &gt; should contain recommended advisory language" time="0.000069333">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should block CREATE_DRAFT_TASK when regulatory mode is enabled" time="0.0001765">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should block UPDATE_STATUS when regulatory mode is enabled" time="0.000062334">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should allow EXPLAIN_CONTEXT when regulatory mode is enabled" time="0.000054917">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should allow ANALYZE_RISKS when regulatory mode is enabled" time="0.000059583">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should NOT block actions when regulatory mode is disabled" time="0.000041917">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should NOT block when no projectId is provided" time="0.000034666">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should log blocked attempts to audit trail" time="0.000507875">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; getStatus &gt; should return full status object when enabled" time="0.000106625">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; getStatus &gt; should return full status object when disabled" time="0.000042541">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Integration with AI Role System &gt; should override ANY role when regulatory mode is active" time="0.000104333">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Safety: Fail-Safe Behavior &gt; should default to blocking when database error occurs" time="0.000026875">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/roi.test.ts" timestamp="2025-12-21T11:37:25.783Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.211507042">
        <testcase classname="tests/unit/roi.test.ts" name="Unit Test: ROI Calculation &gt; should calculate ROI correctly for positive values" time="0.000501583">
        </testcase>
        <testcase classname="tests/unit/roi.test.ts" name="Unit Test: ROI Calculation &gt; should handle zero cost to avoid infinity" time="0.00008275">
        </testcase>
        <testcase classname="tests/unit/roi.test.ts" name="Unit Test: ROI Calculation &gt; should return 0 for break-even" time="0.000072709">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/secretsVault.test.js" timestamp="2025-12-21T11:37:25.783Z" hostname="MacBook-Pro-Piotr.local" tests="12" failures="0" errors="0" skipped="0" time="0.313316125">
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Encryption/Decryption &gt; should encrypt and decrypt a string successfully" time="0.001760917">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Encryption/Decryption &gt; should encrypt and decrypt an object successfully" time="0.000264292">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Encryption/Decryption &gt; should return null when decrypting null/undefined" time="0.000092542">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Encryption/Decryption &gt; should throw on invalid encrypted data" time="0.000323625">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Encryption/Decryption &gt; should produce different ciphertext for same plaintext (random IV)" time="0.000182875">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Redaction &gt; should redact string values showing only last 4 characters" time="0.00007975">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Redaction &gt; should fully redact short strings" time="0.000052166">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Redaction &gt; should recursively redact nested objects" time="0.000063542">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Redaction &gt; should return empty object for null/undefined" time="0.00007">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Validation &gt; should validate present fields as valid" time="0.000091708">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Validation &gt; should identify missing fields" time="0.000373416">
        </testcase>
        <testcase classname="tests/unit/secretsVault.test.js" name="SecretsVault Service &gt; Validation &gt; should handle null/undefined secrets" time="0.000099791">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/slaService.test.js" timestamp="2025-12-21T11:37:25.784Z" hostname="MacBook-Pro-Piotr.local" tests="7" failures="0" errors="0" skipped="0" time="0.191233167">
        <testcase classname="tests/unit/slaService.test.js" name="SLAService Constants and Logic &gt; SLA_CHECK_INTERVAL_MS &gt; should be 10 minutes in milliseconds" time="0.006988875">
        </testcase>
        <testcase classname="tests/unit/slaService.test.js" name="SLAService Constants and Logic &gt; Service Methods Existence &gt; should export findExpiredAssignments" time="0.001379667">
        </testcase>
        <testcase classname="tests/unit/slaService.test.js" name="SLAService Constants and Logic &gt; Service Methods Existence &gt; should export markExpired" time="0.001444708">
        </testcase>
        <testcase classname="tests/unit/slaService.test.js" name="SLAService Constants and Logic &gt; Service Methods Existence &gt; should export findOrgAdmin" time="0.001715459">
        </testcase>
        <testcase classname="tests/unit/slaService.test.js" name="SLAService Constants and Logic &gt; Service Methods Existence &gt; should export escalateAssignment" time="0.001184542">
        </testcase>
        <testcase classname="tests/unit/slaService.test.js" name="SLAService Constants and Logic &gt; Service Methods Existence &gt; should export runSlaCheck" time="0.003117417">
        </testcase>
        <testcase classname="tests/unit/slaService.test.js" name="SLAService Constants and Logic &gt; Service Methods Existence &gt; should export getSlaHealth" time="0.001435625">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/store.test.ts" timestamp="2025-12-21T11:37:25.784Z" hostname="MacBook-Pro-Piotr.local" tests="19" failures="0" errors="0" skipped="0" time="0.196681083">
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; initializes with correct default values" time="0.000858">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets current view" time="0.000161834">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets session mode" time="0.000112167">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets current user" time="0.000266125">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; toggles sidebar open state" time="0.000107375">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; toggles sidebar collapse" time="0.000091333">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; adds chat message" time="0.000503292">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets chat messages" time="0.000153417">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; clears chat" time="0.000135">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets bot typing state" time="0.000094875">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets current stream content" time="0.000071375">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; updates free session data" time="0.000074042">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; updates free session data with function" time="0.000077083">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; updates full session data" time="0.000072334">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets AI config" time="0.000080792">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; toggles theme" time="0.00007625">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; updates last chat message" time="0.0000845">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; logout resets state" time="0.000127">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets current project ID" time="0.00007625">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/templateGraphService.test.js" timestamp="2025-12-21T11:37:25.785Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="0" errors="0" skipped="0" time="0.192715833">
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; createEmptyGraph &gt; creates a graph with START and END nodes connected" time="0.000956792">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; stepsToGraph &gt; converts empty steps to START  END graph" time="0.000236125">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; stepsToGraph &gt; converts steps array to linear graph" time="0.000246125">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; stepsToGraph &gt; preserves step data in nodes" time="0.000327833">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; graphToSteps &gt; returns empty array for invalid graph" time="0.000127416">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; graphToSteps &gt; skips START and END nodes in output" time="0.000075959">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; graphToSteps &gt; converts linear graph to ordered steps" time="0.000113291">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; validateDAG &gt; returns valid for acyclic graph" time="0.000124375">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; validateDAG &gt; detects simple cycle" time="0.00006675">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; validateDAG &gt; returns invalid for null graph" time="0.000049667">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; findDeadEnds &gt; returns empty for valid graph" time="0.0000745">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; findDeadEnds &gt; finds nodes without outgoing edges" time="0.000132042">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; findBranchesWithoutElse &gt; returns empty when no BRANCH nodes" time="0.000068084">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; findBranchesWithoutElse &gt; finds BRANCH node without else path" time="0.000060834">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; findBranchesWithoutElse &gt; passes when BRANCH has else path" time="0.000059208">
        </testcase>
        <testcase classname="tests/unit/templateGraphService.test.js" name="templateGraphService &gt; roundtrip: steps  graph  steps &gt; preserves data through roundtrip" time="0.000090542">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/templateValidationService.test.js" timestamp="2025-12-21T11:37:25.787Z" hostname="MacBook-Pro-Piotr.local" tests="9" failures="0" errors="0" skipped="0" time="0.182729708">
        <testcase classname="tests/unit/templateValidationService.test.js" name="templateValidationService &gt; validate &gt; returns error for missing template graph" time="0.000839333">
        </testcase>
        <testcase classname="tests/unit/templateValidationService.test.js" name="templateValidationService &gt; validate &gt; returns error for invalid JSON in graph" time="0.000213167">
        </testcase>
        <testcase classname="tests/unit/templateValidationService.test.js" name="templateValidationService &gt; validate &gt; validates empty trigger_signal" time="0.000358">
        </testcase>
        <testcase classname="tests/unit/templateValidationService.test.js" name="templateValidationService &gt; validateGraph &gt; returns error for missing nodes array" time="0.00011675">
        </testcase>
        <testcase classname="tests/unit/templateValidationService.test.js" name="templateValidationService &gt; validateGraph &gt; returns error for missing edges array" time="0.0001">
        </testcase>
        <testcase classname="tests/unit/templateValidationService.test.js" name="templateValidationService &gt; validateGraph &gt; returns error when no START node exists" time="0.000111875">
        </testcase>
        <testcase classname="tests/unit/templateValidationService.test.js" name="templateValidationService &gt; validateGraph &gt; calls validateDAG and reports cycles" time="0.000213167">
        </testcase>
        <testcase classname="tests/unit/templateValidationService.test.js" name="templateValidationService &gt; validateGraph &gt; calls findDeadEnds and reports dead-end nodes" time="0.000152125">
        </testcase>
        <testcase classname="tests/unit/templateValidationService.test.js" name="templateValidationService &gt; validateGraph &gt; calls findBranchesWithoutElse and reports missing else" time="0.000158792">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/transformationEngine.test.ts" timestamp="2025-12-21T11:37:25.787Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.176723417">
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; generates initiatives from session" time="0.000656541">
        </testcase>
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; generates initiatives with required properties" time="0.001704083">
        </testcase>
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; generates initiatives only for levels above current" time="0.000380333">
        </testcase>
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; handles session with no gaps" time="0.000085875">
        </testcase>
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; assigns priority based on current level" time="0.000089959">
        </testcase>
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; assigns complexity based on target level" time="0.000786917">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/transformationScenarios.test.ts" timestamp="2025-12-21T11:37:25.787Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.247358208">
        <testcase classname="tests/unit/transformationScenarios.test.ts" name="Transformation Scenarios Logic &gt; should have 6 unique scenarios" time="0.000502791">
        </testcase>
        <testcase classname="tests/unit/transformationScenarios.test.ts" name="Transformation Scenarios Logic &gt; recommendScenario should return stabilize for high risk &amp; low budget" time="0.000091375">
        </testcase>
        <testcase classname="tests/unit/transformationScenarios.test.ts" name="Transformation Scenarios Logic &gt; recommendScenario should return quickwins for low risk &amp; low budget" time="0.000076917">
        </testcase>
        <testcase classname="tests/unit/transformationScenarios.test.ts" name="Transformation Scenarios Logic &gt; recommendScenario should return foundation for high risk &amp; high budget" time="0.000058208">
        </testcase>
        <testcase classname="tests/unit/transformationScenarios.test.ts" name="Transformation Scenarios Logic &gt; recommendScenario should default to hybrid" time="0.000059542">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/utils.test.ts" timestamp="2025-12-21T11:37:25.788Z" hostname="MacBook-Pro-Piotr.local" tests="1" failures="0" errors="0" skipped="0" time="0.172042209">
        <testcase classname="tests/unit/utils.test.ts" name="Unit Test: Utilities &gt; should have utility functions available" time="0.000502541">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/workqueueService.test.js" timestamp="2025-12-21T11:37:25.788Z" hostname="MacBook-Pro-Piotr.local" tests="13" failures="0" errors="0" skipped="0" time="0.249131">
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; ASSIGNMENT_STATUSES Constants &gt; should export PENDING status" time="0.006562417">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; ASSIGNMENT_STATUSES Constants &gt; should export ACKED status" time="0.001326">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; ASSIGNMENT_STATUSES Constants &gt; should export DONE status" time="0.000927791">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; ASSIGNMENT_STATUSES Constants &gt; should export EXPIRED status" time="0.000852625">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; ASSIGNMENT_STATUSES Constants &gt; should have 4 status types" time="0.002974417">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; DEFAULT_SLA_HOURS &gt; should default to 48 hours" time="0.001129459">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; Service Methods Existence &gt; should export assignApproval" time="0.000798875">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; Service Methods Existence &gt; should export acknowledgeApproval" time="0.001510792">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; Service Methods Existence &gt; should export completeApproval" time="0.001138125">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; Service Methods Existence &gt; should export getMyApprovals" time="0.001500875">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; Service Methods Existence &gt; should export getOrgApprovals" time="0.001515417">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; Service Methods Existence &gt; should export getOverdueCount" time="0.002520167">
        </testcase>
        <testcase classname="tests/unit/workqueueService.test.js" name="WorkqueueService Constants and Logic &gt; Service Methods Existence &gt; should export getAssignmentByProposal" time="0.000952458">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/hooks/useAIStream.test.ts" timestamp="2025-12-21T11:37:25.788Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.251388375">
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; initializes with correct default values" time="0.008508875">
        </testcase>
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; calls API with correct parameters" time="0.007275625">
            <system-out>
[DEBUG-D] startStream entry: {
  msgLength: 12,
  historyLength: 0,
  hasSystemPrompt: true,
  hasContext: false
}
[DEBUG-A,C] startStream onDone: { responseLength: 11 }

            </system-out>
        </testcase>
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; updates stream content as chunks arrive" time="0.001563458">
            <system-out>
[DEBUG-D] startStream entry: {
  msgLength: 4,
  historyLength: 0,
  hasSystemPrompt: false,
  hasContext: false
}
[DEBUG-A,C] startStream onDone: { responseLength: 11 }

            </system-out>
        </testcase>
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; calls onStreamDone callback when stream completes" time="0.004042375">
            <system-out>
[DEBUG-D] startStream entry: {
  msgLength: 4,
  historyLength: 0,
  hasSystemPrompt: false,
  hasContext: false
}
[DEBUG-A,C] startStream onDone: { responseLength: 8 }

            </system-out>
        </testcase>
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; handles stream errors" time="0.003958583">
            <system-out>
[DEBUG-D] startStream entry: {
  msgLength: 4,
  historyLength: 0,
  hasSystemPrompt: false,
  hasContext: false
}

[DEBUG-A,C] startStream error: { errorMsg: &apos;Error: Stream failed&apos; }

            </system-out>
            <system-err>
AI Stream Error: Error: Stream failed
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/hooks/useAIStream.test.ts:87:23
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:12)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; sets bot typing state correctly" time="0.001814875">
            <system-out>
[DEBUG-D] startStream entry: {
  msgLength: 4,
  historyLength: 0,
  hasSystemPrompt: false,
  hasContext: false
}
[DEBUG-A,C] startStream onDone: { responseLength: 11 }

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/hooks/useIndependentAI.test.ts" timestamp="2025-12-21T11:37:25.790Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.203166708">
        <testcase classname="tests/unit/hooks/useIndependentAI.test.ts" name="useIndependentAI &gt; initializes with default state" time="0.006127584">
        </testcase>
        <testcase classname="tests/unit/hooks/useIndependentAI.test.ts" name="useIndependentAI &gt; callAI manages loading state and accumulates stream" time="0.001449083">
        </testcase>
        <testcase classname="tests/unit/hooks/useIndependentAI.test.ts" name="useIndependentAI &gt; refineText calls callAI with correct prompt and system instruction" time="0.001832541">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/hooks/useScreenContext.test.ts" timestamp="2025-12-21T11:37:25.790Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="0" errors="0" skipped="0" time="0.203067166">
        <testcase classname="tests/unit/hooks/useScreenContext.test.ts" name="Hook Test: useScreenContext &gt; sets screen context on mount after debounce" time="0.007770459">
        </testcase>
        <testcase classname="tests/unit/hooks/useScreenContext.test.ts" name="Hook Test: useScreenContext &gt; updates context when data changes" time="0.001162167">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/accessPolicyService.test.js" timestamp="2025-12-21T11:37:25.791Z" hostname="MacBook-Pro-Piotr.local" tests="10" failures="9" errors="0" skipped="0" time="0.142110333">
        <testcase classname="tests/unit/backend/accessPolicyService.test.js" name="AccessPolicyService &gt; getOrganizationType &gt; should return organization type for valid org" time="0.003052375">
            <failure message="Cannot read properties of null (reading &apos;id&apos;)" type="TypeError">
TypeError: Cannot read properties of null (reading &apos;id&apos;)
  tests/unit/backend/accessPolicyService.test.js:65:27
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/accessPolicyService.test.js" name="AccessPolicyService &gt; getOrganizationType &gt; should return null for non-existent org" time="0.001039459">
        </testcase>
        <testcase classname="tests/unit/backend/accessPolicyService.test.js" name="AccessPolicyService &gt; getOrganizationType &gt; should handle database errors" time="0.00186275">
            <failure message="promise resolved &quot;null&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;null&quot; instead of rejecting

- Expected: 
Error {
  &quot;message&quot;: &quot;rejected promise&quot;,
}

+ Received: 
null

  tests/unit/backend/accessPolicyService.test.js:87:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/accessPolicyService.test.js" name="AccessPolicyService &gt; checkAccess &gt; should allow access for active trial org" time="0.001998542">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/accessPolicyService.test.js:123:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/accessPolicyService.test.js" name="AccessPolicyService &gt; checkAccess &gt; should deny access for expired trial" time="0.002448333">
            <failure message="expected &apos;Organization not found&apos; to contain &apos;TRIAL_EXPIRED&apos;" type="AssertionError">
AssertionError: expected &apos;Organization not found&apos; to contain &apos;TRIAL_EXPIRED&apos;

Expected: &quot;TRIAL_EXPIRED&quot;
Received: &quot;Organization not found&quot;

  tests/unit/backend/accessPolicyService.test.js:147:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/accessPolicyService.test.js" name="AccessPolicyService &gt; checkAccess &gt; should deny access when AI limit reached" time="0.001684041">
            <failure message="expected &apos;Organization not found&apos; to contain &apos;AI_LIMIT_REACHED&apos;" type="AssertionError">
AssertionError: expected &apos;Organization not found&apos; to contain &apos;AI_LIMIT_REACHED&apos;

Expected: &quot;AI_LIMIT_REACHED&quot;
Received: &quot;Organization not found&quot;

  tests/unit/backend/accessPolicyService.test.js:178:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/accessPolicyService.test.js" name="AccessPolicyService &gt; checkAccess &gt; should deny access for demo mode mutations" time="0.001169125">
            <failure message="expected &apos;Organization not found&apos; to contain &apos;DEMO_READ_ONLY&apos;" type="AssertionError">
AssertionError: expected &apos;Organization not found&apos; to contain &apos;DEMO_READ_ONLY&apos;

Expected: &quot;DEMO_READ_ONLY&quot;
Received: &quot;Organization not found&quot;

  tests/unit/backend/accessPolicyService.test.js:199:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/accessPolicyService.test.js" name="AccessPolicyService &gt; getOrganizationLimits &gt; should return default limits for trial org without custom limits" time="0.000741458">
            <failure message="Cannot read properties of null (reading &apos;max_projects&apos;)" type="TypeError">
TypeError: Cannot read properties of null (reading &apos;max_projects&apos;)
  tests/unit/backend/accessPolicyService.test.js:223:27
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/accessPolicyService.test.js" name="AccessPolicyService &gt; getOrganizationLimits &gt; should return custom limits when set" time="0.000629417">
            <failure message="Cannot read properties of null (reading &apos;max_projects&apos;)" type="TypeError">
TypeError: Cannot read properties of null (reading &apos;max_projects&apos;)
  tests/unit/backend/accessPolicyService.test.js:244:27
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/accessPolicyService.test.js" name="AccessPolicyService &gt; Multi-Tenant Isolation &gt; should only return limits for specified organization" time="0.000951542">
            <failure message="expected &quot;vi.fn()&quot; to be called at least once" type="AssertionError">
AssertionError: expected &quot;vi.fn()&quot; to be called at least once
  tests/unit/backend/accessPolicyService.test.js:273:32
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/actionDecision.service.test.js" timestamp="2025-12-21T11:37:25.792Z" hostname="MacBook-Pro-Piotr.local" tests="12" failures="0" errors="0" skipped="6" time="0.163376958">
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; validation &gt; should throw error for missing required fields" time="0.001201167">
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; validation &gt; should throw error for missing organization_id" time="0.000166375">
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; validation &gt; should throw error for invalid decision type" time="0.000107625">
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; MODIFIED_ALLOWLIST &gt; should define allowlist for TASK_CREATE" time="0.000366334">
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; MODIFIED_ALLOWLIST &gt; should define allowlist for PLAYBOOK_ASSIGN" time="0.000108208">
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; MODIFIED_ALLOWLIST &gt; should define allowlist for MEETING_SCHEDULE" time="0.000088875">
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; getDecisionsByProposal &gt; should query decisions by proposal_id" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; getDecisionsByProposal &gt; should parse JSON fields" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; getAuditLog - skipped due to CJS/ESM mock interop &gt; should enforce organization isolation" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; getAuditLog - skipped due to CJS/ESM mock interop &gt; should support SUPERADMIN_BYPASS for global access" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; getAuditLog - skipped due to CJS/ESM mock interop &gt; should support filtering by actionType" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/actionDecision.service.test.js" name="ActionDecisionService - HARDENED &gt; getAuditLog - skipped due to CJS/ESM mock interop &gt; should support filtering by decision" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/activityService.test.js" timestamp="2025-12-21T11:37:25.793Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.771683209">
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; log &gt; logs activity with all parameters" time="0.10256325">
        </testcase>
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; log &gt; handles optional parameters" time="0.1017675">
        </testcase>
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; getRecent &gt; fetches recent activities with default limit" time="0.113782416">
        </testcase>
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; getRecent &gt; fetches recent activities with custom limit" time="0.103555333">
        </testcase>
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; getRecent &gt; handles database errors gracefully" time="0.001546667">
        </testcase>
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; getByOrganization &gt; fetches activities for organization" time="0.101485458">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiActionExecutor.test.js" timestamp="2025-12-21T11:37:25.793Z" hostname="MacBook-Pro-Piotr.local" tests="14" failures="7" errors="0" skipped="0" time="0.198006042">
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; requestAction() &gt; should create action request successfully" time="0.0074595">
            <failure message="expected &apos;APPROVED&apos; to be &apos;PENDING&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;APPROVED&apos; to be &apos;PENDING&apos; // Object.is equality

Expected: &quot;PENDING&quot;
Received: &quot;APPROVED&quot;

  tests/unit/backend/aiActionExecutor.test.js:79:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; requestAction() &gt; should block action when regulatory mode is enabled" time="0.000397125">
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; requestAction() &gt; should block action when AI role guard blocks it" time="0.000477209">
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; requestAction() &gt; should require approval for MANAGER role actions" time="0.000346">
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; requestAction() &gt; should block action when policy engine denies it" time="0.000238833">
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; requestAction() &gt; should allow action without projectId" time="0.000401833">
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; approveAction() &gt; should approve pending action" time="0.000312833">
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; approveAction() &gt; should reject approval for non-pending action" time="0.002056209">
            <failure message="promise resolved &quot;{ success: true, (2) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ success: true, (2) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;actionId&quot;: &quot;action-123&quot;,
+   &quot;status&quot;: &quot;APPROVED&quot;,
+   &quot;success&quot;: true,
  }

  tests/unit/backend/aiActionExecutor.test.js:253:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; rejectAction() &gt; should reject pending action" time="0.000376875">
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; executeAction() &gt; should execute approved action" time="0.000578708">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/aiActionExecutor.test.js:300:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; executeAction() &gt; should reject execution of non-approved action" time="0.000559125">
            <failure message="promise resolved &quot;{ success: false, (1) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ success: false, (1) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;error&quot;: &quot;Action is PENDING, not APPROVED&quot;,
+   &quot;success&quot;: false,
  }

  tests/unit/backend/aiActionExecutor.test.js:316:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; getAction() &gt; should return action by ID" time="0.000306583">
            <failure message="AIActionExecutor.getAction is not a function" type="TypeError">
TypeError: AIActionExecutor.getAction is not a function
  tests/unit/backend/aiActionExecutor.test.js:332:51
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; getAction() &gt; should return null for non-existent action" time="0.000191542">
            <failure message="AIActionExecutor.getAction is not a function" type="TypeError">
TypeError: AIActionExecutor.getAction is not a function
  tests/unit/backend/aiActionExecutor.test.js:343:51
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiActionExecutor.test.js" name="AIActionExecutor &gt; listActions() &gt; should return list of actions" time="0.000198125">
            <failure message="AIActionExecutor.listActions is not a function" type="TypeError">
TypeError: AIActionExecutor.listActions is not a function
  tests/unit/backend/aiActionExecutor.test.js:367:52
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiActions.test.js" timestamp="2025-12-21T11:37:25.794Z" hostname="MacBook-Pro-Piotr.local" tests="23" failures="0" errors="0" skipped="0" time="0.213555875">
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should have 7 action types" time="0.010288208">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define CREATE_DRAFT_TASK type" time="0.000385125">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define CREATE_DRAFT_INITIATIVE type" time="0.0001255">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define SUGGEST_ROADMAP_CHANGE type" time="0.000072834">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define GENERATE_REPORT type" time="0.000062458">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define PREPARE_DECISION_SUMMARY type" time="0.000045917">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define EXPLAIN_CONTEXT type" time="0.000048083">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define ANALYZE_RISKS type" time="0.000046833">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_STATUS &gt; should define PENDING status" time="0.000141666">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_STATUS &gt; should define APPROVED status" time="0.000095458">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_STATUS &gt; should define REJECTED status" time="0.000059959">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_STATUS &gt; should define EXECUTED status" time="0.000040208">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export requestAction function" time="0.000036042">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export createDraft function" time="0.000031083">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export approveAction function" time="0.000028708">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export rejectAction function" time="0.000027">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export getPendingActions function" time="0.000026625">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export executeAction function" time="0.000026583">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIAuditLogger &gt; Service Structure &gt; should export logInteraction function" time="0.001863833">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIAuditLogger &gt; Service Structure &gt; should export logSuggestion function" time="0.000082958">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIAuditLogger &gt; Service Structure &gt; should export recordUserDecision function" time="0.000052708">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIAuditLogger &gt; Service Structure &gt; should export getAuditLogs function" time="0.000043791">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIAuditLogger &gt; Service Structure &gt; should export getAuditStats function" time="0.000032083">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiAnalyticsService.test.js" timestamp="2025-12-21T11:37:25.795Z" hostname="MacBook-Pro-Piotr.local" tests="7" failures="0" errors="0" skipped="7" time="0">
        <testcase classname="tests/unit/backend/aiAnalyticsService.test.js" name="AI Analytics Service &gt; getLastActionTrends &gt; should aggregate action counts correctly [BLOCKED: MOCK BYPASS]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiAnalyticsService.test.js" name="AI Analytics Service &gt; getApprovalStats &gt; should distinguish between auto and manual approvals [BLOCKED: MOCK BYPASS]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiAnalyticsService.test.js" name="AI Analytics Service &gt; getPlaybookStats &gt; should calculate completion rates and average duration [BLOCKED: MOCK BYPASS]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiAnalyticsService.test.js" name="AI Analytics Service &gt; getDeadLetterStats &gt; should aggregate dead letter jobs by error code [BLOCKED: MOCK BYPASS]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiAnalyticsService.test.js" name="AI Analytics Service &gt; getROISummary &gt; should combine metrics from multiple sources [BLOCKED: MOCK BYPASS]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiAnalyticsService.test.js" name="AI Analytics Service &gt; exportData &gt; should export CSV format correctly [BLOCKED: MOCK BYPASS]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiAnalyticsService.test.js" name="AI Analytics Service &gt; exportData &gt; should export JSON format correctly [BLOCKED: MOCK BYPASS]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiAuditLogger.test.js" timestamp="2025-12-21T11:37:25.795Z" hostname="MacBook-Pro-Piotr.local" tests="24" failures="0" errors="0" skipped="0" time="0.230398375">
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; logInteraction &gt; should log a basic AI interaction" time="0.000748041">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; logInteraction &gt; should store correlation_id if provided" time="0.000158375">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; logInteraction &gt; should handle optional fields" time="0.00008225">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; logInteraction &gt; should store explanation data if provided" time="0.000087791">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; logInteraction &gt; should handle database error" time="0.000563584">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; logWithExplanation &gt; should log interaction with full explanation object" time="0.00011625">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; logWithExplanation &gt; should default actionType to AI_RESPONSE" time="0.00005875">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; logSuggestion &gt; should log AI suggestion" time="0.000076958">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; logSuggestion &gt; should handle minimal parameters" time="0.000059917">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; recordUserDecision &gt; should update user decision on logged suggestion" time="0.000110917">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; recordUserDecision &gt; should record rejection without feedback" time="0.000046833">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; recordUserDecision &gt; should handle non-existent audit entry" time="0.000049042">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; getAuditLogs &gt; should return audit logs for organization" time="0.000390791">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; getAuditLogs &gt; should filter by project if provided" time="0.000089042">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; getAuditLogs &gt; should filter by date range" time="0.000048166">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; getAuditLogs &gt; should limit results" time="0.00003675">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; getAuditLogs &gt; should filter by action type" time="0.000032917">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; getAuditLogs &gt; should return empty array on database error" time="0.000096791">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; getAuditStats &gt; should return statistics for organization" time="0.000096708">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; getAuditStats &gt; should filter by project if provided" time="0.000113875">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; getRoleDistribution &gt; should return role distribution" time="0.000090625">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; clearOldLogs &gt; should clear logs older than specified days" time="0.000076167">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; clearOldLogs &gt; should use default retention period of 90 days" time="0.000032166">
        </testcase>
        <testcase classname="tests/unit/backend/aiAuditLogger.test.js" name="AIAuditLogger &gt; clearOldLogs &gt; should respect custom retention period" time="0.00003">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiContextBuilder.test.js" timestamp="2025-12-21T11:37:25.797Z" hostname="MacBook-Pro-Piotr.local" tests="9" failures="4" errors="0" skipped="0" time="0.21883725">
        <testcase classname="tests/unit/backend/aiContextBuilder.test.js" name="AIContextBuilder &gt; buildContext() &gt; should build complete context with all layers" time="0.013890833">
        </testcase>
        <testcase classname="tests/unit/backend/aiContextBuilder.test.js" name="AIContextBuilder &gt; buildContext() &gt; should build context without projectId" time="0.001971167">
        </testcase>
        <testcase classname="tests/unit/backend/aiContextBuilder.test.js" name="AIContextBuilder &gt; buildContext() &gt; should include PMO health snapshot when projectId provided" time="0.00624">
        </testcase>
        <testcase classname="tests/unit/backend/aiContextBuilder.test.js" name="AIContextBuilder &gt; buildContext() &gt; should handle PMO health service errors gracefully" time="0.009142584">
            <system-err>
[AIContextBuilder] Failed to get PMO health snapshot: Service unavailable

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiContextBuilder.test.js" name="AIContextBuilder &gt; buildContext() &gt; should include options in context" time="0.002214625">
        </testcase>
        <testcase classname="tests/unit/backend/aiContextBuilder.test.js" name="AIContextBuilder &gt; _buildPlatformContext() &gt; should build platform context with user role" time="0.003420875">
            <failure message="expected &apos;USER&apos; to be &apos;ADMIN&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;USER&apos; to be &apos;ADMIN&apos; // Object.is equality

Expected: &quot;ADMIN&quot;
Received: &quot;USER&quot;

  tests/unit/backend/aiContextBuilder.test.js:208:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiContextBuilder.test.js" name="AIContextBuilder &gt; _buildPlatformContext() &gt; should map SUPERADMIN role correctly" time="0.004845459">
            <failure message="expected &apos;USER&apos; to be &apos;SUPERADMIN&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;USER&apos; to be &apos;SUPERADMIN&apos; // Object.is equality

Expected: &quot;SUPERADMIN&quot;
Received: &quot;USER&quot;

  tests/unit/backend/aiContextBuilder.test.js:228:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiContextBuilder.test.js" name="AIContextBuilder &gt; _buildOrganizationContext() &gt; should build organization context" time="0.00270225">
            <failure message="expected undefined to be &apos;Test Org&apos; // Object.is equality" type="AssertionError">
AssertionError: expected undefined to be &apos;Test Org&apos; // Object.is equality

- Expected: 
&quot;Test Org&quot;

+ Received: 
undefined

  tests/unit/backend/aiContextBuilder.test.js:246:30
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiContextBuilder.test.js" name="AIContextBuilder &gt; _buildProjectContext() &gt; should build project context" time="0.000846084">
            <failure message="expected undefined to be &apos;Test Project&apos; // Object.is equality" type="AssertionError">
AssertionError: expected undefined to be &apos;Test Project&apos; // Object.is equality

- Expected: 
&quot;Test Project&quot;

+ Received: 
undefined

  tests/unit/backend/aiContextBuilder.test.js:265:34
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiCoreLayer.test.js" timestamp="2025-12-21T11:37:25.798Z" hostname="MacBook-Pro-Piotr.local" tests="56" failures="0" errors="0" skipped="0" time="0.221157333">
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export buildContext function" time="0.0102465">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildPlatformContext function" time="0.000153292">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildOrganizationContext function" time="0.00008475">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildProjectContext function" time="0.000075208">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildExecutionContext function" time="0.000064917">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildKnowledgeContext function" time="0.000045583">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildExternalContext function" time="0.000043">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _generateHash function" time="0.000046083">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; _generateHash &gt; should generate consistent hash" time="0.000274958">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; _generateHash &gt; should generate different hash for different inputs" time="0.000357666">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; POLICY_LEVELS &gt; should define ADVISORY level" time="0.008538125">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; POLICY_LEVELS &gt; should define ASSISTED level" time="0.000071791">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; POLICY_LEVELS &gt; should define PROACTIVE level" time="0.000042083">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; POLICY_LEVELS &gt; should define AUTOPILOT level" time="0.000033666">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; AI_ROLES &gt; should define ADVISOR role" time="0.000032583">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; AI_ROLES &gt; should define PMO_MANAGER role" time="0.000029958">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; AI_ROLES &gt; should define EXECUTOR role" time="0.000031">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; AI_ROLES &gt; should define EDUCATOR role" time="0.000027375">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; Service Structure &gt; should export getEffectivePolicy function" time="0.00002925">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; Service Structure &gt; should export canPerformAction function" time="0.000033042">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; Service Structure &gt; should export getPolicySummary function" time="0.000038291">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; Service Structure &gt; should export updatePolicy function" time="0.000134792">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; MEMORY_TYPES &gt; should define DECISION type" time="0.005318">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; MEMORY_TYPES &gt; should define PHASE_TRANSITION type" time="0.00006375">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; MEMORY_TYPES &gt; should define RECOMMENDATION type" time="0.000038042">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; MEMORY_TYPES &gt; should define PATTERN type" time="0.000030083">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; createSession &gt; should create session with unique conversationId" time="0.000193">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; createSession &gt; should create session with empty messages array" time="0.000088916">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; createSession &gt; should create session with startedAt timestamp" time="0.000042584">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; addMessage &gt; should add message to session" time="0.000363292">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; addMessage &gt; should add timestamp to message" time="0.000041041">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; Service Structure &gt; should export recordProjectMemory function" time="0.000031375">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; Service Structure &gt; should export getUserPreferences function" time="0.000029166">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; Service Structure &gt; should export updateUserPreferences function" time="0.000026875">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; AI_ROLES &gt; should define all 4 roles" time="0.009298958">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; CHAT_MODES &gt; should define EXPLAIN mode" time="0.00008">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; CHAT_MODES &gt; should define GUIDE mode" time="0.000041667">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; CHAT_MODES &gt; should define ANALYZE mode" time="0.000034042">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; CHAT_MODES &gt; should define DO mode" time="0.000031083">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; CHAT_MODES &gt; should define TEACH mode" time="0.000029708">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect EXPLAIN intent" time="0.000079333">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect GUIDE intent" time="0.000039333">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect ANALYZE intent" time="0.00003975">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect DO intent" time="0.000040291">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect TEACH intent" time="0.000039708">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should default to EXPLAIN" time="0.00002975">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _selectRole &gt; should select ADVISOR for EXPLAIN intent" time="0.000053792">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _selectRole &gt; should select PMO_MANAGER for GUIDE intent" time="0.000034917">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _selectRole &gt; should select EXECUTOR for DO intent" time="0.000031041">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _selectRole &gt; should select EDUCATOR for TEACH intent" time="0.00003075">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _selectRole &gt; should fallback to ADVISOR if role not active" time="0.000029708">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; getRoleDescription &gt; should return description for ADVISOR" time="0.00007925">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; getRoleDescription &gt; should return description for PMO_MANAGER" time="0.000035084">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; getRoleDescription &gt; should return description for EXECUTOR" time="0.0000325">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; getRoleDescription &gt; should return description for EDUCATOR" time="0.000029625">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; Service Structure &gt; should export processMessage function" time="0.000028834">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiCostControlService.test.js" timestamp="2025-12-21T11:37:25.800Z" hostname="MacBook-Pro-Piotr.local" tests="27" failures="0" errors="0" skipped="0" time="0.172021166">
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; setGlobalBudget &gt; should set global budget" time="0.000856792">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; setGlobalBudget &gt; should handle database errors" time="0.000637541">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; setTenantBudget &gt; should set tenant budget" time="0.000143541">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; setProjectBudget &gt; should set project budget" time="0.000109083">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; getBudget &gt; should return budget when found" time="0.00010875">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; getBudget &gt; should return null when not found" time="0.000064042">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; checkBudget &gt; should allow action when no limits set" time="0.000240292">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; checkBudget &gt; should allow action when within budget" time="0.000121541">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; checkBudget &gt; should block action when exceeding budget without auto-downgrade" time="0.000099084">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; checkBudget &gt; should trigger downgrade when exceeding budget with auto-downgrade enabled" time="0.000117292">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; checkBudget &gt; should check project budget limit" time="0.000078958">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; estimateCost &gt; should calculate cost for known models" time="0.000078667">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; estimateCost &gt; should fallback to default for unknown models" time="0.000032834">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; logUsage &gt; should log usage and update budgets" time="0.000171875">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; logUsage &gt; should handle updates without project" time="0.000045">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; resetMonthlyUsage &gt; should reset usage for all scopes if unspecified" time="0.0000805">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; resetMonthlyUsage &gt; should reset usage for specific scope" time="0.000854792">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; Model Selection &gt; should return correct category for action" time="0.000056625">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; Model Selection &gt; should fallback to CHAT for unknown action" time="0.000029">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; Model Selection &gt; should prioritize role if present" time="0.000026167">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; getTierForBudget &gt; should return tier 1 for non-downgraded reasoning" time="0.000040125">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; getTierForBudget &gt; should downgrade premium to standard when budget constrained" time="0.000030041">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; getTierForBudget &gt; should downgrade standard to budget when constrained" time="0.000030583">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; getTierForBudget &gt; should keep budget tier at 3 even when constrained" time="0.000031959">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; Analytics &gt; should return usage summary" time="0.000137375">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; Analytics &gt; should return user usage" time="0.000082417">
        </testcase>
        <testcase classname="tests/unit/backend/aiCostControlService.test.js" name="AICostControlService &gt; Analytics &gt; should return all budgets" time="0.000178375">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiDecisionGovernance.test.js" timestamp="2025-12-21T11:37:25.801Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="4" time="0.122248834">
        <testcase classname="tests/unit/backend/aiDecisionGovernance.test.js" name="AI Decision Governance Service &gt; detectDecisionNeeded &gt; should detect phase transition decision" time="0.000623708">
        </testcase>
        <testcase classname="tests/unit/backend/aiDecisionGovernance.test.js" name="AI Decision Governance Service &gt; detectDecisionNeeded &gt; should check DB for blocked task reason [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiDecisionGovernance.test.js" name="AI Decision Governance Service &gt; getBlockingDecisions &gt; should calculate daysWaiting correctly [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiDecisionGovernance.test.js" name="AI Decision Governance Service &gt; prepareDecisionBrief &gt; should generate a brief and insert into DB [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiDecisionGovernance.test.js" name="AI Decision Governance Service &gt; registerImpact &gt; should record an impact with mocked UUID [BLOCKED: REQUIRE UUID FAIL]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiExecutiveReporting.test.js" timestamp="2025-12-21T11:37:25.801Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="0" errors="0" skipped="2" time="0">
        <testcase classname="tests/unit/backend/aiExecutiveReporting.test.js" name="AI Executive Reporting Service &gt; generateReport &gt; should dispatch to project status report handler [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiExecutiveReporting.test.js" name="AI Executive Reporting Service &gt; generateReport &gt; should dispatch to portfolio overview handler [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiExplainabilityService.test.js" timestamp="2025-12-21T11:37:25.801Z" hostname="MacBook-Pro-Piotr.local" tests="35" failures="0" errors="0" skipped="0" time="0.269485708">
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; returns LOW when context is null" time="0.000539291">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; returns LOW when context is empty" time="0.000108">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; returns LOW when PMOHealthSnapshot is missing and no project data" time="0.000089458">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; returns MEDIUM when PMOHealthSnapshot exists with blockers" time="0.000076709">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; returns HIGH when full context with no blockers" time="0.000089209">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; penalizes conflicting signals (many blockers AND many pending decisions)" time="0.000367625">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildReasoningSummary &gt; returns default message when no health data" time="0.000089208">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildReasoningSummary &gt; includes overdue tasks in reasoning" time="0.000053417">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildReasoningSummary &gt; includes pending decisions in reasoning" time="0.000045917">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildReasoningSummary &gt; includes phase information" time="0.000058708">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildReasoningSummary &gt; includes project memory count when provided" time="0.000038">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; extractConstraintsApplied &gt; includes AI role constraint" time="0.000094042">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; extractConstraintsApplied &gt; includes policy level constraint" time="0.000044041">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; extractConstraintsApplied &gt; includes phase gate constraint" time="0.000048666">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; extractConstraintsApplied &gt; includes regulatory mode constraint" time="0.000044292">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; identifyDataUsed &gt; returns projectData false when no project context" time="0.000053209">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; identifyDataUsed &gt; returns projectData true when project context exists" time="0.000030625">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; identifyDataUsed &gt; returns projectMemoryCount from options" time="0.000027959">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; identifyDataUsed &gt; returns empty externalSources when internet disabled" time="0.000218834">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; identifyDataUsed &gt; returns external sources when internet enabled" time="0.000108792">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildAIExplanation &gt; generates valid AIExplanation object" time="0.000278375">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildAIExplanation &gt; includes all required fields in correct format" time="0.00011825">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildAIExplanation &gt; timestamp is ISO 8601 format" time="0.000070708">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildAIExplanation &gt; maps orchestrator roles to project roles correctly" time="0.000041916">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildExplainabilityFooter &gt; returns empty string when explanation is null" time="0.000049125">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildExplainabilityFooter &gt; formats human-readable footer" time="0.00007">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildExplainabilityFooter &gt; shows max 3 constraints" time="0.000067083">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildExplainabilityFooter &gt; does not expose raw internals" time="0.000043583">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _countPopulatedLayers &gt; returns 0 for null context" time="0.000025042">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _countPopulatedLayers &gt; counts populated layers correctly" time="0.000038458">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _getBlockerCount &gt; returns 0 when no blockers" time="0.000025166">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _getBlockerCount &gt; counts blockers from PMO health snapshot" time="0.000026083">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _getBlockerCount &gt; counts blockers from execution context" time="0.000024875">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _getBlockerCount &gt; sums blockers from both sources" time="0.000026542">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="Sample Output &gt; generates sample AIExplanation matching the spec" time="0.000265625">
            <system-out>

========== SAMPLE AIExplanation JSON ==========
{
  &quot;aiRole&quot;: &quot;ADVISOR&quot;,
  &quot;regulatoryMode&quot;: false,
  &quot;confidenceLevel&quot;: &quot;HIGH&quot;,
  &quot;reasoningSummary&quot;: &quot;Based on 3 overdue task(s), 1 pending decision(s), current phase: Execution, 5 project memory item(s) consulted&quot;,
  &quot;dataUsed&quot;: {
    &quot;projectData&quot;: true,
    &quot;projectMemoryCount&quot;: 5,
    &quot;externalSources&quot;: []
  },
  &quot;constraintsApplied&quot;: [
    &quot;AI Role: ADVISOR (explain/suggest only, no mutations)&quot;,
    &quot;AI Policy: ADVISORY mode&quot;,
    &quot;Phase Gate: Execution&quot;
  ],
  &quot;timestamp&quot;: &quot;2025-12-21T11:37:22.753Z&quot;
}
================================================


            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiExternalData.test.js" timestamp="2025-12-21T11:37:25.803Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.17426725">
        <testcase classname="tests/unit/backend/aiExternalData.test.js" name="AI External Data Control &gt; Internet Toggle &gt; should block external sources when internetEnabled is false" time="0.000511084">
        </testcase>
        <testcase classname="tests/unit/backend/aiExternalData.test.js" name="AI External Data Control &gt; Internet Toggle &gt; should allow external sources when internetEnabled is true" time="0.000103959">
        </testcase>
        <testcase classname="tests/unit/backend/aiExternalData.test.js" name="AI External Data Control &gt; Internet Toggle &gt; should respect project-level internet toggle" time="0.00006925">
        </testcase>
        <testcase classname="tests/unit/backend/aiExternalData.test.js" name="AI External Data Control &gt; RAG Toggle (GAP-03) &gt; should disable RAG when rag_enabled is 0" time="0.00006225">
        </testcase>
        <testcase classname="tests/unit/backend/aiExternalData.test.js" name="AI External Data Control &gt; RAG Toggle (GAP-03) &gt; should enable RAG by default" time="0.000054">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiFailureHandler.test.js" timestamp="2025-12-21T11:37:25.803Z" hostname="MacBook-Pro-Piotr.local" tests="20" failures="7" errors="0" skipped="0" time="0.18752475">
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; withFallback() &gt; should execute AI function successfully" time="0.001748667">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; withFallback() &gt; should use fallback when AI function fails" time="0.000850083">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; withFallback() &gt; should handle timeout" time="0.001430833">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; withFallback() &gt; should return graceful degradation when fallback also fails" time="0.000936875">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; _identifyFailureType() &gt; should identify timeout errors" time="0.000106">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; _identifyFailureType() &gt; should identify rate limit errors" time="0.000085792">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; _identifyFailureType() &gt; should identify budget exceeded errors" time="0.000066417">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; _identifyFailureType() &gt; should identify authentication errors" time="0.000066">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; _identifyFailureType() &gt; should default to unknown error" time="0.00007775">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; logFailure() &gt; should log failure to database" time="0.002632333">
            <failure message="expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0
" type="AssertionError">
AssertionError: expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0

  tests/unit/backend/aiFailureHandler.test.js:156:32
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; getHealthStatus() &gt; should return health status" time="0.000282541">
            <failure message="AIFailureHandler.getHealthStatus is not a function" type="TypeError">
TypeError: AIFailureHandler.getHealthStatus is not a function
  tests/unit/backend/aiFailureHandler.test.js:173:51
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; getHealthStatus() &gt; should return default status when not found" time="0.000140917">
            <failure message="AIFailureHandler.getHealthStatus is not a function" type="TypeError">
TypeError: AIFailureHandler.getHealthStatus is not a function
  tests/unit/backend/aiFailureHandler.test.js:183:51
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; getRecentFailures() &gt; should return recent failures" time="0.001655291">
            <failure message="expected 4 to be 2 // Object.is equality" type="AssertionError">
AssertionError: expected 4 to be 2 // Object.is equality

- Expected
+ Received

- 2
+ 4

  tests/unit/backend/aiFailureHandler.test.js:200:44
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; forceHealthCheck() &gt; should return HEALTHY status when no recent failures" time="0.002170959">
            <failure message="expected &apos;degraded&apos; to be &apos;healthy&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;degraded&apos; to be &apos;healthy&apos; // Object.is equality

Expected: &quot;healthy&quot;
Received: &quot;degraded&quot;

  tests/unit/backend/aiFailureHandler.test.js:217:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; forceHealthCheck() &gt; should return DEGRADED status with 3+ failures" time="0.000761917">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; forceHealthCheck() &gt; should return UNAVAILABLE status with 10+ failures" time="0.000653708">
            <failure message="expected &apos;degraded&apos; to be &apos;unavailable&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;degraded&apos; to be &apos;unavailable&apos; // Object.is equality

Expected: &quot;unavailable&quot;
Received: &quot;degraded&quot;

  tests/unit/backend/aiFailureHandler.test.js:247:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; nonBlocking() &gt; should return AI result when successful" time="0.000155834">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; nonBlocking() &gt; should return default value when AI fails" time="0.000512083">
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; explainFailure() &gt; should return user-friendly explanation for timeout" time="0.000288625">
            <failure message="expected &apos;object&apos; to be &apos;string&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;object&apos; to be &apos;string&apos; // Object.is equality

Expected: &quot;string&quot;
Received: &quot;object&quot;

  tests/unit/backend/aiFailureHandler.test.js:286:40
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiFailureHandler.test.js" name="AIFailureHandler &gt; degrade() &gt; should return graceful degradation response" time="0.000099417">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiIntegrationService.test.js" timestamp="2025-12-21T11:37:25.805Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="4" time="0.234933875">
        <testcase classname="tests/unit/backend/aiIntegrationService.test.js" name="AI Integration Service &gt; Logic: getProviderCapabilities &gt; should return correct capabilities for known providers" time="0.007272041">
        </testcase>
        <testcase classname="tests/unit/backend/aiIntegrationService.test.js" name="AI Integration Service &gt; Logic: getProviderCapabilities &gt; should return empty array for unknown provider" time="0.001434625">
        </testcase>
        <testcase classname="tests/unit/backend/aiIntegrationService.test.js" name="AI Integration Service &gt; suggestSync &gt; should create pending action [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiIntegrationService.test.js" name="AI Integration Service &gt; executeAction &gt; should execute approved action and update status [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiIntegrationService.test.js" name="AI Integration Service &gt; executeAction &gt; should throw if action not found or not approved [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiIntegrationService.test.js" name="AI Integration Service &gt; handleWebhook &gt; should process webhook if integration active [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiKnowledgeManager.test.js" timestamp="2025-12-21T11:37:25.805Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="2" time="0.269265375">
        <testcase classname="tests/unit/backend/aiKnowledgeManager.test.js" name="AI Knowledge Manager Service &gt; Logic: _cosineSimilarity &gt; should calculate similarity correctly" time="0.089851">
        </testcase>
        <testcase classname="tests/unit/backend/aiKnowledgeManager.test.js" name="AI Knowledge Manager Service &gt; Logic: _cosineSimilarity &gt; should handle empty or mismatched vectors" time="0.001832084">
        </testcase>
        <testcase classname="tests/unit/backend/aiKnowledgeManager.test.js" name="AI Knowledge Manager Service &gt; Logic: _formatKnowledgeForPrompt &gt; should format chunks with citations" time="0.001668333">
        </testcase>
        <testcase classname="tests/unit/backend/aiKnowledgeManager.test.js" name="AI Knowledge Manager Service &gt; getContextualKnowledge (Integration) &gt; should retrieve and rank knowledge chunks [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiKnowledgeManager.test.js" name="AI Knowledge Manager Service &gt; captureDecision &gt; should store decision and generate embeddings [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiMaturityMonitor.test.js" timestamp="2025-12-21T11:37:25.805Z" hostname="MacBook-Pro-Piotr.local" tests="4" failures="0" errors="0" skipped="2" time="0.199192916">
        <testcase classname="tests/unit/backend/aiMaturityMonitor.test.js" name="AI Maturity Monitor Service &gt; Logic: _scoreToLevel &gt; should map score to correct level" time="0.008590375">
        </testcase>
        <testcase classname="tests/unit/backend/aiMaturityMonitor.test.js" name="AI Maturity Monitor Service &gt; Logic: _generateInsights &gt; should identify strengths and weaknesses" time="0.001792708">
        </testcase>
        <testcase classname="tests/unit/backend/aiMaturityMonitor.test.js" name="AI Maturity Monitor Service &gt; assessMaturity (Integration) &gt; should aggregate metrics into overall score [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiMaturityMonitor.test.js" name="AI Maturity Monitor Service &gt; benchmarkAgainstPractices &gt; should compare levels vs benchmarks [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiMemoryManager.test.js" timestamp="2025-12-21T11:37:25.805Z" hostname="MacBook-Pro-Piotr.local" tests="12" failures="0" errors="0" skipped="0" time="0">
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; createSession() &gt; should create new session" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; createSession() &gt; should create unique session IDs" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; addMessage() &gt; should add message to session" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; addMessage() &gt; should add multiple messages" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; recordProjectMemory() &gt; should record project memory" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; recordProjectMemory() &gt; should handle database errors" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; recordDecision() &gt; should record decision with rationale" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; recordPhaseTransition() &gt; should record phase transition" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; recordRecommendation() &gt; should record recommendation and user response" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; getProjectMemory() &gt; should retrieve project memories" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; getProjectMemory() &gt; should filter by memory type" time="0">
        </testcase>
        <testcase classname="tests/unit/backend/aiMemoryManager.test.js" name="AIMemoryManager &gt; getRelevantMemories() &gt; should return relevant memories for context" time="0">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiOrchestrator.test.js" timestamp="2025-12-21T11:37:25.806Z" hostname="MacBook-Pro-Piotr.local" tests="12" failures="0" errors="0" skipped="0" time="0.138118083">
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; processMessage &gt; should process user message successfully" time="0.001105375">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; processMessage &gt; should handle context building failure" time="0.000592208">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; processMessage &gt; should block if trial expired" time="0.000104834">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; processMessage &gt; should block if daily AI limit reached" time="0.0000805">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect intent from message keywords" time="0.000064166">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should default to EXPLAIN intent" time="0.000049292">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _selectRole &gt; should select role based on intent" time="0.000049333">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _selectRole &gt; should downgrade role if policy restricts" time="0.000039541">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _selectRole &gt; should force ADVISOR in regulatory mode" time="0.00004875">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _buildPrompt &gt; should include context and user message" time="0.000126375">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; postProcessResponse &gt; should add standard footer" time="0.000357333">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; postProcessResponse &gt; should handle missing explanation" time="0.000044375">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiPolicyEngine.test.js" timestamp="2025-12-21T11:37:25.806Z" hostname="MacBook-Pro-Piotr.local" tests="10" failures="7" errors="0" skipped="0" time="0.181633416">
        <testcase classname="tests/unit/backend/aiPolicyEngine.test.js" name="AIPolicyEngine &gt; getEffectivePolicy() &gt; should return ADVISORY policy when regulatory mode is enabled" time="0.002557458">
        </testcase>
        <testcase classname="tests/unit/backend/aiPolicyEngine.test.js" name="AIPolicyEngine &gt; getEffectivePolicy() &gt; should return organization policy when no project override" time="0.00338425">
            <failure message="expected &apos;ADVISORY&apos; to be &apos;ASSISTED&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;ADVISORY&apos; to be &apos;ASSISTED&apos; // Object.is equality

Expected: &quot;ASSISTED&quot;
Received: &quot;ADVISORY&quot;

  tests/unit/backend/aiPolicyEngine.test.js:96:40
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPolicyEngine.test.js" name="AIPolicyEngine &gt; getEffectivePolicy() &gt; should apply project-level override (can only reduce)" time="0.0004565">
            <failure message="expected &apos;ADVISORY&apos; to be &apos;ASSISTED&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;ADVISORY&apos; to be &apos;ASSISTED&apos; // Object.is equality

Expected: &quot;ASSISTED&quot;
Received: &quot;ADVISORY&quot;

  tests/unit/backend/aiPolicyEngine.test.js:127:40
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPolicyEngine.test.js" name="AIPolicyEngine &gt; getEffectivePolicy() &gt; should not allow project override to exceed max level" time="0.000504875">
            <failure message="expected &apos;ADVISORY&apos; to be &apos;ASSISTED&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;ADVISORY&apos; to be &apos;ASSISTED&apos; // Object.is equality

Expected: &quot;ASSISTED&quot;
Received: &quot;ADVISORY&quot;

  tests/unit/backend/aiPolicyEngine.test.js:155:40
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPolicyEngine.test.js" name="AIPolicyEngine &gt; getEffectivePolicy() &gt; should include user preferences" time="0.000540833">
            <failure message="expected &apos;EXPERT&apos; to be &apos;FRIENDLY&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;EXPERT&apos; to be &apos;FRIENDLY&apos; // Object.is equality

Expected: &quot;FRIENDLY&quot;
Received: &quot;EXPERT&quot;

  tests/unit/backend/aiPolicyEngine.test.js:177:37
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPolicyEngine.test.js" name="AIPolicyEngine &gt; canPerformAction() &gt; should allow EXPLAIN_CONTEXT for ADVISORY policy" time="0.000437416">
        </testcase>
        <testcase classname="tests/unit/backend/aiPolicyEngine.test.js" name="AIPolicyEngine &gt; canPerformAction() &gt; should allow CREATE_DRAFT_TASK for ASSISTED policy" time="0.001168542">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/aiPolicyEngine.test.js:206:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPolicyEngine.test.js" name="AIPolicyEngine &gt; canPerformAction() &gt; should deny CREATE_DRAFT_TASK for ADVISORY policy" time="0.000364375">
        </testcase>
        <testcase classname="tests/unit/backend/aiPolicyEngine.test.js" name="AIPolicyEngine &gt; canPerformAction() &gt; should check regulatory mode first" time="0.000918167">
            <failure message="expected &apos;Action requires ASSISTED policy level&apos; to contain &apos;Regulatory Mode&apos;" type="AssertionError">
AssertionError: expected &apos;Action requires ASSISTED policy level&apos; to contain &apos;Regulatory Mode&apos;

Expected: &quot;Regulatory Mode&quot;
Received: &quot;Action requires ASSISTED policy level, but current is ADVISORY&quot;

  tests/unit/backend/aiPolicyEngine.test.js:233:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPolicyEngine.test.js" name="AIPolicyEngine &gt; getPolicyLevelForAction() &gt; should return correct policy level for action" time="0.000370917">
            <failure message="AIPolicyEngine.getPolicyLevelForAction is not a function" type="TypeError">
TypeError: AIPolicyEngine.getPolicyLevelForAction is not a function
  tests/unit/backend/aiPolicyEngine.test.js:239:35
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiPromptHierarchy.test.js" timestamp="2025-12-21T11:37:25.807Z" hostname="MacBook-Pro-Piotr.local" tests="18" failures="18" errors="0" skipped="0" time="0.184938333">
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; buildPromptStack() &gt; should build prompt stack with all layers" time="0.003551375">
            <failure message="AIPromptHierarchy.buildPromptStack is not a function" type="TypeError">
TypeError: AIPromptHierarchy.buildPromptStack is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:59:51
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; buildPromptStack() &gt; should use default prompts when custom not found" time="0.000614834">
            <failure message="AIPromptHierarchy.buildPromptStack is not a function" type="TypeError">
TypeError: AIPromptHierarchy.buildPromptStack is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:83:51
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getSystemPrompt() &gt; should return custom system prompt when available" time="0.000239042">
            <failure message="AIPromptHierarchy._getSystemPrompt is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getSystemPrompt is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:105:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getSystemPrompt() &gt; should return default system prompt when not found" time="0.000169958">
            <failure message="AIPromptHierarchy._getSystemPrompt is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getSystemPrompt is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:117:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getRolePrompt() &gt; should return role prompt for ADVISOR" time="0.000158791">
            <failure message="AIPromptHierarchy._getRolePrompt is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getRolePrompt is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:126:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getRolePrompt() &gt; should return role prompt for PMO_MANAGER" time="0.000128167">
            <failure message="AIPromptHierarchy._getRolePrompt is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getRolePrompt is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:132:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getRolePrompt() &gt; should return default for unknown role" time="0.000131833">
            <failure message="AIPromptHierarchy._getRolePrompt is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getRolePrompt is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:138:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getPhasePrompt() &gt; should return phase prompt for Context" time="0.000126583">
            <failure message="AIPromptHierarchy._getPhasePrompt is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getPhasePrompt is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:145:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getPhasePrompt() &gt; should return phase prompt for Execution" time="0.000132208">
            <failure message="AIPromptHierarchy._getPhasePrompt is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getPhasePrompt is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:151:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getPhasePrompt() &gt; should return empty string for unknown phase" time="0.000146042">
            <failure message="AIPromptHierarchy._getPhasePrompt is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getPhasePrompt is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:157:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getUserOverlay() &gt; should return user preferences overlay" time="0.00013875">
            <failure message="AIPromptHierarchy._getUserOverlay is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getUserOverlay is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:174:53
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getUserOverlay() &gt; should filter out disallowed preferences" time="0.000159416">
            <failure message="AIPromptHierarchy._getUserOverlay is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getUserOverlay is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:190:53
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _getUserOverlay() &gt; should return empty string when no preferences" time="0.000174458">
            <failure message="AIPromptHierarchy._getUserOverlay is not a function" type="TypeError">
TypeError: AIPromptHierarchy._getUserOverlay is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:203:53
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; combinePrompts() &gt; should combine prompts in correct order" time="0.000121292">
            <failure message="AIPromptHierarchy.combinePrompts is not a function" type="TypeError">
TypeError: AIPromptHierarchy.combinePrompts is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:218:48
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; combinePrompts() &gt; should handle missing layers" time="0.000106709">
            <failure message="AIPromptHierarchy.combinePrompts is not a function" type="TypeError">
TypeError: AIPromptHierarchy.combinePrompts is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:237:48
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _validateUserPreference() &gt; should allow valid tone preference" time="0.000115625">
            <failure message="AIPromptHierarchy._validateUserPreference is not a function" type="TypeError">
TypeError: AIPromptHierarchy._validateUserPreference is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:246:47
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _validateUserPreference() &gt; should reject invalid tone preference" time="0.000100958">
            <failure message="AIPromptHierarchy._validateUserPreference is not a function" type="TypeError">
TypeError: AIPromptHierarchy._validateUserPreference is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:251:47
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiPromptHierarchy.test.js" name="AIPromptHierarchy &gt; _validateUserPreference() &gt; should allow valid response length" time="0.000087208">
            <failure message="AIPromptHierarchy._validateUserPreference is not a function" type="TypeError">
TypeError: AIPromptHierarchy._validateUserPreference is not a function
  tests/unit/backend/aiPromptHierarchy.test.js:256:47
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiRiskChangeControl.test.js" timestamp="2025-12-21T11:37:25.809Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="3" time="0.206965833">
        <testcase classname="tests/unit/backend/aiRiskChangeControl.test.js" name="AI Risk &amp; Change Control Service &gt; Logic: _suggestMitigation &gt; should return correct mitigation strategies" time="0.011025042">
        </testcase>
        <testcase classname="tests/unit/backend/aiRiskChangeControl.test.js" name="AI Risk &amp; Change Control Service &gt; detectRisks (Integration) &gt; should aggregate risks from all detectors [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiRiskChangeControl.test.js" name="AI Risk &amp; Change Control Service &gt; trackScopeChange &gt; should log scope change [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiRiskChangeControl.test.js" name="AI Risk &amp; Change Control Service &gt; preEscalationWarning &gt; should identify when escalation is NOT needed (Logic Check)" time="0.001435083">
        </testcase>
        <testcase classname="tests/unit/backend/aiRiskChangeControl.test.js" name="AI Risk &amp; Change Control Service &gt; preEscalationWarning &gt; should trigger warning for critical risks [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiRoleGuard.test.js" timestamp="2025-12-21T11:37:25.810Z" hostname="MacBook-Pro-Piotr.local" tests="24" failures="10" errors="0" skipped="0" time="0.150928708">
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; getProjectRole() &gt; should return ADVISOR as default for null projectId" time="0.000758667">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; getProjectRole() &gt; should return project AI role from database" time="0.004357667">
            <failure message="expected &apos;ADVISOR&apos; to be &apos;MANAGER&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;ADVISOR&apos; to be &apos;MANAGER&apos; // Object.is equality

Expected: &quot;MANAGER&quot;
Received: &quot;ADVISOR&quot;

  tests/unit/backend/aiRoleGuard.test.js:46:26
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; getProjectRole() &gt; should default to ADVISOR when project not found" time="0.000535083">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; getProjectRole() &gt; should default to ADVISOR on database error" time="0.000263083">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; setProjectRole() &gt; should set project AI role" time="0.0013185">
            <system-out>
[AIRoleGuard] Project proj-test-123 AI role set to OPERATOR by user user-123

            </system-out>
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/aiRoleGuard.test.js:91:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; setProjectRole() &gt; should reject invalid role" time="0.000764375">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; setProjectRole() &gt; should handle database errors" time="0.001587959">
            <system-out>
[AIRoleGuard] Project proj-test-123 AI role set to MANAGER by user user-123

            </system-out>
            <failure message="promise resolved &quot;{ updated: false, (2) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ updated: false, (2) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;projectId&quot;: &quot;proj-test-123&quot;,
+   &quot;role&quot;: &quot;MANAGER&quot;,
+   &quot;updated&quot;: false,
  }

  tests/unit/backend/aiRoleGuard.test.js:118:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; canPerformAction() &gt; should allow EXPLAIN_CONTEXT for ADVISOR" time="0.000301541">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; canPerformAction() &gt; should block CREATE_DRAFT_TASK for ADVISOR" time="0.000536583">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; canPerformAction() &gt; should allow CREATE_DRAFT_TASK for MANAGER" time="0.000462708">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/aiRoleGuard.test.js:159:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; canPerformAction() &gt; should allow EXECUTE_TASK_UPDATE for OPERATOR" time="0.000308667">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/aiRoleGuard.test.js:173:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; canPerformAction() &gt; should block EXECUTE_TASK_UPDATE for MANAGER" time="0.000187458">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; canPerformAction() &gt; should allow unknown action types (default allow)" time="0.000183792">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; isActionBlocked() &gt; should return blocked=false for allowed actions" time="0.000579">
            <failure message="expected true to be false // Object.is equality" type="AssertionError">
AssertionError: expected true to be false // Object.is equality

- Expected
+ Received

- false
+ true

  tests/unit/backend/aiRoleGuard.test.js:215:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; isActionBlocked() &gt; should return blocked=true with details for blocked actions" time="0.000476375">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; validateMutation() &gt; should block all mutations for ADVISOR" time="0.000570292">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; validateMutation() &gt; should allow mutations as drafts for MANAGER" time="0.000801792">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/aiRoleGuard.test.js:260:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; validateMutation() &gt; should allow mutations for OPERATOR" time="0.000500625">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/aiRoleGuard.test.js:275:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; validateMutation() &gt; should fail-safe to ADVISOR for unknown role" time="0.000844125">
            <failure message="expected &apos;AI is in ADVISOR mode and cannot perf&apos; to contain &apos;Unknown AI role&apos;" type="AssertionError">
AssertionError: expected &apos;AI is in ADVISOR mode and cannot perf&apos; to contain &apos;Unknown AI role&apos;

Expected: &quot;Unknown AI role&quot;
Received: &quot;AI is in ADVISOR mode and cannot perform any mutations. Only explanations and suggestions are allowed.&quot;

  tests/unit/backend/aiRoleGuard.test.js:291:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; getRoleCapabilities() &gt; should return capabilities for ADVISOR" time="0.000147417">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; getRoleCapabilities() &gt; should return capabilities for MANAGER" time="0.000082">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; getRoleCapabilities() &gt; should return capabilities for OPERATOR" time="0.000071083">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; getRoleCapabilities() &gt; should default to ADVISOR for unknown role" time="0.00005875">
        </testcase>
        <testcase classname="tests/unit/backend/aiRoleGuard.test.js" name="AIRoleGuard &gt; getRoleConfig() &gt; should return full role configuration" time="0.00037625">
            <failure message="expected &apos;ADVISOR&apos; to be &apos;MANAGER&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;ADVISOR&apos; to be &apos;MANAGER&apos; // Object.is equality

Expected: &quot;MANAGER&quot;
Received: &quot;ADVISOR&quot;

  tests/unit/backend/aiRoleGuard.test.js:334:39
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiService.test.js" timestamp="2025-12-21T11:37:25.811Z" hostname="MacBook-Pro-Piotr.local" tests="36" failures="0" errors="0" skipped="4" time="0.172973834">
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; callLLM &gt; should use Google Gemini by default if checks pass" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; callLLM &gt; should block if balance is insufficient" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; callLLM &gt; should call OpenAI via fetch when provider is openai" time="0.001955125">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; callLLM &gt; should call Anthropic via fetch when provider is anthropic" time="0.000198083">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; generateInitiatives &gt; should parse JSON response correctly" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; generateInitiatives &gt; should return empty array on JSON parse error" time="0.007593667">
            <system-err>
LLM Call Error Error: AI Provider not configured.
    at Object.callLLM (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/aiService.js:181:41)
    at Object.generateInitiatives (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/aiService.js:707:29)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/aiService.test.js:213:33
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:20

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; streamLLM &gt; should yield chunks from Gemini stream" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; streamLLM &gt; should handle errors in stream" time="0.002376125">
            <system-err>
Stream LLM Error Error: AI Provider not configured.
    at Object.streamLLM (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/aiService.js:420:41)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/aiService.test.js:241:30
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:20

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; buildRoadmap &gt; should return roadmap object on success" time="0.000387208">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; buildRoadmap &gt; should return empty object on error" time="0.000150167">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; suggestTasks &gt; should return tasks array on success" time="0.000390541">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; deepDiagnose &gt; should execute chain of thought and return diagnosis" time="0.000193625">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; enrichInitiative &gt; should maintain structure and fallback to LLM" time="0.000320625">
            <system-err>
Web Search failed, using LLM knowledge Error: Web Fail
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/aiService.test.js:311:59
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:12)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; generateObservations &gt; should return observations from feedback" time="0.000239625">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; testProviderConnection &gt; should test OpenAI connection" time="0.000243833">
            <system-out>
[AiService] Testing connection for: openai

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; enhancePrompt &gt; should return base system role when no extras found" time="0.000073083">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; enhancePrompt &gt; should inject global strategies" time="0.000075167">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; enhancePrompt &gt; should inject client context when orgId provided" time="0.002194417">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Queue Operations &gt; should enqueue task and return jobId" time="0.000308083">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Queue Operations &gt; should get job status" time="0.0001095">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Queue Operations &gt; should return null for non-existent job" time="0.000052334">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Vision Capabilities &gt; should format payload correctly for OpenAI Vision" time="0.000191291">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Vision Capabilities &gt; should use Gemini 1.5 Flash for vision fallback" time="0.000791666">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Advanced Streaming &gt; should parse OpenAI SSE stream correctly" time="0.000360791">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Advanced Streaming &gt; should handle OpenAI stream error" time="0.000324042">
            <system-err>
Stream LLM Error Error: Stream Error
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/aiService.test.js:237:69
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:12)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Provider Integrations &gt; should generate JWT for Zhipu AI provider" time="0.001249625">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateTaskInsight &gt; should return parsed insights when LLM returns valid JSON" time="0.000258917">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateTaskInsight &gt; should return fallback object on LLM failure/JSON error" time="0.000220625">
            <system-err>
Task Insight Error Error: LLM Fail
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/aiService.test.js:630:42
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:12)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateExecutionStrategy &gt; should return strategy object on success" time="0.000114542">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateExecutionStrategy &gt; should return empty structure on error" time="0.000150167">
            <system-err>
Execution Gen Error SyntaxError: Unexpected token &apos;N&apos;, &quot;Not JSON&quot; is not valid JSON
    at JSON.parse (&lt;anonymous&gt;)
    at Object.generateExecutionStrategy (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/aiService.js:923:25)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/aiService.test.js:658:28
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:20

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateInsights (Pre-Mortem) &gt; should return insights on success" time="0.000083458">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateInsights (Pre-Mortem) &gt; should return fallback on error" time="0.000158458">
            <system-err>
Insights Gen Error Error: Fail
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/aiService.test.js:679:42
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:12)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateStrategicFit &gt; should return fit analysis on success" time="0.000095708">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateStrategicFit &gt; should return fallback on error" time="0.000117708">
            <system-err>
Fit Check Error SyntaxError: Unexpected token &apos;B&apos;, &quot;Bad JSON&quot; is not valid JSON
    at JSON.parse (&lt;anonymous&gt;)
    at Object.generateStrategicFit (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/aiService.js:985:25)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/aiService.test.js:704:28
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:20

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; simulateEconomics &gt; should combine financial simulation with AI commentary" time="0.000095125">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; simulateEconomics &gt; should return just simulation if AI fails" time="0.0000605">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiWorkloadIntelligence.test.js" timestamp="2025-12-21T11:37:25.813Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="4" time="0.187248375">
        <testcase classname="tests/unit/backend/aiWorkloadIntelligence.test.js" name="AI Workload Intelligence Service &gt; Logic: _getWorkloadStatus &gt; should classify utilization correctly" time="0.00917025">
        </testcase>
        <testcase classname="tests/unit/backend/aiWorkloadIntelligence.test.js" name="AI Workload Intelligence Service &gt; Logic: _calculateBurnoutRisk &gt; should calculate risk score based on factors" time="0.0012565">
        </testcase>
        <testcase classname="tests/unit/backend/aiWorkloadIntelligence.test.js" name="AI Workload Intelligence Service &gt; getPortfolioWorkload &gt; should calculate workload metrics from DB data [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiWorkloadIntelligence.test.js" name="AI Workload Intelligence Service &gt; detectOverAllocation &gt; should detect users with weeks exceeding capacity [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiWorkloadIntelligence.test.js" name="AI Workload Intelligence Service &gt; suggestRebalancing &gt; should return no suggestions if no over-allocation [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiWorkloadIntelligence.test.js" name="AI Workload Intelligence Service &gt; suggestRebalancing &gt; should suggest reassignment when capacity exists [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/analyticsService.test.js" timestamp="2025-12-21T11:37:25.814Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.360223459">
        <testcase classname="tests/unit/backend/analyticsService.test.js" name="AnalyticsService - Integration &gt; logUsage &gt; should log AI usage to the database without errors" time="0.001424625">
        </testcase>
        <testcase classname="tests/unit/backend/analyticsService.test.js" name="AnalyticsService - Integration &gt; getStats &gt; should retrieve aggregated stats from real database" time="0.0014395">
        </testcase>
        <testcase classname="tests/unit/backend/analyticsService.test.js" name="AnalyticsService - Integration &gt; getTopTopics &gt; should retrieve top topics from real database" time="0.001077166">
        </testcase>
        <testcase classname="tests/unit/backend/analyticsService.test.js" name="AnalyticsService - Integration &gt; saveMaturityScore &gt; should save maturity score without errors" time="0.000430833">
        </testcase>
        <testcase classname="tests/unit/backend/analyticsService.test.js" name="AnalyticsService - Integration &gt; getIndustryBenchmarks &gt; should retrieve industry benchmarks from real database" time="0.00050325">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/assessmentService.test.js" timestamp="2025-12-21T11:37:25.814Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="2" time="0.26457025">
        <testcase classname="tests/unit/backend/assessmentService.test.js" name="Assessment Service &gt; Logic: generateGapSummary &gt; should interpret gaps correctly" time="0.007518709">
        </testcase>
        <testcase classname="tests/unit/backend/assessmentService.test.js" name="Assessment Service &gt; getAssessment &gt; should retrieve and parse assessment [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/assessmentService.test.js" name="Assessment Service &gt; saveAssessment &gt; should calculate totals and save [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/attributionService.test.js" timestamp="2025-12-21T11:37:25.814Z" hostname="MacBook-Pro-Piotr.local" tests="18" failures="0" errors="0" skipped="15" time="0.101673583">
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; constants &gt; should export SOURCE_TYPES" time="0.000752334">
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; recordAttribution - skipped due to CJS/ESM mock interop &gt; should throw error for missing organizationId" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; recordAttribution - skipped due to CJS/ESM mock interop &gt; should throw error for missing sourceType" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; recordAttribution - skipped due to CJS/ESM mock interop &gt; should throw error for invalid sourceType" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; recordAttribution - skipped due to CJS/ESM mock interop &gt; should record DEMO attribution successfully" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; recordAttribution - skipped due to CJS/ESM mock interop &gt; should record PROMO_CODE attribution successfully" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; recordAttribution - skipped due to CJS/ESM mock interop &gt; should record INVITATION attribution with metadata" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; getOrganizationAttribution - skipped due to CJS/ESM mock interop &gt; should return all attribution events for org" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; getOrganizationAttribution - skipped due to CJS/ESM mock interop &gt; should return empty array for org with no attribution" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; getFirstAttribution - skipped due to CJS/ESM mock interop &gt; should return first attribution event" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; getFirstAttribution - skipped due to CJS/ESM mock interop &gt; should return null for org with no attribution" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; hasAttribution - skipped due to CJS/ESM mock interop &gt; should return true if org has attribution" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; hasAttribution - skipped due to CJS/ESM mock interop &gt; should return false if org has no attribution" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; exportAttribution - skipped due to CJS/ESM mock interop &gt; should export with filters" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; exportAttribution - skipped due to CJS/ESM mock interop &gt; should export all without filters" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; getPartnerSummary - skipped due to CJS/ESM mock interop &gt; should return partner summary for settlements" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; immutability principle &gt; should not expose update methods" time="0.000131542">
        </testcase>
        <testcase classname="tests/unit/backend/attributionService.test.js" name="AttributionService &gt; immutability principle &gt; should only have append-only recordAttribution" time="0.0001055">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/baselineService.test.js" timestamp="2025-12-21T11:37:25.815Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="3" time="0">
        <testcase classname="tests/unit/backend/baselineService.test.js" name="Baseline Service &gt; calculateVariance &gt; should calculate delay correctly when mocking dependencies [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/baselineService.test.js" name="Baseline Service &gt; calculateVariance &gt; should mark critical delays [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/baselineService.test.js" name="Baseline Service &gt; captureBaseline &gt; should create snapshot from roadmap initiatives [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/billingService.test.js" timestamp="2025-12-21T11:37:25.815Z" hostname="MacBook-Pro-Piotr.local" tests="19" failures="12" errors="0" skipped="0" time="0.183935208">
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; getPlans() &gt; should return all active subscription plans" time="0.005783917">
            <failure message="expected [ { id: &apos;plan-trial&apos;, (10) }, (3) ] to have a length of 2 but got 4" type="AssertionError">
AssertionError: expected [ { id: &apos;plan-trial&apos;, (10) }, (3) ] to have a length of 2 but got 4

- Expected
+ Received

- 2
+ 4

  tests/unit/backend/billingService.test.js:77:27
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; getPlans() &gt; should handle database errors" time="0.0014605">
            <failure message="promise resolved &quot;[ { id: &apos;plan-trial&apos;, (10) }, (3) ]&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;[ { id: &apos;plan-trial&apos;, (10) }, (3) ]&quot; instead of rejecting

- Expected: 
Error {
  &quot;message&quot;: &quot;rejected promise&quot;,
}

+ Received: 
[
  {
    &quot;created_at&quot;: &quot;2025-12-21 11:37:18&quot;,
    &quot;features&quot;: &quot;{\&quot;printing\&quot;:false,\&quot;analytics\&quot;:\&quot;basic\&quot;,\&quot;duration_days\&quot;:7}&quot;,
    &quot;id&quot;: &quot;plan-trial&quot;,
    &quot;is_active&quot;: 1,
    &quot;name&quot;: &quot;Trial (7 Days)&quot;,
    &quot;price_monthly&quot;: 0,
    &quot;storage_limit_gb&quot;: 1,
    &quot;storage_overage_rate&quot;: null,
    &quot;stripe_price_id&quot;: null,
    &quot;token_limit&quot;: 10000,
    &quot;token_overage_rate&quot;: null,
  },
  {
    &quot;created_at&quot;: &quot;2025-12-21 11:37:18&quot;,
    &quot;features&quot;: &quot;{\&quot;printing\&quot;:true,\&quot;analytics\&quot;:\&quot;standard\&quot;}&quot;,
    &quot;id&quot;: &quot;plan-pro&quot;,
    &quot;is_active&quot;: 1,
    &quot;name&quot;: &quot;Pro&quot;,
    &quot;price_monthly&quot;: 299,
    &quot;storage_limit_gb&quot;: 50,
    &quot;storage_overage_rate&quot;: null,
    &quot;stripe_price_id&quot;: null,
    &quot;token_limit&quot;: 500000,
    &quot;token_overage_rate&quot;: null,
  },
  {
    &quot;created_at&quot;: &quot;2025-12-21 11:37:18&quot;,
    &quot;features&quot;: &quot;{\&quot;printing\&quot;:true,\&quot;analytics\&quot;:\&quot;advanced\&quot;}&quot;,
    &quot;id&quot;: &quot;plan-elite&quot;,
    &quot;is_active&quot;: 1,
    &quot;name&quot;: &quot;Elite&quot;,
    &quot;price_monthly&quot;: 999,
    &quot;storage_limit_gb&quot;: 500,
    &quot;storage_overage_rate&quot;: null,
    &quot;stripe_price_id&quot;: null,
    &quot;token_limit&quot;: 2000000,
    &quot;token_overage_rate&quot;: null,
  },
  {
    &quot;created_at&quot;: &quot;2025-12-21 11:37:18&quot;,
    &quot;features&quot;: &quot;{\&quot;printing\&quot;:true,\&quot;analytics\&quot;:\&quot;full\&quot;,\&quot;support\&quot;:\&quot;dedicated\&quot;}&quot;,
    &quot;id&quot;: &quot;plan-enterprise&quot;,
    &quot;is_active&quot;: 1,
    &quot;name&quot;: &quot;Enterprise&quot;,
    &quot;price_monthly&quot;: 2999,
    &quot;storage_limit_gb&quot;: 5000,
    &quot;storage_overage_rate&quot;: null,
    &quot;stripe_price_id&quot;: null,
    &quot;token_limit&quot;: 10000000,
    &quot;token_overage_rate&quot;: null,
  },
]

  tests/unit/backend/billingService.test.js:91:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; getPlanById() &gt; should return plan by ID" time="0.000461792">
            <failure message="Cannot read properties of undefined (reading &apos;id&apos;)" type="TypeError">
TypeError: Cannot read properties of undefined (reading &apos;id&apos;)
  tests/unit/backend/billingService.test.js:109:25
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; getPlanById() &gt; should return null for non-existent plan" time="0.000771333">
            <failure message="expected undefined to be null" type="AssertionError">
AssertionError: expected undefined to be null

- Expected: 
null

+ Received: 
undefined

  tests/unit/backend/billingService.test.js:119:26
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; createPlan() &gt; should create a new subscription plan" time="0.001412958">
            <failure message="expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0
" type="AssertionError">
AssertionError: expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0

  tests/unit/backend/billingService.test.js:140:32
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; getOrganizationBilling() &gt; should return billing info for organization" time="0.000637334">
            <failure message="Cannot read properties of undefined (reading &apos;organization_id&apos;)" type="TypeError">
TypeError: Cannot read properties of undefined (reading &apos;organization_id&apos;)
  tests/unit/backend/billingService.test.js:162:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; getOrganizationBilling() &gt; should return null for organization without billing" time="0.001195542">
            <failure message="expected undefined to be null" type="AssertionError">
AssertionError: expected undefined to be null

- Expected: 
null

+ Received: 
undefined

  tests/unit/backend/billingService.test.js:174:29
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; upsertOrganizationBilling() &gt; should create billing record for new organization" time="0.002333708">
            <failure message="expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0
" type="AssertionError">
AssertionError: expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0

  tests/unit/backend/billingService.test.js:193:32
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; upsertOrganizationBilling() &gt; should update existing billing record" time="0.00101025">
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; getOrCreateStripeCustomer() &gt; should return mock customer when Stripe not configured" time="0.000526542">
            <system-err>
Stripe not configured, returning mock customer

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; getOrCreateStripeCustomer() &gt; should return existing customer when found" time="0.000186583">
            <system-err>
Stripe not configured, returning mock customer

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; createSubscription() &gt; should create mock subscription when Stripe not configured" time="0.0005335">
            <failure message="Invalid plan" type="Error">
Error: Invalid plan
  Object.createSubscription server/services/billingService.js:240:22
  tests/unit/backend/billingService.test.js:273:34
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; createSubscription() &gt; should throw error for invalid plan" time="0.001282917">
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; cancelSubscription() &gt; should cancel subscription" time="0.000693042">
            <failure message="No active subscription" type="Error">
Error: No active subscription
  Object.cancelSubscription server/services/billingService.js:283:15
  tests/unit/backend/billingService.test.js:312:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; cancelSubscription() &gt; should throw error when no active subscription" time="0.000636125">
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; getInvoices() &gt; should return invoices for organization" time="0.001089042">
            <failure message="expected [] to have a length of 2 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 2 but got +0

- Expected
+ Received

- 2
+ 0

  tests/unit/backend/billingService.test.js:343:30
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; getInvoices() &gt; should only return invoices for specified organization" time="0.00034625">
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; Multi-Tenant Isolation &gt; should only access billing for specified organization" time="0.000240708">
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService &gt; Multi-Tenant Isolation &gt; should not leak invoices between organizations" time="0.000979333">
            <failure message="expected [] to have a length of 1 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

  tests/unit/backend/billingService.test.js:402:31
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/capacityService.test.js" timestamp="2025-12-21T11:37:25.817Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="3" errors="0" skipped="0" time="0.184334542">
        <testcase classname="tests/unit/backend/capacityService.test.js" name="CapacityService &gt; getUserCapacity &gt; should return default capacity if not found" time="0.000798541">
        </testcase>
        <testcase classname="tests/unit/backend/capacityService.test.js" name="CapacityService &gt; getUserCapacity &gt; should return stored capacity" time="0.003412875">
            <failure message="expected undefined to be 30 // Object.is equality" type="AssertionError">
AssertionError: expected undefined to be 30 // Object.is equality

- Expected: 
30

+ Received: 
undefined

  tests/unit/backend/capacityService.test.js:61:46
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/capacityService.test.js" name="CapacityService &gt; calculateUserCapacity &gt; should calculate capacity based on tasks" time="0.0019815">
            <failure message="expected undefined to be defined" type="AssertionError">
AssertionError: expected undefined to be defined
  tests/unit/backend/capacityService.test.js:92:30
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/capacityService.test.js" name="CapacityService &gt; detectOverloads &gt; should identify users with overloaded weeks" time="0.001767125">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/capacityService.test.js:147:41
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/capacityService.test.js" name="CapacityService &gt; suggestResolutions &gt; should suggest REASSIGN for sustained overload" time="0.00012675">
        </testcase>
        <testcase classname="tests/unit/backend/capacityService.test.js" name="CapacityService &gt; suggestResolutions &gt; should suggest RESEQUENCE for peak overload" time="0.000054041">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/connectorHealthService.test.js" timestamp="2025-12-21T11:37:25.817Z" hostname="MacBook-Pro-Piotr.local" tests="1" failures="0" errors="0" skipped="0" time="0.196222458">
        <testcase classname="tests/unit/backend/connectorHealthService.test.js" name="Connector Health Service &gt; should perform health check (DB interaction) [SKIPPED]" time="0.000476708">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/connectorService.test.js" timestamp="2025-12-21T11:37:25.818Z" hostname="MacBook-Pro-Piotr.local" tests="1" failures="0" errors="0" skipped="0" time="0.146404583">
        <testcase classname="tests/unit/backend/connectorService.test.js" name="Connector Service &gt; should manage connectors (DB interaction) [SKIPPED]" time="0.0005795">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/contextService.test.js" timestamp="2025-12-21T11:37:25.818Z" hostname="MacBook-Pro-Piotr.local" tests="1" failures="0" errors="0" skipped="0" time="0.196130708">
        <testcase classname="tests/unit/backend/contextService.test.js" name="Context Service &gt; should handle context operations (DB interaction) [SKIPPED]" time="0.001284458">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/criticalPathService.test.js" timestamp="2025-12-21T11:37:25.818Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="0" errors="0" skipped="0" time="0.113120917">
        <testcase classname="tests/unit/backend/criticalPathService.test.js" name="CriticalPathService &gt; calculateCriticalPath &gt; should identify critical path correctly" time="0.001054208">
        </testcase>
        <testcase classname="tests/unit/backend/criticalPathService.test.js" name="CriticalPathService &gt; calculateCriticalPath &gt; should handle disjoint paths logic" time="0.000208166">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/dependencyService.test.js" timestamp="2025-12-21T11:37:25.818Z" hostname="MacBook-Pro-Piotr.local" tests="9" failures="0" errors="0" skipped="0" time="0.114233125">
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; addDependency &gt; should add dependency" time="0.001563542">
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; addDependency &gt; should prevent self-dependency" time="0.00064075">
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; removeDependency &gt; should remove dependency" time="0.000125833">
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; getDependencies &gt; should return dependencies" time="0.000277375">
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; buildDependencyGraph &gt; should build graph structure" time="0.000360958">
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; detectDeadlocks &gt; should detect cycles" time="0.000137666">
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; detectDeadlocks &gt; should return false for acyclic graph" time="0.000077041">
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; canStart &gt; should be true if no blockers" time="0.000091708">
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; canStart &gt; should be false if blockers exist" time="0.000111458">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/economicsService.test.js" timestamp="2025-12-21T11:37:25.818Z" hostname="MacBook-Pro-Piotr.local" tests="18" failures="8" errors="0" skipped="0" time="0.193373416">
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; createValueHypothesis() &gt; should create a value hypothesis" time="0.006470084">
            <failure message="expected &apos;034e8749-bd2e-4fa6-b873-01fc1232d8d3&apos; to be &apos;hypothesis-1&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;034e8749-bd2e-4fa6-b873-01fc1232d8d3&apos; to be &apos;hypothesis-1&apos; // Object.is equality

Expected: &quot;hypothesis-1&quot;
Received: &quot;034e8749-bd2e-4fa6-b873-01fc1232d8d3&quot;

  tests/unit/backend/economicsService.test.js:65:31
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; createValueHypothesis() &gt; should default confidenceLevel to MEDIUM" time="0.000726583">
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; createValueHypothesis() &gt; should handle empty relatedInitiativeIds" time="0.000423166">
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; createValueHypothesis() &gt; should handle database errors" time="0.00230675">
            <failure message="promise resolved &quot;{ (4) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ (4) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;description&quot;: &quot;Test&quot;,
+   &quot;id&quot;: &quot;112d6da1-c530-4442-bec4-556cab40790c&quot;,
+   &quot;initiativeId&quot;: &quot;init-123&quot;,
+   &quot;type&quot;: &quot;EFFICIENCY&quot;,
  }

  tests/unit/backend/economicsService.test.js:120:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; getValueHypotheses() &gt; should retrieve value hypotheses for a project" time="0.001473167">
            <failure message="expected [ { (17) }, { (17) }, (2) ] to have a length of 1 but got 4" type="AssertionError">
AssertionError: expected [ { (17) }, { (17) }, (2) ] to have a length of 1 but got 4

- Expected
+ Received

- 1
+ 4

  tests/unit/backend/economicsService.test.js:148:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; getValueHypotheses() &gt; should filter by initiativeId when provided" time="0.0015725">
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; getValueHypotheses() &gt; should handle invalid JSON in relatedInitiativeIds" time="0.001672917">
            <failure message="expected [ &apos;init-456&apos; ] to deeply equal []" type="AssertionError">
AssertionError: expected [ &apos;init-456&apos; ] to deeply equal []

- Expected
+ Received

- []
+ [
+   &quot;init-456&quot;,
+ ]

  tests/unit/backend/economicsService.test.js:180:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; validateHypothesis() &gt; should validate a value hypothesis" time="0.002677458">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/economicsService.test.js:199:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; validateHypothesis() &gt; should return false when hypothesis not found" time="0.001249209">
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; addFinancialAssumption() &gt; should add financial assumption to hypothesis" time="0.002591292">
            <failure message="expected &apos;b0375d15-522f-42f6-ac34-a4d449bedb10&apos; to be &apos;hypothesis-1&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;b0375d15-522f-42f6-ac34-a4d449bedb10&apos; to be &apos;hypothesis-1&apos; // Object.is equality

Expected: &quot;hypothesis-1&quot;
Received: &quot;b0375d15-522f-42f6-ac34-a4d449bedb10&quot;

  tests/unit/backend/economicsService.test.js:241:31
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; addFinancialAssumption() &gt; should default currency to USD" time="0.00087375">
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; addFinancialAssumption() &gt; should default timeframe to &quot;per year&quot;" time="0.000429792">
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; detectMissingValueHypotheses() &gt; should detect initiatives without value hypotheses" time="0.000599833">
            <failure message="expected +0 to be 2 // Object.is equality" type="AssertionError">
AssertionError: expected +0 to be 2 // Object.is equality

- Expected
+ Received

- 2
+ 0

  tests/unit/backend/economicsService.test.js:297:34
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; detectMissingValueHypotheses() &gt; should return empty array when all initiatives have hypotheses" time="0.00053825">
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; getValueSummary() &gt; should generate value summary for project" time="0.001561541">
            <failure message="expected [ { type: &apos;EFFICIENCY&apos;, (2) } ] to deeply equal [ { type: &apos;EFFICIENCY&apos;, (2) } ]" type="AssertionError">
AssertionError: expected [ { type: &apos;EFFICIENCY&apos;, (2) } ] to deeply equal [ { type: &apos;EFFICIENCY&apos;, (2) } ]

- Expected
+ Received

  [
    {
-     &quot;count&quot;: 2,
+     &quot;count&quot;: 4,
      &quot;type&quot;: &quot;EFFICIENCY&quot;,
-     &quot;validated&quot;: 1,
+     &quot;validated&quot;: 0,
    },
  ]

  tests/unit/backend/economicsService.test.js:345:45
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; getValueSummary() &gt; should handle missing financial data" time="0.00091825">
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should export VALUE_TYPES enum" time="0.000190125">
        </testcase>
        <testcase classname="tests/unit/backend/economicsService.test.js" name="EconomicsService &gt; Multi-Tenant Isolation &gt; should filter hypotheses by project_id" time="0.001683167">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/edgeCases.test.js" timestamp="2025-12-21T11:37:25.820Z" hostname="MacBook-Pro-Piotr.local" tests="15" failures="4" errors="0" skipped="0" time="0.176872792">
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Null and Undefined Handling &gt; should handle null organizationId gracefully" time="0.001334125">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Null and Undefined Handling &gt; should handle undefined projectId in storage" time="0.00020675">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Empty Data Handling &gt; should handle empty arrays in queries" time="0.000637416">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Empty Data Handling &gt; should handle empty search results" time="0.000815958">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Boundary Conditions &gt; should handle maximum token limit" time="0.001011791">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Boundary Conditions &gt; should handle zero token limit (unlimited)" time="0.000176125">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Invalid Input Handling &gt; should reject invalid email format in invitations" time="0.003215958">
            <failure message="InvitationService.setDependencies is not a function" type="TypeError">
TypeError: InvitationService.setDependencies is not a function
  tests/unit/backend/edgeCases.test.js:132:31
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Invalid Input Handling &gt; should reject invalid evidence type" time="0.000726125">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Invalid Input Handling &gt; should reject invalid entity type in evidence linking" time="0.000166208">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Database Error Handling &gt; should handle database connection errors gracefully" time="0.003494958">
            <failure message="promise resolved &quot;{ (7) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ (7) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;createdBy&quot;: &quot;user-admin-123&quot;,
+   &quot;description&quot;: &quot;Test&quot;,
+   &quot;id&quot;: &quot;96c62373-b50a-43e3-b6fb-726ab9a5622f&quot;,
+   &quot;projectId&quot;: &quot;project-123&quot;,
+   &quot;status&quot;: &quot;DRAFT&quot;,
+   &quot;title&quot;: &quot;Test&quot;,
+   &quot;type&quot;: &quot;TECHNICAL&quot;,
  }

  tests/unit/backend/edgeCases.test.js:195:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Database Error Handling &gt; should handle constraint violations" time="0.00260325">
            <failure message="expected [Function] to throw error including &apos;UNIQUE constraint failed&apos; but got &apos;SQLITE_CONSTRAINT: NOT NULL constrain&apos;" type="AssertionError">
AssertionError: expected [Function] to throw error including &apos;UNIQUE constraint failed&apos; but got &apos;SQLITE_CONSTRAINT: NOT NULL constrain&apos;

Expected: &quot;UNIQUE constraint failed&quot;
Received: &quot;SQLITE_CONSTRAINT: NOT NULL constraint failed: organization_members.user_id&quot;

  tests/unit/backend/edgeCases.test.js:206:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Concurrent Modification Handling &gt; should handle optimistic locking failures" time="0.000258">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Large Data Handling &gt; should handle large result sets efficiently" time="0.000595292">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Large Data Handling &gt; should handle large payloads in storage" time="0.000109042">
        </testcase>
        <testcase classname="tests/unit/backend/edgeCases.test.js" name="Edge Cases and Error Scenarios &gt; Timeout Handling &gt; should handle slow database queries" time="0.0007515">
            <failure message="expected 1 to be greater than or equal to 100" type="AssertionError">
AssertionError: expected 1 to be greater than or equal to 100
  tests/unit/backend/edgeCases.test.js:297:30
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/emailService.test.js" timestamp="2025-12-21T11:37:25.821Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.240655583">
        <testcase classname="tests/unit/backend/emailService.test.js" name="Backend Service Test: EmailService &gt; sendEmail &gt; sends email with default config" time="0.002247209">
        </testcase>
        <testcase classname="tests/unit/backend/emailService.test.js" name="Backend Service Test: EmailService &gt; sendEmail &gt; uses SMTP settings from database" time="0.05498675">
        </testcase>
        <testcase classname="tests/unit/backend/emailService.test.js" name="Backend Service Test: EmailService &gt; sendEmail &gt; handles database errors gracefully" time="0.00073475">
        </testcase>
        <testcase classname="tests/unit/backend/emailService.test.js" name="Backend Service Test: EmailService &gt; sendEmail &gt; logs email details" time="0.000695041">
        </testcase>
        <testcase classname="tests/unit/backend/emailService.test.js" name="Backend Service Test: EmailService &gt; sendEmail &gt; uses environment variables when database settings are missing" time="0.000709292">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/escalationService.test.js" timestamp="2025-12-21T11:37:25.821Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="9" errors="0" skipped="0" time="0.189344166">
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; createEscalation() &gt; should create an escalation and send notification" time="0.006326">
            <failure message="expected &apos;c5e533e1-1137-47d5-babd-6df7675504d7&apos; to be &apos;escalation-1&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;c5e533e1-1137-47d5-babd-6df7675504d7&apos; to be &apos;escalation-1&apos; // Object.is equality

Expected: &quot;escalation-1&quot;
Received: &quot;c5e533e1-1137-47d5-babd-6df7675504d7&quot;

  tests/unit/backend/escalationService.test.js:80:31
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; createEscalation() &gt; should default daysOverdue to 0" time="0.004329333">
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; createEscalation() &gt; should handle database errors" time="0.002919417">
            <failure message="promise resolved &quot;{ (4) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ (4) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;id&quot;: &quot;f46c604c-2880-4363-b080-8aca834315ad&quot;,
+   &quot;projectId&quot;: &quot;proj-test-123&quot;,
+   &quot;reason&quot;: &quot;Test&quot;,
+   &quot;toUserId&quot;: &quot;user-admin-123&quot;,
  }

  tests/unit/backend/escalationService.test.js:136:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; getEscalations() &gt; should retrieve escalations for a project" time="0.002483542">
            <failure message="expected [ { (18) }, { (18) }, { (18) } ] to deeply equal [ { id: &apos;esc-1&apos;, (6) } ]" type="AssertionError">
AssertionError: expected [ { (18) }, { (18) }, { (18) } ] to deeply equal [ { id: &apos;esc-1&apos;, (6) } ]

- Expected
+ Received

  [
    {
-     &quot;from_first&quot;: &quot;John&quot;,
-     &quot;from_last&quot;: &quot;Doe&quot;,
-     &quot;id&quot;: &quot;esc-1&quot;,
+     &quot;acknowledged_at&quot;: null,
+     &quot;created_at&quot;: &quot;2025-12-21 11:37:17&quot;,
+     &quot;days_overdue&quot;: 14,
+     &quot;from_first&quot;: null,
+     &quot;from_last&quot;: null,
+     &quot;from_user_id&quot;: &quot;user-123&quot;,
+     &quot;id&quot;: &quot;c5e533e1-1137-47d5-babd-6df7675504d7&quot;,
+     &quot;project_id&quot;: &quot;proj-test-123&quot;,
+     &quot;reason&quot;: &quot;Decision pending for 14+ days&quot;,
+     &quot;resolved_at&quot;: null,
+     &quot;source_id&quot;: &quot;decision-123&quot;,
+     &quot;source_type&quot;: &quot;DECISION&quot;,
+     &quot;status&quot;: &quot;PENDING&quot;,
+     &quot;to_first&quot;: null,
+     &quot;to_last&quot;: null,
+     &quot;to_role&quot;: &quot;ADMIN&quot;,
+     &quot;to_user_id&quot;: &quot;user-admin-123&quot;,
+     &quot;trigger_type&quot;: &quot;OVERDUE&quot;,
+   },
+   {
+     &quot;acknowledged_at&quot;: null,
+     &quot;created_at&quot;: &quot;2025-12-21 11:37:17&quot;,
+     &quot;days_overdue&quot;: 0,
+     &quot;from_first&quot;: null,
+     &quot;from_last&quot;: null,
+     &quot;from_user_id&quot;: &quot;user-123&quot;,
+     &quot;id&quot;: &quot;e8bc7b7e-3466-48a5-9dfc-129863690c27&quot;,
+     &quot;project_id&quot;: &quot;proj-test-123&quot;,
+     &quot;reason&quot;: &quot;Task overdue&quot;,
+     &quot;resolved_at&quot;: null,
+     &quot;source_id&quot;: &quot;task-123&quot;,
+     &quot;source_type&quot;: &quot;TASK&quot;,
+     &quot;status&quot;: &quot;PENDING&quot;,
+     &quot;to_first&quot;: null,
+     &quot;to_last&quot;: null,
+     &quot;to_role&quot;: &quot;ADMIN&quot;,
+     &quot;to_user_id&quot;: &quot;user-admin-123&quot;,
+     &quot;trigger_type&quot;: &quot;OVERDUE&quot;,
+   },
+   {
+     &quot;acknowledged_at&quot;: null,
+     &quot;created_at&quot;: &quot;2025-12-21 11:37:17&quot;,
+     &quot;days_overdue&quot;: 0,
+     &quot;from_first&quot;: null,
+     &quot;from_last&quot;: null,
+     &quot;from_user_id&quot;: &quot;user-123&quot;,
+     &quot;id&quot;: &quot;f46c604c-2880-4363-b080-8aca834315ad&quot;,
      &quot;project_id&quot;: &quot;proj-test-123&quot;,
+     &quot;reason&quot;: &quot;Test&quot;,
+     &quot;resolved_at&quot;: null,
+     &quot;source_id&quot;: &quot;decision-123&quot;,
      &quot;source_type&quot;: &quot;DECISION&quot;,
-     &quot;to_first&quot;: &quot;Jane&quot;,
-     &quot;to_last&quot;: &quot;Smith&quot;,
+     &quot;status&quot;: &quot;PENDING&quot;,
+     &quot;to_first&quot;: null,
+     &quot;to_last&quot;: null,
+     &quot;to_role&quot;: &quot;ADMIN&quot;,
+     &quot;to_user_id&quot;: &quot;user-admin-123&quot;,
+     &quot;trigger_type&quot;: &quot;OVERDUE&quot;,
    },
  ]

  tests/unit/backend/escalationService.test.js:165:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; getEscalations() &gt; should filter by status when provided" time="0.001421917">
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; getEscalations() &gt; should include user names from joins" time="0.002021125">
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; acknowledgeEscalation() &gt; should acknowledge an escalation" time="0.002317167">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/escalationService.test.js:212:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; acknowledgeEscalation() &gt; should return false when escalation not found or user mismatch" time="0.000831625">
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; resolveEscalation() &gt; should resolve an escalation" time="0.0028925">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/escalationService.test.js:242:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; resolveEscalation() &gt; should return false when escalation not found" time="0.000674125">
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; runAutoEscalation() &gt; should escalate overdue decisions to sponsor" time="0.000854792">
            <failure message="expected undefined to be &apos;proj-test-123&apos; // Object.is equality" type="AssertionError">
AssertionError: expected undefined to be &apos;proj-test-123&apos; // Object.is equality

- Expected: 
&quot;proj-test-123&quot;

+ Received: 
undefined

  tests/unit/backend/escalationService.test.js:297:38
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; runAutoEscalation() &gt; should not escalate if project not found" time="0.000372">
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; runAutoEscalation() &gt; should not create duplicate escalations" time="0.0005405">
            <failure message="expected undefined to be +0 // Object.is equality" type="AssertionError">
AssertionError: expected undefined to be +0 // Object.is equality

- Expected: 
0

+ Received: 
undefined

  tests/unit/backend/escalationService.test.js:346:47
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; runAutoEscalation() &gt; should escalate stalled initiatives to PM" time="0.000615875">
            <failure message="actual value must be number or bigint, received &quot;undefined&quot;" type="TypeError">
TypeError: actual value must be number or bigint, received &quot;undefined&quot;
  tests/unit/backend/escalationService.test.js:399:47
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; Multi-Tenant Isolation &gt; should filter escalations by project_id" time="0.000479333">
        </testcase>
        <testcase classname="tests/unit/backend/escalationService.test.js" name="EscalationService &gt; Multi-Tenant Isolation &gt; should get organization_id from project for notifications" time="0.001666875">
            <failure message="expected &quot;vi.fn()&quot; to be called with arguments: [ ObjectContaining{} ]

Number of calls: 0
" type="AssertionError">
AssertionError: expected &quot;vi.fn()&quot; to be called with arguments: [ ObjectContaining{} ]

Number of calls: 0

  tests/unit/backend/escalationService.test.js:439:52
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/evidenceLedgerService.test.js" timestamp="2025-12-21T11:37:25.822Z" hostname="MacBook-Pro-Piotr.local" tests="30" failures="4" errors="0" skipped="0" time="0.193021208">
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; redactPayload() &gt; should redact PII fields from payload" time="0.001748459">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; redactPayload() &gt; should redact nested PII fields" time="0.000204875">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; redactPayload() &gt; should redact PII in arrays" time="0.000133541">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; redactPayload() &gt; should support additional fields to redact" time="0.000105291">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; redactPayload() &gt; should handle null/undefined payloads" time="0.000107917">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; createEvidenceObject() &gt; should create an evidence object with redacted payload" time="0.000350167">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; createEvidenceObject() &gt; should reject invalid evidence type" time="0.000615834">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; createEvidenceObject() &gt; should reject missing required fields" time="0.0001295">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; linkEvidence() &gt; should link evidence to an entity" time="0.000231458">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; linkEvidence() &gt; should normalize weight to 0-1 range" time="0.000151583">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; linkEvidence() &gt; should reject invalid entity type" time="0.000161459">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; linkEvidence() &gt; should reject missing required fields" time="0.000120584">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; recordReasoning() &gt; should record reasoning entry" time="0.000413708">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; recordReasoning() &gt; should normalize confidence to 0-1 range" time="0.000074833">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; recordReasoning() &gt; should reject missing required fields" time="0.00009375">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; getExplanation() &gt; should get full explanation for an entity" time="0.011136833">
            <failure message="expected [] to have a length of 1 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

  tests/unit/backend/evidenceLedgerService.test.js:301:38
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; getExplanation() &gt; should handle empty explanation" time="0.005030916">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; getExplanation() &gt; should reject missing required fields" time="0.000232083">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; hasEvidence() &gt; should check if entity has evidence" time="0.000861167">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/evidenceLedgerService.test.js:346:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; hasEvidence() &gt; should return false when no evidence exists" time="0.001825375">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; createAndLinkEvidence() &gt; should create evidence and link it in one operation" time="0.000233708">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; getEvidencesByOrg() &gt; should get evidences for organization" time="0.00212925">
            <failure message="expected [] to have a length of 1 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

  tests/unit/backend/evidenceLedgerService.test.js:410:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; getEvidencesByOrg() &gt; should filter by type when provided" time="0.002264625">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; getEvidencesByOrg() &gt; should respect limit when provided" time="0.00095275">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; exportExplanation() &gt; should export explanation as JSON pack" time="0.003368291">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; exportExplanation() &gt; should export explanation as PDF pack" time="0.001016">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/evidenceLedgerService.test.js:487:68
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; Multi-Tenant Isolation &gt; should scope evidences by organization_id" time="0.000373584">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; Multi-Tenant Isolation &gt; should scope explanation queries by org_id" time="0.00065075">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; Enums &gt; should export EVIDENCE_TYPES" time="0.000129875">
        </testcase>
        <testcase classname="tests/unit/backend/evidenceLedgerService.test.js" name="EvidenceLedgerService &gt; Enums &gt; should export ENTITY_TYPES" time="0.000090125">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/executionMonitorService.test.js" timestamp="2025-12-21T11:37:25.824Z" hostname="MacBook-Pro-Piotr.local" tests="18" failures="13" errors="0" skipped="0" time="0.21269175">
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; runDailyMonitor() &gt; should detect stalled tasks" time="0.006548208">
            <failure message="expected [] to have a length of 1 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

  tests/unit/backend/executionMonitorService.test.js:62:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; runDailyMonitor() &gt; should detect overdue tasks and generate notifications" time="0.001692125">
            <failure message="expected [] to have a length of 1 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

  tests/unit/backend/executionMonitorService.test.js:89:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; runDailyMonitor() &gt; should detect overdue decisions" time="0.002227375">
            <failure message="expected [] to have a length of 1 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

  tests/unit/backend/executionMonitorService.test.js:118:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; runDailyMonitor() &gt; should detect stalled initiatives" time="0.002164083">
            <failure message="expected [] to have a length of 1 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

  tests/unit/backend/executionMonitorService.test.js:145:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; runDailyMonitor() &gt; should detect silent blockers" time="0.002010917">
            <failure message="expected [] to have a length of 1 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

  tests/unit/backend/executionMonitorService.test.js:169:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; runDailyMonitor() &gt; should return healthy status when no issues detected" time="0.0020005">
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; runDailyMonitor() &gt; should include monitoredAt timestamp" time="0.001702584">
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; _detectStalledTasks() &gt; should detect tasks not updated in 7+ days" time="0.00195725">
            <failure message="expected [] to deeply equal [ { id: &apos;task-1&apos;, (2) } ]" type="AssertionError">
AssertionError: expected [] to deeply equal [ { id: &apos;task-1&apos;, (2) } ]

- Expected
+ Received

- [
-   {
-     &quot;id&quot;: &quot;task-1&quot;,
-     &quot;status&quot;: &quot;in_progress&quot;,
-     &quot;title&quot;: &quot;Stalled Task&quot;,
-   },
- ]
+ []

  tests/unit/backend/executionMonitorService.test.js:222:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; _detectOverdueTasks() &gt; should detect tasks with due_date in the past" time="0.000743333">
            <failure message="expected [] to deeply equal [ { id: &apos;task-1&apos;, (2) } ]" type="AssertionError">
AssertionError: expected [] to deeply equal [ { id: &apos;task-1&apos;, (2) } ]

- Expected
+ Received

- [
-   {
-     &quot;due_date&quot;: &quot;2024-01-01&quot;,
-     &quot;id&quot;: &quot;task-1&quot;,
-     &quot;title&quot;: &quot;Overdue Task&quot;,
-   },
- ]
+ []

  tests/unit/backend/executionMonitorService.test.js:245:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; _detectOverdueDecisions() &gt; should detect decisions pending for 7+ days" time="0.000751166">
            <failure message="expected [] to deeply equal [ { id: &apos;decision-1&apos;, (2) } ]" type="AssertionError">
AssertionError: expected [] to deeply equal [ { id: &apos;decision-1&apos;, (2) } ]

- Expected
+ Received

- [
-   {
-     &quot;id&quot;: &quot;decision-1&quot;,
-     &quot;status&quot;: &quot;PENDING&quot;,
-     &quot;title&quot;: &quot;Overdue Decision&quot;,
-   },
- ]
+ []

  tests/unit/backend/executionMonitorService.test.js:268:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; _detectStalledInitiatives() &gt; should detect initiatives not updated in 7+ days" time="0.000569375">
            <failure message="expected [] to deeply equal [ { id: &apos;init-1&apos;, (2) } ]" type="AssertionError">
AssertionError: expected [] to deeply equal [ { id: &apos;init-1&apos;, (2) } ]

- Expected
+ Received

- [
-   {
-     &quot;id&quot;: &quot;init-1&quot;,
-     &quot;name&quot;: &quot;Stalled Initiative&quot;,
-     &quot;status&quot;: &quot;IN_EXECUTION&quot;,
-   },
- ]
+ []

  tests/unit/backend/executionMonitorService.test.js:291:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; _detectSilentBlockers() &gt; should detect blocked items without reason" time="0.000487292">
            <failure message="expected [] to deeply equal [ { id: &apos;task-1&apos;, (2) } ]" type="AssertionError">
AssertionError: expected [] to deeply equal [ { id: &apos;task-1&apos;, (2) } ]

- Expected
+ Received

- [
-   {
-     &quot;id&quot;: &quot;task-1&quot;,
-     &quot;title&quot;: &quot;Blocked Task&quot;,
-     &quot;type&quot;: &quot;TASK&quot;,
-   },
- ]
+ []

  tests/unit/backend/executionMonitorService.test.js:315:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; generateExecutionSummary() &gt; should generate summary when no issues" time="0.001233083">
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; generateExecutionSummary() &gt; should generate summary with issues" time="0.001775917">
            <failure message="expected &apos; Execution is healthy. No issues det&apos; to contain &apos;&apos;" type="AssertionError">
AssertionError: expected &apos; Execution is healthy. No issues det&apos; to contain &apos;&apos;

Expected: &quot;&quot;
Received: &quot; Execution is healthy. No issues detected.&quot;

  tests/unit/backend/executionMonitorService.test.js:350:40
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; generateExecutionSummary() &gt; should include all issue types in summary" time="0.001342584">
            <failure message="expected &apos; Execution is healthy. No issues det&apos; to contain &apos;OVERDUE_TASKS&apos;" type="AssertionError">
AssertionError: expected &apos; Execution is healthy. No issues det&apos; to contain &apos;OVERDUE_TASKS&apos;

Expected: &quot;OVERDUE_TASKS&quot;
Received: &quot; Execution is healthy. No issues detected.&quot;

  tests/unit/backend/executionMonitorService.test.js:374:40
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; generateExecutionSummary() &gt; should include generatedAt timestamp" time="0.0050065">
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; Multi-Tenant Isolation &gt; should filter all queries by project_id" time="0.004024208">
        </testcase>
        <testcase classname="tests/unit/backend/executionMonitorService.test.js" name="ExecutionMonitorService &gt; Multi-Tenant Isolation &gt; should scope notifications to correct users" time="0.002862958">
            <failure message="Cannot read properties of undefined (reading &apos;userId&apos;)" type="TypeError">
TypeError: Cannot read properties of undefined (reading &apos;userId&apos;)
  tests/unit/backend/executionMonitorService.test.js:427:44
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/feedbackService.test.js" timestamp="2025-12-21T11:37:25.825Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.719728542">
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; saveFeedback &gt; saves feedback with all parameters" time="0.102605333">
        </testcase>
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; saveFeedback &gt; saves feedback without correction" time="0.102040625">
        </testcase>
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; getLearningExamples &gt; retrieves learning examples for context" time="0.113645709">
        </testcase>
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; getLearningExamples &gt; handles empty results" time="0.001203333">
        </testcase>
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; getLearningExamples &gt; handles database errors gracefully" time="0.000608417">
        </testcase>
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; getLearningExamples &gt; only returns examples with rating &gt;= 4" time="0.101751709">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/financialService.test.js" timestamp="2025-12-21T11:37:25.826Z" hostname="MacBook-Pro-Piotr.local" tests="9" failures="0" errors="0" skipped="0" time="0.173918042">
        <testcase classname="tests/unit/backend/financialService.test.js" name="FinancialService &gt; estimateCost &gt; should estimate cost for High complexity" time="0.00051575">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="FinancialService &gt; estimateCost &gt; should estimate cost for Medium complexity" time="0.000084875">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="FinancialService &gt; estimateCost &gt; should fallback to Low complexity" time="0.000070333">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="FinancialService &gt; estimateBenefit &gt; should estimate benefit for High priority" time="0.00007975">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="FinancialService &gt; estimateBenefit &gt; should estimate benefit for Medium priority" time="0.000059792">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="FinancialService &gt; estimateBenefit &gt; should fallback to Low priority" time="0.0000415">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="FinancialService &gt; estimateBenefit &gt; should return correct benefit range" time="0.000096208">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="FinancialService &gt; simulatePortfolio &gt; should calculate aggregated metrics" time="0.000154">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="FinancialService &gt; simulatePortfolio &gt; should handle empty portfolio" time="0.000052417">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/governanceService.test.js" timestamp="2025-12-21T11:37:25.826Z" hostname="MacBook-Pro-Piotr.local" tests="14" failures="3" errors="0" skipped="0" time="0.203171917">
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; createChangeRequest() &gt; should create a new Change Request with DRAFT status" time="0.006525708">
            <failure message="expected &apos;8c46faad-55d3-4295-8e65-f79af1e0ba0a&apos; to be &apos;cr-1&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;8c46faad-55d3-4295-8e65-f79af1e0ba0a&apos; to be &apos;cr-1&apos; // Object.is equality

Expected: &quot;cr-1&quot;
Received: &quot;8c46faad-55d3-4295-8e65-f79af1e0ba0a&quot;

  tests/unit/backend/governanceService.test.js:64:31
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; createChangeRequest() &gt; should default riskAssessment to LOW if not provided" time="0.000779209">
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; createChangeRequest() &gt; should handle JSON stringification of impactAnalysis" time="0.000554084">
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; createChangeRequest() &gt; should reject on database error" time="0.002206833">
            <failure message="promise resolved &quot;{ (7) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ (7) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;createdBy&quot;: &quot;user-admin-123&quot;,
+   &quot;description&quot;: &quot;Test&quot;,
+   &quot;id&quot;: &quot;f5b3dd6d-f6cf-4bfc-a3fe-2190cfe3183f&quot;,
+   &quot;projectId&quot;: &quot;proj-test-123&quot;,
+   &quot;status&quot;: &quot;DRAFT&quot;,
+   &quot;title&quot;: &quot;Test CR&quot;,
+   &quot;type&quot;: &quot;TECHNICAL&quot;,
  }

  tests/unit/backend/governanceService.test.js:124:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; decideChangeRequest() &gt; should approve a Change Request" time="0.000563708">
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; decideChangeRequest() &gt; should reject a Change Request" time="0.011988708">
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; decideChangeRequest() &gt; should set approved_by to null when rejecting" time="0.000530959">
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; decideChangeRequest() &gt; should set approved_by when approving" time="0.002573958">
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; decideChangeRequest() &gt; should handle database errors" time="0.0010815">
            <failure message="promise resolved &quot;{ id: &apos;cr-123&apos;, (2) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ id: &apos;cr-123&apos;, (2) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;id&quot;: &quot;cr-123&quot;,
+   &quot;status&quot;: &quot;APPROVED&quot;,
+   &quot;userId&quot;: &quot;user-admin-123&quot;,
  }

  tests/unit/backend/governanceService.test.js:207:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; decideChangeRequest() &gt; should set approved_at timestamp" time="0.009511792">
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; Multi-Tenant Isolation &gt; should associate CR with specific project" time="0.000851792">
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; Multi-Tenant Isolation &gt; should track creator for audit purposes" time="0.003950875">
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; Edge Cases &gt; should handle empty impactAnalysis" time="0.000265458">
        </testcase>
        <testcase classname="tests/unit/backend/governanceService.test.js" name="GovernanceService &gt; Edge Cases &gt; should handle optional reason in decideChangeRequest" time="0.00026225">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/helpService.test.js" timestamp="2025-12-21T11:37:25.827Z" hostname="MacBook-Pro-Piotr.local" tests="13" failures="0" errors="0" skipped="0" time="0.275064042">
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; EVENT_TYPES &gt; should define all required event types" time="0.013991333">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; EVENT_TYPES &gt; should have exactly 4 event types" time="0.000549583">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; TARGET_ROLES &gt; should define all valid target roles" time="0.000331375">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; TARGET_ROLES &gt; should have exactly 5 roles" time="0.000085583">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; TARGET_ORG_TYPES &gt; should define all valid org types" time="0.000140417">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; TARGET_ORG_TYPES &gt; should have exactly 4 org types" time="0.000064083">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; Input Validation &gt; should reject invalid event types in markEvent" time="0.000586792">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; Input Validation &gt; should reject createPlaybook without key" time="0.000149625">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; Input Validation &gt; should reject createPlaybook without title" time="0.000095208">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; Input Validation &gt; should reject createPlaybook with invalid target role" time="0.000096459">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; Input Validation &gt; should reject createPlaybook with invalid org type" time="0.000075959">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; Input Validation &gt; should reject createStep without required fields" time="0.000093875">
        </testcase>
        <testcase classname="tests/unit/backend/helpService.test.js" name="HelpService Constants and Validation &gt; Input Validation &gt; should reject createStep with invalid action type" time="0.000073167">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/ingestionService.test.js" timestamp="2025-12-21T11:37:25.827Z" hostname="MacBook-Pro-Piotr.local" tests="1" failures="0" errors="0" skipped="0" time="0.216322667">
        <testcase classname="tests/unit/backend/ingestionService.test.js" name="Ingestion Service &gt; should handle ingestion (DB interaction) [SKIPPED]" time="0.0004655">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/initiativeService.multiTenant.test.js" timestamp="2025-12-21T11:37:25.828Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.173152333">
        <testcase classname="tests/unit/backend/initiativeService.multiTenant.test.js" name="InitiativeService - Multi-Tenant Isolation &gt; recalculateProgress with organizationId &gt; should filter tasks by organization_id AND initiative_id" time="0.000810083">
        </testcase>
        <testcase classname="tests/unit/backend/initiativeService.multiTenant.test.js" name="InitiativeService - Multi-Tenant Isolation &gt; recalculateProgress with organizationId &gt; should update initiative with org-scoped WHERE clause" time="0.000482917">
        </testcase>
        <testcase classname="tests/unit/backend/initiativeService.multiTenant.test.js" name="InitiativeService - Multi-Tenant Isolation &gt; recalculateProgress with organizationId &gt; should NOT mix tasks from different orgs" time="0.0001635">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/initiativeService.test.js" timestamp="2025-12-21T11:37:25.828Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.188793708">
        <testcase classname="tests/unit/backend/initiativeService.test.js" name="InitiativeService &gt; recalculateProgress &gt; should return 0 when no initiativeId provided" time="0.001475541">
            <system-err>
[InitiativeService] DEPRECATION WARNING: recalculateProgress called without organizationId

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/initiativeService.test.js" name="InitiativeService &gt; recalculateProgress &gt; should handle database error during fetch" time="0.003148958">
            <system-err>
[InitiativeService] DEPRECATION WARNING: recalculateProgress called without organizationId
Error fetching tasks for recalculation: Error: DB Fetch Error
    at Object.&lt;anonymous&gt; (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/initiativeService.test.js:40:50)
    at Object.Mock [as all] (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/spy/dist/index.js:285:34)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/initiativeService.js:49:21
    at new Promise (&lt;anonymous&gt;)
    at Object.recalculateProgress (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/initiativeService.js:22:16)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/initiativeService.test.js:43:44
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/initiativeService.test.js" name="InitiativeService &gt; recalculateProgress &gt; should set progress to 0 if no tasks found" time="0.001088833">
            <system-err>
[InitiativeService] DEPRECATION WARNING: recalculateProgress called without organizationId

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/initiativeService.test.js" name="InitiativeService &gt; recalculateProgress &gt; should calculate weighted progress correctly" time="0.000271583">
            <system-err>
[InitiativeService] DEPRECATION WARNING: recalculateProgress called without organizationId

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/initiativeService.test.js" name="InitiativeService &gt; recalculateProgress &gt; should handle tasks with missing progress/priority" time="0.00011">
            <system-err>
[InitiativeService] DEPRECATION WARNING: recalculateProgress called without organizationId

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/initiativeService.test.js" name="InitiativeService &gt; recalculateProgress &gt; should handle database error during update" time="0.000334125">
            <system-err>
[InitiativeService] DEPRECATION WARNING: recalculateProgress called without organizationId
Error updating initiative progress: Error: Update failed
    at Object.&lt;anonymous&gt; (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/initiativeService.test.js:119:50)
    at Object.Mock [as run] (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/spy/dist/index.js:285:34)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/initiativeService.js:100:25
    at Object.&lt;anonymous&gt; (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/initiativeService.test.js:113:21)
    at Object.Mock [as all] (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/spy/dist/index.js:285:34)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/initiativeService.js:49:21
    at new Promise (&lt;anonymous&gt;)
    at Object.recalculateProgress (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/initiativeService.js:22:16)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/initiativeService.test.js:122:44
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:145:11

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/invitationService.test.js" timestamp="2025-12-21T11:37:25.828Z" hostname="MacBook-Pro-Piotr.local" tests="23" failures="15" errors="0" skipped="0" time="0.192499">
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; generateSecureToken() &gt; should generate 64-character hex token" time="0.003451167">
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; generateSecureToken() &gt; should generate unique tokens" time="0.000439875">
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; hashToken() &gt; should hash token using SHA256" time="0.000339209">
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; hashToken() &gt; should produce consistent hash for same token" time="0.000132916">
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; calculateExpiryDate() &gt; should calculate expiry date 7 days from now by default" time="0.0001505">
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; calculateExpiryDate() &gt; should calculate expiry date for custom days" time="0.000092959">
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; checkInvitePermission() &gt; should allow invitation when policy allows" time="0.00501025">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/invitationService.test.js:119:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; checkInvitePermission() &gt; should deny invitation when policy denies" time="0.00136375">
            <failure message="expected &apos;ORG_NOT_FOUND&apos; to be &apos;USER_LIMIT_REACHED&apos; // Object.is equality" type="AssertionError">
AssertionError: expected &apos;ORG_NOT_FOUND&apos; to be &apos;USER_LIMIT_REACHED&apos; // Object.is equality

Expected: &quot;USER_LIMIT_REACHED&quot;
Received: &quot;ORG_NOT_FOUND&quot;

  tests/unit/backend/invitationService.test.js:135:39
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; createOrganizationInvitation() &gt; should create organization invitation" time="0.00039475">
            <failure message="InvitationService.createOrganizationInvitation is not a function" type="TypeError">
TypeError: InvitationService.createOrganizationInvitation is not a function
  tests/unit/backend/invitationService.test.js:161:56
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; createOrganizationInvitation() &gt; should reject invalid email format" time="0.000240916">
            <failure message="InvitationService.createOrganizationInvitation is not a function" type="TypeError">
TypeError: InvitationService.createOrganizationInvitation is not a function
  tests/unit/backend/invitationService.test.js:181:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; createOrganizationInvitation() &gt; should reject when organization not found" time="0.000190292">
            <failure message="InvitationService.createOrganizationInvitation is not a function" type="TypeError">
TypeError: InvitationService.createOrganizationInvitation is not a function
  tests/unit/backend/invitationService.test.js:198:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; createOrganizationInvitation() &gt; should reject when permission denied" time="0.000157583">
            <failure message="InvitationService.createOrganizationInvitation is not a function" type="TypeError">
TypeError: InvitationService.createOrganizationInvitation is not a function
  tests/unit/backend/invitationService.test.js:220:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; createProjectInvitation() &gt; should create project invitation" time="0.000471791">
            <failure message="Project not found in this organization" type="Error">
Error: Project not found in this organization
  Object.createProjectInvitation server/services/invitationService.js:374:19
  tests/unit/backend/invitationService.test.js:252:32
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; createProjectInvitation() &gt; should reject when project not found" time="0.000982875">
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; createProjectInvitation() &gt; should reject when project belongs to different organization" time="0.00037325">
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; validateToken() &gt; should validate correct token" time="0.000379083">
            <failure message="InvitationService.validateToken is not a function" type="TypeError">
TypeError: InvitationService.validateToken is not a function
  tests/unit/backend/invitationService.test.js:312:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; validateToken() &gt; should reject invalid token" time="0.000256792">
            <failure message="InvitationService.validateToken is not a function" type="TypeError">
TypeError: InvitationService.validateToken is not a function
  tests/unit/backend/invitationService.test.js:330:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; validateToken() &gt; should reject expired invitation" time="0.000180875">
            <failure message="InvitationService.validateToken is not a function" type="TypeError">
TypeError: InvitationService.validateToken is not a function
  tests/unit/backend/invitationService.test.js:347:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; validateToken() &gt; should reject already accepted invitation" time="0.00014575">
            <failure message="InvitationService.validateToken is not a function" type="TypeError">
TypeError: InvitationService.validateToken is not a function
  tests/unit/backend/invitationService.test.js:364:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; acceptInvitation() &gt; should accept valid invitation" time="0.000360625">
            <failure message="The &quot;data&quot; argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received undefined" type="TypeError">
TypeError: The &quot;data&quot; argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received undefined
  Object.hashToken server/services/invitationService.js:90:44
  Object.getByToken server/services/invitationService.js:444:45
  Object.acceptInvitation server/services/invitationService.js:477:52
  tests/unit/backend/invitationService.test.js:402:52


Serialized Error: { code: &apos;ERR_INVALID_ARG_TYPE&apos; }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; acceptInvitation() &gt; should reject invitation with mismatched email" time="0.000920208">
            <failure message="expected [Function] to throw error including &apos;Email mismatch&apos; but got &apos;The &quot;data&quot; argument must be of type s&apos;" type="AssertionError">
AssertionError: expected [Function] to throw error including &apos;Email mismatch&apos; but got &apos;The &quot;data&quot; argument must be of type s&apos;

Expected: &quot;Email mismatch&quot;
Received: &quot;The &quot;data&quot; argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received undefined&quot;

  tests/unit/backend/invitationService.test.js:425:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; revokeInvitation() &gt; should revoke pending invitation" time="0.00026125">
            <failure message="Invitation not found" type="Error">
Error: Invitation not found
  Object.revokeInvitation server/services/invitationService.js:766:19
  tests/unit/backend/invitationService.test.js:450:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/invitationService.test.js" name="InvitationService &gt; Multi-Tenant Isolation &gt; should only return invitations for specified organization" time="0.000146166">
            <failure message="InvitationService.getOrganizationInvitations is not a function" type="TypeError">
TypeError: InvitationService.getOrganizationInvitations is not a function
  tests/unit/backend/invitationService.test.js:469:37
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/knowledgeService.test.js" timestamp="2025-12-21T11:37:25.831Z" hostname="MacBook-Pro-Piotr.local" tests="11" failures="1" errors="0" skipped="0" time="0.235403333">
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Candidate Management &gt; should add a candidate idea without throwing" time="0.001363416">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Candidate Management &gt; should get candidates without throwing" time="0.000706875">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Strategies &gt; should add a global strategy without throwing" time="0.0019125">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Strategies &gt; should get active strategies without throwing" time="0.000653333">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Client Context &gt; should set and get client context" time="0.003596125">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Client Context &gt; should update existing client context" time="0.0012885">
            <failure message="SQLITE_ERROR: no such column: updated_at" type="Error">
Error: SQLITE_ERROR: no such column: updated_at

Serialized Error: { errno: 1, code: &apos;SQLITE_ERROR&apos; }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Candidate Status &gt; should update candidate status" time="0.001701917">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Process Document (RAG) &gt; should process document chunks" time="0.035075666">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Access Control &gt; should restrict user access to project docs" time="0.00950125">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Strategies Toggle &gt; should toggle strategy active status" time="0.004050125">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Document Lifecycle &gt; should soft delete document" time="0.00418225">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/legalEventLogger.test.js" timestamp="2025-12-21T11:37:25.831Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.113606791">
        <testcase classname="tests/unit/backend/legalEventLogger.test.js" name="LegalEventLogger &gt; log &gt; should append log entry" time="0.00154675">
            <system-err>
[LegalEventLogger] Unknown event type: test_event

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/legalEventLogger.test.js" name="LegalEventLogger &gt; logAccept &gt; should log user acceptance" time="0.0003855">
        </testcase>
        <testcase classname="tests/unit/backend/legalEventLogger.test.js" name="LegalEventLogger &gt; getEvents &gt; should fetch events with filters" time="0.000534875">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/legalService.test.js" timestamp="2025-12-21T11:37:25.831Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="6" errors="0" skipped="0" time="0.184611125">
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; getActiveDocuments() &gt; should return active documents" time="0.002821541">
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; getActiveDocuments() &gt; should filter by effective date" time="0.000314459">
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; getActiveDocuments() &gt; should filter by scope when user context provided" time="0.000189">
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; getActiveDocument() &gt; should return active document by type" time="0.0001625">
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; getActiveDocument() &gt; should return null when document not found" time="0.000111667">
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; getUserAcceptances() &gt; should return user acceptances" time="0.000424167">
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; getUserAcceptances() &gt; should filter by organization when provided" time="0.002481958">
            <failure message="expected [ &apos;user-123&apos; ] to include &apos;org-test-123&apos;" type="AssertionError">
AssertionError: expected [ &apos;user-123&apos; ] to include &apos;org-test-123&apos;
  Object.&lt;anonymous&gt; tests/unit/backend/legalService.test.js:194:32
  server/services/legalService.js:108:21
  Object.getUserAcceptances server/services/legalService.js:100:16
  tests/unit/backend/legalService.test.js:198:32
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; acceptDocument() &gt; should record user acceptance" time="0.000374125">
            <failure message="LegalService.acceptDocument is not a function" type="TypeError">
TypeError: LegalService.acceptDocument is not a function
  tests/unit/backend/legalService.test.js:225:47
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; acceptDocument() &gt; should reject when document not found" time="0.000229125">
            <failure message="LegalService.acceptDocument is not a function" type="TypeError">
TypeError: LegalService.acceptDocument is not a function
  tests/unit/backend/legalService.test.js:240:30
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; isDocumentApplicable() &gt; should return true for global scope documents" time="0.000137958">
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; isDocumentApplicable() &gt; should return true for matching region scope" time="0.00008575">
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; isDocumentApplicable() &gt; should return false for non-matching region scope" time="0.000081917">
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; isDocumentApplicable() &gt; should return true for matching license tier" time="0.000066208">
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; checkAcceptanceRequired() &gt; should require acceptance for TOS" time="0.00015225">
            <failure message="LegalService.checkAcceptanceRequired is not a function" type="TypeError">
TypeError: LegalService.checkAcceptanceRequired is not a function
  tests/unit/backend/legalService.test.js:301:47
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; checkAcceptanceRequired() &gt; should not require acceptance when already accepted" time="0.000140583">
            <failure message="LegalService.checkAcceptanceRequired is not a function" type="TypeError">
TypeError: LegalService.checkAcceptanceRequired is not a function
  tests/unit/backend/legalService.test.js:327:47
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/legalService.test.js" name="LegalService &gt; Multi-Tenant Isolation &gt; should only return acceptances for specified user and organization" time="0.000332292">
            <failure message="expected [ &apos;user-123&apos; ] to include &apos;org-test-123&apos;" type="AssertionError">
AssertionError: expected [ &apos;user-123&apos; ] to include &apos;org-test-123&apos;
  Object.&lt;anonymous&gt; tests/unit/backend/legalService.test.js:342:32
  server/services/legalService.js:108:21
  Object.getUserAcceptances server/services/legalService.js:100:16
  tests/unit/backend/legalService.test.js:347:32
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/metricsAggregator.test.js" timestamp="2025-12-21T11:37:25.833Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.223400416">
        <testcase classname="tests/unit/backend/metricsAggregator.test.js" name="MetricsAggregator &gt; METRIC_KEYS &gt; should define all required metric keys" time="0.000595334">
        </testcase>
        <testcase classname="tests/unit/backend/metricsAggregator.test.js" name="MetricsAggregator &gt; WARNING_SEVERITY &gt; should define severity levels" time="0.000118333">
        </testcase>
        <testcase classname="tests/unit/backend/metricsAggregator.test.js" name="MetricsAggregator &gt; getFunnelMetric &gt; should calculate funnel between two events" time="0.006157">
            <system-out>
[MetricsCollector] Recorded event: demo_started (efd90fcd-6eaa-46a3-959e-2f4f2bf1c793)

[MetricsCollector] Recorded event: demo_started (bcc44e93-c94d-4235-8d3a-51bfbe67a2a1)

[MetricsCollector] Recorded event: trial_started (bcc315e9-ab83-453c-a59f-3b524b0ee5e3)

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/metricsAggregator.test.js" name="MetricsAggregator &gt; getOverview &gt; should return complete overview for dashboard" time="0.00269825">
        </testcase>
        <testcase classname="tests/unit/backend/metricsAggregator.test.js" name="MetricsAggregator &gt; buildDailySnapshots &gt; should build snapshots idempotently" time="0.007239375">
            <system-out>
[MetricsAggregator] Building daily snapshots for 2025-12-21

[MetricsAggregator] Created 6 snapshots for 2025-12-21

[MetricsAggregator] Building daily snapshots for 2025-12-21

[MetricsAggregator] Created 6 snapshots for 2025-12-21

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/metricsAggregator.test.js" name="MetricsAggregator &gt; getEarlyWarnings &gt; should return warnings (seed data needed for specific warnings)" time="0.00080525">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/metricsCollector.test.js" timestamp="2025-12-21T11:37:25.833Z" hostname="MacBook-Pro-Piotr.local" tests="4" failures="0" errors="0" skipped="0" time="0.264140292">
        <testcase classname="tests/unit/backend/metricsCollector.test.js" name="MetricsCollector &gt; recordEvent &gt; should record event successfully" time="0.001590541">
            <system-out>
[MetricsCollector] Recorded event: TEST_EVENT (uuid-1234)

            </system-out>
            <system-err>
[MetricsCollector] Unknown event type: TEST_EVENT

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/metricsCollector.test.js" name="MetricsCollector &gt; recordEvent &gt; should throw on database error" time="0.000720959">
            <system-err>
[MetricsCollector] Unknown event type: TEST_EVENT
[MetricsCollector] Failed to record event TEST_EVENT: Insert failed

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/metricsCollector.test.js" name="MetricsCollector &gt; getEvents &gt; should fetch events with filters" time="0.000387125">
        </testcase>
        <testcase classname="tests/unit/backend/metricsCollector.test.js" name="MetricsCollector &gt; getEventCount &gt; should return count" time="0.000101959">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/myWorkService.test.js" timestamp="2025-12-21T11:37:25.833Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="0" errors="0" skipped="0" time="0.186924084">
        <testcase classname="tests/unit/backend/myWorkService.test.js" name="MyWorkService &gt; getMyWork &gt; should aggregate work" time="0.002063583">
        </testcase>
        <testcase classname="tests/unit/backend/myWorkService.test.js" name="MyWorkService &gt; errors &gt; should propagate db error" time="0.000929041">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/organizationService.test.js" timestamp="2025-12-21T11:37:25.833Z" hostname="MacBook-Pro-Piotr.local" tests="15" failures="10" errors="0" skipped="0" time="0.2064115">
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; createOrganization() &gt; should create organization with owner" time="0.002738417">
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; createOrganization() &gt; should rollback on error" time="0.011282375">
            <failure message="promise resolved &quot;{ (3) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ (3) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;id&quot;: &quot;3ee1b741-3290-40f7-b3f1-a05c0385f2a6&quot;,
+   &quot;name&quot;: &quot;New Organization&quot;,
+   &quot;role&quot;: &quot;OWNER&quot;,
  }

  tests/unit/backend/organizationService.test.js:96:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; createOrganization() &gt; should include attribution data when provided" time="0.000537959">
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; getOrganization() &gt; should return organization details" time="0.001225542">
            <failure message="Organization not found" type="Error">
Error: Organization not found
  Statement.&lt;anonymous&gt; server/services/organizationService.js:90:45
  Statement.replacement server/node_modules/sqlite3/lib/trace.js:25:27
  Statement.replacement server/node_modules/sqlite3/lib/trace.js:25:27
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; getOrganization() &gt; should throw error when organization not found" time="0.001187208">
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; addMember() &gt; should add member to organization" time="0.001344542">
            <failure message="expected undefined to be true // Object.is equality" type="AssertionError">
AssertionError: expected undefined to be true // Object.is equality

- Expected: 
true

+ Received: 
undefined

  tests/unit/backend/organizationService.test.js:173:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; addMember() &gt; should handle duplicate member gracefully" time="0.001044292">
            <failure message="promise resolved &quot;{ (4) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ (4) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;id&quot;: &quot;94a3a1cd-0513-4c9f-a5cd-3952abaad2bb&quot;,
+   &quot;organizationId&quot;: &quot;org-test-123&quot;,
+   &quot;role&quot;: &quot;MEMBER&quot;,
+   &quot;userId&quot;: &quot;user-123&quot;,
  }

  tests/unit/backend/organizationService.test.js:197:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; removeMember() &gt; should remove member from organization" time="0.000272291">
            <failure message="OrganizationService.removeMember is not a function" type="TypeError">
TypeError: OrganizationService.removeMember is not a function
  tests/unit/backend/organizationService.test.js:210:54
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; getMembers() &gt; should return organization members" time="0.001335083">
            <failure message="expected [] to have a length of 2 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 2 but got +0

- Expected
+ Received

- 2
+ 0

  tests/unit/backend/organizationService.test.js:242:29
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; getMembers() &gt; should only return members for specified organization" time="0.00034">
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; updateMemberRole() &gt; should update member role" time="0.000255">
            <failure message="OrganizationService.updateMemberRole is not a function" type="TypeError">
TypeError: OrganizationService.updateMemberRole is not a function
  tests/unit/backend/organizationService.test.js:275:54
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; getMemberRole() &gt; should return member role" time="0.000130875">
            <failure message="OrganizationService.getMemberRole is not a function" type="TypeError">
TypeError: OrganizationService.getMemberRole is not a function
  tests/unit/backend/organizationService.test.js:297:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; getMemberRole() &gt; should return null when member not found" time="0.000127833">
            <failure message="OrganizationService.getMemberRole is not a function" type="TypeError">
TypeError: OrganizationService.getMemberRole is not a function
  tests/unit/backend/organizationService.test.js:310:52
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; Multi-Tenant Isolation &gt; should only access members for specified organization" time="0.000160208">
        </testcase>
        <testcase classname="tests/unit/backend/organizationService.test.js" name="OrganizationService &gt; Multi-Tenant Isolation &gt; should prevent cross-organization member access" time="0.000224667">
            <failure message="OrganizationService.removeMember is not a function" type="TypeError">
TypeError: OrganizationService.removeMember is not a function
  tests/unit/backend/organizationService.test.js:343:39
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/outcomeService.test.js" timestamp="2025-12-21T11:37:25.835Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="0" errors="0" skipped="0" time="0.165047625">
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _computeDelta &gt; should compute positive delta correctly" time="0.000524125">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _computeDelta &gt; should handle empty baseline" time="0.000082792">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _computeDelta &gt; should handle empty after" time="0.000068542">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _computeDelta &gt; should handle identical values" time="0.000074125">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _computeDelta &gt; should be deterministic" time="0.000299917">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should return true for positive delta with no criteria" time="0.000156333">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should return false for all-zero delta with no criteria" time="0.000057917">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should evaluate &quot;&gt;&quot; criterion correctly" time="0.0001565">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should evaluate &quot;&gt;=&quot; criterion correctly" time="0.00006">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should evaluate &quot;&lt;&quot; criterion correctly" time="0.000071416">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should evaluate &quot;&lt;=&quot; criterion correctly" time="0.000043042">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should evaluate &quot;==&quot; criterion correctly" time="0.0000435">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should evaluate &quot;!=&quot; criterion correctly" time="0.00004775">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should require all criteria to pass" time="0.00004775">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should handle negative values" time="0.000037">
        </testcase>
        <testcase classname="tests/unit/backend/outcomeService.test.js" name="OutcomeService &gt; _evaluateSuccess &gt; should handle decimal values" time="0.000036">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/permissionService.test.js" timestamp="2025-12-21T11:37:25.835Z" hostname="MacBook-Pro-Piotr.local" tests="22" failures="8" errors="0" skipped="0" time="0.165269708">
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; Legacy: can() - Role-based capability check &gt; should allow SUPERADMIN all capabilities" time="0.001615958">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; Legacy: can() - Role-based capability check &gt; should allow ADMIN to manage users" time="0.000178333">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; Legacy: can() - Role-based capability check &gt; should deny PROJECT_MANAGER from managing users" time="0.00010525">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; Legacy: can() - Role-based capability check &gt; should deny user without role" time="0.000095833">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; Legacy: can() - Role-based capability check &gt; should deny null user" time="0.000098959">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; hasPermission() - Database-backed PBAC &gt; should return false for missing userId" time="0.000102125">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; hasPermission() - Database-backed PBAC &gt; should return false for missing permissionKey" time="0.000071625">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; hasPermission() - Database-backed PBAC &gt; should allow SUPERADMIN bypass" time="0.000185917">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; hasPermission() - Database-backed PBAC &gt; should grant permission from explicit org-user override" time="0.005140625">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/permissionService.test.js:107:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; hasPermission() - Database-backed PBAC &gt; should deny permission from explicit org-user override" time="0.000643833">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; hasPermission() - Database-backed PBAC &gt; should fallback to role-based permission when no override" time="0.000790458">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/permissionService.test.js:165:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; hasPermission() - Database-backed PBAC &gt; should deny permission when role permission not found" time="0.000406958">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; hasPermission() - Database-backed PBAC &gt; should handle database errors gracefully" time="0.002795166">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; Multi-Tenant Isolation &gt; should only check permissions for specified organization" time="0.001944625">
            <failure message="expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0
" type="AssertionError">
AssertionError: expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0

  tests/unit/backend/permissionService.test.js:236:32
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; Multi-Tenant Isolation &gt; should not leak permissions between organizations" time="0.001425417">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/permissionService.test.js:272:29
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; getUserPermissions() &gt; should return role permissions and overrides" time="0.000832792">
            <failure message="expected [] to have a length of 2 but got +0" type="AssertionError">
AssertionError: expected [] to have a length of 2 but got +0

- Expected
+ Received

- 2
+ 0

  tests/unit/backend/permissionService.test.js:302:44
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; getUserPermissions() &gt; should handle empty permissions" time="0.000353583">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; grantPermission() &gt; should grant permission to user" time="0.001099583">
            <failure message="Permission not found: PLAYBOOK_PUBLISH" type="Error">
Error: Permission not found: PLAYBOOK_PUBLISH
  Object.grantPermission server/services/permissionService.js:218:19
  tests/unit/backend/permissionService.test.js:337:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; grantPermission() &gt; should handle database errors" time="0.002676">
            <failure message="expected [Function] to throw error including &apos;DB Error&apos; but got &apos;Permission not found: PLAYBOOK_PUBLISH&apos;" type="AssertionError">
AssertionError: expected [Function] to throw error including &apos;DB Error&apos; but got &apos;Permission not found: PLAYBOOK_PUBLISH&apos;

Expected: &quot;DB Error&quot;
Received: &quot;Permission not found: PLAYBOOK_PUBLISH&quot;

  tests/unit/backend/permissionService.test.js:355:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; revokePermission() &gt; should revoke permission from user" time="0.000310542">
            <failure message="Permission not found: PLAYBOOK_PUBLISH" type="Error">
Error: Permission not found: PLAYBOOK_PUBLISH
  Object.revokePermission server/services/permissionService.js:258:19
  tests/unit/backend/permissionService.test.js:371:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; getCapabilitiesForRole() &gt; should return capabilities for ADMIN role" time="0.000129167">
        </testcase>
        <testcase classname="tests/unit/backend/permissionService.test.js" name="PermissionService &gt; getCapabilitiesForRole() &gt; should return empty array for unknown role" time="0.000074917">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/pmoDomainRegistry.test.js" timestamp="2025-12-21T11:37:25.837Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="0" errors="0" skipped="0" time="0.187794875">
        <testcase classname="tests/unit/backend/pmoDomainRegistry.test.js" name="PMODomainRegistry &gt; getAllDomains &gt; should return domains" time="0.002294">
        </testcase>
        <testcase classname="tests/unit/backend/pmoDomainRegistry.test.js" name="PMODomainRegistry &gt; getDomain &gt; should return domain" time="0.001270125">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/pmoHealthService.test.js" timestamp="2025-12-21T11:37:25.837Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="0" errors="0" skipped="0" time="0.202230208">
        <testcase classname="tests/unit/backend/pmoHealthService.test.js" name="PMOHealthService &gt; getHealthSnapshot &gt; should return complete snapshot" time="0.018954417">
            <system-out>
[PMOHealthService] Snapshot generated in 1ms for project proj1

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/pmoHealthService.test.js" name="PMOHealthService &gt; getHealthSnapshot &gt; should handle DB errors" time="0.0024945">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/pmoStandardsMapping.test.js" timestamp="2025-12-21T11:37:25.837Z" hostname="MacBook-Pro-Piotr.local" tests="7" failures="0" errors="0" skipped="0" time="0.239384959">
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; getMapping &gt; should return mapping for known concept" time="0.016168875">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; getMapping &gt; should return null for unknown concept" time="0.00049725">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; getStandardTerm &gt; should return ISO 21500 term correctly" time="0.000393083">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; getStandardTerm &gt; should return PMBOK 7 term correctly" time="0.000407083">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; isNeutralTerm &gt; should identify neutral terms" time="0.000318958">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; isNeutralTerm &gt; should identify vendor-specific terms as non-neutral" time="0.000266375">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; getConceptsByDomain &gt; should return all concepts for a given domain" time="0.000259291">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/progressService.test.js" timestamp="2025-12-21T11:37:25.837Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="3" time="0">
        <testcase classname="tests/unit/backend/progressService.test.js" name="Progress Service &gt; calculateInitiativeProgress &gt; should calculate progress from tasks [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/progressService.test.js" name="Progress Service &gt; calculateProjectProgress &gt; should calculate weighted project progress [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/progressService.test.js" name="Progress Service &gt; calculatePortfolioMetrics &gt; should calculate health score based on blocked initiatives [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/promoCodeService.test.js" timestamp="2025-12-21T11:37:25.838Z" hostname="MacBook-Pro-Piotr.local" tests="18" failures="0" errors="0" skipped="13" time="0.166093667">
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; constants &gt; should export PROMO_TYPES" time="0.000742875">
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; constants &gt; should export DISCOUNT_TYPES" time="0.000121333">
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; validatePromoCode - skipped due to CJS/ESM mock interop &gt; should return invalid for empty code" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; validatePromoCode - skipped due to CJS/ESM mock interop &gt; should return invalid for null code" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; validatePromoCode - skipped due to CJS/ESM mock interop &gt; should return invalid when code not found" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; validatePromoCode - skipped due to CJS/ESM mock interop &gt; should return invalid for expired code" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; validatePromoCode - skipped due to CJS/ESM mock interop &gt; should return invalid for code not yet active" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; validatePromoCode - skipped due to CJS/ESM mock interop &gt; should return invalid when usage limit reached" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; validatePromoCode - skipped due to CJS/ESM mock interop &gt; should return valid for good code with discount" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; validatePromoCode - skipped due to CJS/ESM mock interop &gt; should return valid for partner code without discount" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; markPromoCodeUsed - skipped due to CJS/ESM mock interop &gt; should return error for already used org code" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; createPromoCode &gt; should throw error for missing required fields" time="0.000591">
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; createPromoCode &gt; should throw error for invalid promo type" time="0.000124583">
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; createPromoCode &gt; should throw error for invalid discount type" time="0.000102375">
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; createPromoCode &gt; should create promo code successfully" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; listPromoCodes - skipped due to CJS/ESM mock interop &gt; should return list of promo codes" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; deactivatePromoCode - skipped due to CJS/ESM mock interop &gt; should deactivate promo code" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/promoCodeService.test.js" name="PromoCodeService &gt; deactivatePromoCode - skipped due to CJS/ESM mock interop &gt; should return false if code not found" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/ragService.test.js" timestamp="2025-12-21T11:37:25.839Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.199304584">
        <testcase classname="tests/unit/backend/ragService.test.js" name="RagService - Integration &gt; generateEmbedding &gt; should return null if no provider configured in database" time="0.000872541">
        </testcase>
        <testcase classname="tests/unit/backend/ragService.test.js" name="RagService - Integration &gt; getContext &gt; should return context string without throwing" time="0.001481583">
        </testcase>
        <testcase classname="tests/unit/backend/ragService.test.js" name="RagService - Integration &gt; getContext &gt; should accept limit parameter" time="0.000428333">
        </testcase>
        <testcase classname="tests/unit/backend/ragService.test.js" name="RagService - Integration &gt; getContextKeyword &gt; should perform keyword search without throwing" time="0.00026775">
        </testcase>
        <testcase classname="tests/unit/backend/ragService.test.js" name="RagService - Integration &gt; getAxisDefinitions &gt; should retrieve axis definitions without throwing" time="0.00030875">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/regulatoryModeGuard.test.js" timestamp="2025-12-21T11:37:25.839Z" hostname="MacBook-Pro-Piotr.local" tests="22" failures="8" errors="0" skipped="0" time="0.187014458">
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isEnabled() &gt; should return false for null projectId" time="0.000959083">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isEnabled() &gt; should return true when regulatory mode is enabled" time="0.00305525">
            <failure message="expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0
" type="AssertionError">
AssertionError: expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0

  tests/unit/backend/regulatoryModeGuard.test.js:54:32
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isEnabled() &gt; should return false when regulatory mode is disabled" time="0.00178525">
            <failure message="expected true to be false // Object.is equality" type="AssertionError">
AssertionError: expected true to be false // Object.is equality

- Expected
+ Received

- false
+ true

  tests/unit/backend/regulatoryModeGuard.test.js:70:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isEnabled() &gt; should default to enabled (fail-safe) when column is null" time="0.000778167">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isEnabled() &gt; should default to enabled on database error (fail-safe)" time="0.000510833">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; setEnabled() &gt; should enable regulatory mode" time="0.000513625">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/regulatoryModeGuard.test.js:108:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; setEnabled() &gt; should disable regulatory mode" time="0.000502167">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/regulatoryModeGuard.test.js:125:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; setEnabled() &gt; should handle database errors" time="0.002586167">
            <failure message="promise resolved &quot;{ success: false }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ success: false }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;success&quot;: false,
  }

  tests/unit/backend/regulatoryModeGuard.test.js:142:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isActionAllowed() &gt; should allow EXPLAIN_CONTEXT action" time="0.000332584">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isActionAllowed() &gt; should allow ANALYZE_RISKS action" time="0.000236959">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isActionAllowed() &gt; should block CREATE_DRAFT_TASK action" time="0.000215458">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isActionAllowed() &gt; should block EXECUTE_ACTION action" time="0.000090792">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isActionAllowed() &gt; should block actions with mutation keywords" time="0.000086208">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; isActionAllowed() &gt; should allow null/undefined action (fail-safe)" time="0.000071833">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; enforceRegulatoryMode() &gt; should not block when projectId is null" time="0.000097834">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; enforceRegulatoryMode() &gt; should not block when regulatory mode is disabled" time="0.000939">
            <failure message="expected true to be false // Object.is equality" type="AssertionError">
AssertionError: expected true to be false // Object.is equality

- Expected
+ Received

- false
+ true

  tests/unit/backend/regulatoryModeGuard.test.js:198:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; enforceRegulatoryMode() &gt; should block mutation actions when regulatory mode is enabled" time="0.000855333">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; enforceRegulatoryMode() &gt; should allow EXPLAIN_CONTEXT even when regulatory mode is enabled" time="0.00036375">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; enforceRegulatoryMode() &gt; should log blocked attempts" time="0.007501584">
            <failure message="expected &quot;vi.fn()&quot; to be called with arguments: [ ObjectContaining{} ]

Number of calls: 0
" type="AssertionError">
AssertionError: expected &quot;vi.fn()&quot; to be called with arguments: [ ObjectContaining{} ]

Number of calls: 0

  tests/unit/backend/regulatoryModeGuard.test.js:241:58
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; getRegulatoryPrompt() &gt; should return regulatory mode prompt constraints" time="0.000193375">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; getStatus() &gt; should return status when enabled" time="0.000273416">
        </testcase>
        <testcase classname="tests/unit/backend/regulatoryModeGuard.test.js" name="RegulatoryModeGuard &gt; getStatus() &gt; should return status when disabled" time="0.000258417">
            <failure message="expected true to be false // Object.is equality" type="AssertionError">
AssertionError: expected true to be false // Object.is equality

- Expected
+ Received

- false
+ true

  tests/unit/backend/regulatoryModeGuard.test.js:291:36
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/roadmapService.test.js" timestamp="2025-12-21T11:37:25.840Z" hostname="MacBook-Pro-Piotr.local" tests="19" failures="0" errors="0" skipped="0" time="0.170400375">
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; getWaves() &gt; should retrieve all waves for a project" time="0.001755792">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; getWaves() &gt; should return empty array when no waves exist" time="0.000197708">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; getWaves() &gt; should handle database errors" time="0.000581583">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; createWave() &gt; should create a new wave" time="0.000228708">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; createWave() &gt; should default sortOrder to 0 if not provided" time="0.000112959">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; createWave() &gt; should handle database errors" time="0.000137208">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; assignToWave() &gt; should assign initiative to wave" time="0.000180708">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; assignToWave() &gt; should handle database errors" time="0.00014225">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; baselineRoadmap() &gt; should baseline all waves and increment initiative baseline version" time="0.000271042">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; baselineRoadmap() &gt; should handle database errors on wave update" time="0.000152792">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; getRoadmapSummary() &gt; should return roadmap summary with waves and initiatives" time="0.000194084">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; getRoadmapSummary() &gt; should handle empty roadmap" time="0.0000695">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; updateInitiativeSchedule() &gt; should update schedule directly when not baselined" time="0.000182">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; updateInitiativeSchedule() &gt; should create Change Request when baselined and governance requires CR" time="0.000142042">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; updateInitiativeSchedule() &gt; should allow direct update when baselined but governance does not require CR" time="0.000085375">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; updateInitiativeSchedule() &gt; should handle waveId update" time="0.000082084">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; updateInitiativeSchedule() &gt; should return success message when no changes to apply" time="0.000071625">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; Multi-Tenant Isolation &gt; should filter waves by project_id" time="0.000061458">
        </testcase>
        <testcase classname="tests/unit/backend/roadmapService.test.js" name="RoadmapService &gt; Multi-Tenant Isolation &gt; should ensure initiatives belong to correct project in summary" time="0.000071834">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/roiService.test.js" timestamp="2025-12-21T11:37:25.841Z" hostname="MacBook-Pro-Piotr.local" tests="4" failures="4" errors="0" skipped="0" time="0.131193542">
        <testcase classname="tests/unit/backend/roiService.test.js" name="ROIService &gt; getDefaultModel &gt; should return existing model if found" time="0.004140208">
            <failure message="expected 75 to be 100 // Object.is equality" type="AssertionError">
AssertionError: expected 75 to be 100 // Object.is equality

- Expected
+ Received

- 100
+ 75

  tests/unit/backend/roiService.test.js:56:51
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/roiService.test.js" name="ROIService &gt; getDefaultModel &gt; should create default model if missing" time="0.002150333">
            <failure message="expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0
" type="AssertionError">
AssertionError: expected &quot;vi.fn()&quot; to be called with arguments: [ StringContaining{}, (2) ]

Number of calls: 0

  tests/unit/backend/roiService.test.js:70:32
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/roiService.test.js" name="ROIService &gt; calculateROI &gt; should calculate ROI based on measurements" time="0.002613625">
            <failure message="expected 75 to be 100 // Object.is equality" type="AssertionError">
AssertionError: expected 75 to be 100 // Object.is equality

- Expected
+ Received

- 100
+ 75

  tests/unit/backend/roiService.test.js:117:40
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/roiService.test.js" name="ROIService &gt; estimateHoursSaved &gt; should aggregate time saved metrics" time="0.001133542">
            <failure message="expected +0 to be 2 // Object.is equality" type="AssertionError">
AssertionError: expected +0 to be 2 // Object.is equality

- Expected
+ Received

- 2
+ 0

  tests/unit/backend/roiService.test.js:156:40
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/scenarioService.test.js" timestamp="2025-12-21T11:37:25.841Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="2" time="0.219115875">
        <testcase classname="tests/unit/backend/scenarioService.test.js" name="Scenario Service &gt; compareScenarios &gt; should compare delays correctly" time="0.007463041">
        </testcase>
        <testcase classname="tests/unit/backend/scenarioService.test.js" name="Scenario Service &gt; analyzeImpact &gt; should detect dependency breaks [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/scenarioService.test.js" name="Scenario Service &gt; createScenario &gt; should persist scenario [BLOCKED: REAL DB HIT]" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/scmsGovernance.test.js" timestamp="2025-12-21T11:37:25.842Z" hostname="MacBook-Pro-Piotr.local" tests="17" failures="0" errors="0" skipped="0" time="0.242814834">
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should allow DRAFT to PLANNED transition" time="0.001834708">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should allow PLANNED to APPROVED transition" time="0.000140416">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should allow APPROVED to IN_EXECUTION transition" time="0.000088583">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should allow IN_EXECUTION to BLOCKED transition" time="0.000075666">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should allow IN_EXECUTION to COMPLETED transition" time="0.000065333">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should disallow COMPLETED to DRAFT transition" time="0.000056416">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should disallow invalid status transition" time="0.000052417">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Task Status Transitions &gt; should allow TODO to IN_PROGRESS transition" time="0.000055458">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Task Status Transitions &gt; should allow IN_PROGRESS to DONE transition" time="0.000052916">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Task Status Transitions &gt; should allow IN_PROGRESS to BLOCKED transition" time="0.00006">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Task Status Transitions &gt; should allow BLOCKED to IN_PROGRESS transition" time="0.000042458">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Task Status Transitions &gt; should disallow direct DONE to TODO transition" time="0.000032709">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Blocked Status Validation &gt; should require blocked reason for BLOCKED initiative status" time="0.000109542">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Blocked Status Validation &gt; should accept blocked reason for BLOCKED status" time="0.000042">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Status Constants &gt; should export INITIATIVE_STATUSES" time="0.000049">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Status Constants &gt; should export TASK_STATUSES" time="0.000037083">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Status Constants &gt; should export DECISION_STATUSES" time="0.000037333">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/scmsLifecycle.test.js" timestamp="2025-12-21T11:37:25.843Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="0" errors="0" skipped="0" time="0.175855542">
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Types &gt; should define READINESS_GATE" time="0.00294775">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Types &gt; should define DESIGN_GATE" time="0.0003825">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Types &gt; should define PLANNING_GATE" time="0.000143667">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Types &gt; should define EXECUTION_GATE" time="0.000080125">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Types &gt; should define CLOSURE_GATE" time="0.000075">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Service Structure &gt; should export getGateType function" time="0.000058333">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Service Structure &gt; should export evaluateGate function" time="0.000050958">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Service Structure &gt; should export passGate function" time="0.0000415">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Mapping &gt; should map Context to Assessment with READINESS_GATE" time="0.000082667">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Mapping &gt; should map Roadmap to Execution with EXECUTION_GATE" time="0.000066958">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Mapping &gt; should map Assessment to Initiatives with DESIGN_GATE" time="0.000048041">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Mapping &gt; should map Initiatives to Roadmap with PLANNING_GATE" time="0.000034625">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Mapping &gt; should map Execution to Stabilization with CLOSURE_GATE" time="0.000032875">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="Phase Constants &gt; should have 6 phases in SCMS lifecycle" time="0.000335542">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="Phase Constants &gt; should have Context as first phase" time="0.000038">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="Phase Constants &gt; should have Stabilization as last phase" time="0.000027291">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/scmsServices.test.js" timestamp="2025-12-21T11:37:25.844Z" hostname="MacBook-Pro-Piotr.local" tests="39" failures="0" errors="0" skipped="0" time="0.266617375">
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; NOTIFICATION_TYPES &gt; should have notification types defined" time="0.007775167">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; NOTIFICATION_TYPES &gt; should include TASK_ASSIGNED type" time="0.000179125">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; NOTIFICATION_TYPES &gt; should include DECISION_REQUIRED type" time="0.000085167">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; NOTIFICATION_TYPES &gt; should include AI_RISK_DETECTED type" time="0.000064959">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; SEVERITY &gt; should define INFO severity" time="0.000063333">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; SEVERITY &gt; should define WARNING severity" time="0.000051416">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; SEVERITY &gt; should define CRITICAL severity" time="0.000041583">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="MyWorkService &gt; Service Structure &gt; should export getMyWork function" time="0.002962083">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="MyWorkService &gt; Service Structure &gt; should export _getMyTasks helper function" time="0.000090625">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="MyWorkService &gt; Service Structure &gt; should export _getMyAlerts helper function" time="0.000081375">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="ExecutionMonitorService &gt; Service Structure &gt; should export runDailyMonitor function" time="0.011370416">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="ExecutionMonitorService &gt; Service Structure &gt; should export generateExecutionSummary function" time="0.000071584">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EscalationService &gt; Service Structure &gt; should export createEscalation function" time="0.004310583">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EscalationService &gt; Service Structure &gt; should export getEscalations function" time="0.000065959">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EscalationService &gt; Service Structure &gt; should export acknowledgeEscalation function" time="0.000041">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EscalationService &gt; Service Structure &gt; should export resolveEscalation function" time="0.000036959">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EscalationService &gt; Service Structure &gt; should export runAutoEscalation function" time="0.000271125">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; STABILIZATION_STATUSES &gt; should define STABILIZED status" time="0.00455175">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; STABILIZATION_STATUSES &gt; should define PARTIALLY_STABILIZED status" time="0.000117709">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; STABILIZATION_STATUSES &gt; should define UNSTABLE status" time="0.0000725">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; STABILIZATION_STATUSES &gt; should define NOT_APPLICABLE status" time="0.000042375">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; Service Structure &gt; should export checkEntryCriteria function" time="0.000042875">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; Service Structure &gt; should export checkExitCriteria function" time="0.0000325">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; Service Structure &gt; should export closeProject function" time="0.000033834">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should have 5 value types" time="0.003399125">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should define COST_REDUCTION type" time="0.00004775">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should define REVENUE_INCREASE type" time="0.000030417">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should define RISK_REDUCTION type" time="0.000027375">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should define EFFICIENCY type" time="0.00002875">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should define STRATEGIC_OPTION type" time="0.000027166">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; Service Structure &gt; should export createValueHypothesis function" time="0.000027292">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; Service Structure &gt; should export getValueSummary function" time="0.000034042">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; Service Structure &gt; should export detectMissingValueHypotheses function" time="0.0000265">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="ReportingService &gt; Service Structure &gt; should export generateExecutiveOverview function" time="0.009004958">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="ReportingService &gt; Service Structure &gt; should export generateProjectHealthReport function" time="0.000077208">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="ReportingService &gt; Service Structure &gt; should export generateGovernanceReport function" time="0.000042042">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NarrativeService &gt; Service Structure &gt; should export generateWeeklySummary function" time="0.003895167">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NarrativeService &gt; Service Structure &gt; should export generateExecutiveMemo function" time="0.000066042">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NarrativeService &gt; Service Structure &gt; should export generateProgressNarrative function" time="0.000041084">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/settlementService.test.js" timestamp="2025-12-21T11:37:25.845Z" hostname="MacBook-Pro-Piotr.local" tests="19" failures="11" errors="0" skipped="0" time="0.192410208">
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; createPeriod() &gt; should create a new settlement period" time="0.0030045">
            <system-out>
[SettlementService] Created period: 2024-01-01T00:00:00Z to 2024-01-31T23:59:59Z

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; createPeriod() &gt; should reject missing periodStart" time="0.000764958">
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; createPeriod() &gt; should reject missing periodEnd" time="0.000153542">
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; createPeriod() &gt; should reject invalid date range" time="0.000119417">
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; createPeriod() &gt; should reject overlapping periods" time="0.00037225">
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; createPeriod() &gt; should reject when open period exists" time="0.004311542">
            <failure message="expected { errorCode: &apos;PERIOD_OVERLAP&apos;, (1) } to match object { errorCode: &apos;OPEN_PERIOD_EXISTS&apos; }
(1 matching property omitted from actual)" type="AssertionError">
AssertionError: expected { errorCode: &apos;PERIOD_OVERLAP&apos;, (1) } to match object { errorCode: &apos;OPEN_PERIOD_EXISTS&apos; }
(1 matching property omitted from actual)

- Expected
+ Received

  {
-   &quot;errorCode&quot;: &quot;OPEN_PERIOD_EXISTS&quot;,
+   &quot;errorCode&quot;: &quot;PERIOD_OVERLAP&quot;,
  }

  tests/unit/backend/settlementService.test.js:142:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; getPeriod() &gt; should return period by ID" time="0.001892125">
            <failure message="Cannot read properties of null (reading &apos;id&apos;)" type="TypeError">
TypeError: Cannot read properties of null (reading &apos;id&apos;)
  tests/unit/backend/settlementService.test.js:165:27
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; getPeriod() &gt; should return null for non-existent period" time="0.000470458">
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; getOpenPeriod() &gt; should return open period" time="0.00141175">
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; getOpenPeriod() &gt; should return null when no open period" time="0.001841041">
            <failure message="expected { (8) } to be null" type="AssertionError">
AssertionError: expected { (8) } to be null

- Expected: 
null

+ Received: 
{
  &quot;createdAt&quot;: &quot;2025-12-21 11:37:17&quot;,
  &quot;id&quot;: &quot;b7ab13f6-6efb-484d-ab06-c8d51c3876b4&quot;,
  &quot;partnerCount&quot;: 0,
  &quot;periodEnd&quot;: &quot;2024-01-31T23:59:59Z&quot;,
  &quot;periodStart&quot;: &quot;2024-01-01T00:00:00Z&quot;,
  &quot;status&quot;: &quot;OPEN&quot;,
  &quot;totalRevenue&quot;: 0,
  &quot;totalSettlements&quot;: 0,
}

  tests/unit/backend/settlementService.test.js:202:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; calculateSettlements() &gt; should calculate settlements for open period" time="0.006563708">
            <failure message="Settlement period not found">
Unknown Error: Settlement period not found

Serialized Error: { errorCode: &apos;NOT_FOUND&apos; }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; calculateSettlements() &gt; should reject calculation for locked period" time="0.002015583">
            <failure message="expected { errorCode: &apos;NOT_FOUND&apos;, (1) } to match object { errorCode: &apos;PERIOD_LOCKED&apos; }
(1 matching property omitted from actual)" type="AssertionError">
AssertionError: expected { errorCode: &apos;NOT_FOUND&apos;, (1) } to match object { errorCode: &apos;PERIOD_LOCKED&apos; }
(1 matching property omitted from actual)

- Expected
+ Received

  {
-   &quot;errorCode&quot;: &quot;PERIOD_LOCKED&quot;,
+   &quot;errorCode&quot;: &quot;NOT_FOUND&quot;,
  }

  tests/unit/backend/settlementService.test.js:250:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; calculateSettlements() &gt; should reject calculation for non-existent period" time="0.001885083">
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; lockPeriod() &gt; should lock a calculated period" time="0.000617542">
            <failure message="Settlement period not found">
Unknown Error: Settlement period not found

Serialized Error: { errorCode: &apos;NOT_FOUND&apos; }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; lockPeriod() &gt; should reject locking open period" time="0.001391958">
            <failure message="expected { errorCode: &apos;NOT_FOUND&apos;, (1) } to match object { errorCode: &apos;INVALID_STATUS&apos; }
(1 matching property omitted from actual)" type="AssertionError">
AssertionError: expected { errorCode: &apos;NOT_FOUND&apos;, (1) } to match object { errorCode: &apos;INVALID_STATUS&apos; }
(1 matching property omitted from actual)

- Expected
+ Received

  {
-   &quot;errorCode&quot;: &quot;INVALID_STATUS&quot;,
+   &quot;errorCode&quot;: &quot;NOT_FOUND&quot;,
  }

  tests/unit/backend/settlementService.test.js:311:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; lockPeriod() &gt; should reject locking already locked period" time="0.002094">
            <failure message="expected { errorCode: &apos;NOT_FOUND&apos;, (1) } to match object { errorCode: &apos;PERIOD_LOCKED&apos; }
(1 matching property omitted from actual)" type="AssertionError">
AssertionError: expected { errorCode: &apos;NOT_FOUND&apos;, (1) } to match object { errorCode: &apos;PERIOD_LOCKED&apos; }
(1 matching property omitted from actual)

- Expected
+ Received

  {
-   &quot;errorCode&quot;: &quot;PERIOD_LOCKED&quot;,
+   &quot;errorCode&quot;: &quot;NOT_FOUND&quot;,
  }

  tests/unit/backend/settlementService.test.js:329:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; listPeriods() &gt; should return list of periods" time="0.000945834">
            <failure message="expected [ { (10) } ] to have a length of 2 but got 1" type="AssertionError">
AssertionError: expected [ { (10) } ] to have a length of 2 but got 1

- Expected
+ Received

- 2
+ 1

  tests/unit/backend/settlementService.test.js:358:29
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; listPeriods() &gt; should handle empty list" time="0.000738542">
            <failure message="expected [ { (10) } ] to deeply equal []" type="AssertionError">
AssertionError: expected [ { (10) } ] to deeply equal []

- Expected
+ Received

- []
+ [
+   {
+     &quot;calculatedAt&quot;: null,
+     &quot;createdAt&quot;: &quot;2025-12-21 11:37:17&quot;,
+     &quot;id&quot;: &quot;b7ab13f6-6efb-484d-ab06-c8d51c3876b4&quot;,
+     &quot;lockedAt&quot;: null,
+     &quot;partnerCount&quot;: 0,
+     &quot;periodEnd&quot;: &quot;2024-01-31T23:59:59Z&quot;,
+     &quot;periodStart&quot;: &quot;2024-01-01T00:00:00Z&quot;,
+     &quot;status&quot;: &quot;OPEN&quot;,
+     &quot;totalRevenue&quot;: 0,
+     &quot;totalSettlements&quot;: 0,
+   },
+ ]

  tests/unit/backend/settlementService.test.js:368:29
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/settlementService.test.js" name="SettlementService &gt; Immutability &gt; should prevent modifications to locked period" time="0.000450667">
            <failure message="expected { errorCode: &apos;NOT_FOUND&apos;, (1) } to match object { errorCode: &apos;PERIOD_LOCKED&apos; }
(1 matching property omitted from actual)" type="AssertionError">
AssertionError: expected { errorCode: &apos;NOT_FOUND&apos;, (1) } to match object { errorCode: &apos;PERIOD_LOCKED&apos; }
(1 matching property omitted from actual)

- Expected
+ Received

  {
-   &quot;errorCode&quot;: &quot;PERIOD_LOCKED&quot;,
+   &quot;errorCode&quot;: &quot;NOT_FOUND&quot;,
  }

  tests/unit/backend/settlementService.test.js:384:13
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/stageGateService.test.js" timestamp="2025-12-21T11:37:25.847Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.187229083">
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; getGateType &gt; should return correct gate for transition" time="0.000572625">
        </testcase>
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; getGateType &gt; should return null for unknown transition" time="0.000113875">
        </testcase>
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; evaluateGate &gt; should evaluate readiness gate criteria" time="0.000383125">
        </testcase>
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; evaluateGate &gt; should report failure if criteria missing" time="0.000127875">
        </testcase>
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; passGate &gt; should record gate passage" time="0.00146175">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/statusMachine.test.js" timestamp="2025-12-21T11:37:25.847Z" hostname="MacBook-Pro-Piotr.local" tests="11" failures="0" errors="0" skipped="0" time="0.194034917">
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; canTransitionInitiative &gt; should allow valid transition" time="0.00053075">
        </testcase>
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; canTransitionInitiative &gt; should block invalid transition" time="0.000084958">
        </testcase>
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; canTransitionTask &gt; should allow valid transition" time="0.000077209">
        </testcase>
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; canTransitionTask &gt; should allow flow back" time="0.000058041">
        </testcase>
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; validateInitiativeTransition &gt; should return valid for simple allowed transition" time="0.00009325">
        </testcase>
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; validateInitiativeTransition &gt; should require reason for blocking" time="0.000095625">
        </testcase>
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; validateInitiativeTransition &gt; should allow blocking with reason" time="0.000044875">
        </testcase>
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; validateInitiativeTransition &gt; should prevent completion if pending tasks exist" time="0.000061">
        </testcase>
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; validateInitiativeTransition &gt; should prevent approved state if governance failed" time="0.000055458">
        </testcase>
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; validateTaskTransition &gt; should validate blocker type" time="0.000078916">
        </testcase>
        <testcase classname="tests/unit/backend/statusMachine.test.js" name="StatusMachine &gt; validateTaskTransition &gt; should pass with full blocking info" time="0.000042">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/storageReconciliationService.test.js" timestamp="2025-12-21T11:37:25.848Z" hostname="MacBook-Pro-Piotr.local" tests="1" failures="0" errors="0" skipped="0" time="0.114225709">
        <testcase classname="tests/unit/backend/storageReconciliationService.test.js" name="Storage Reconciliation Service &gt; should handle reconciliation (DB interaction) [SKIPPED]" time="0.000481375">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/storageService.test.js" timestamp="2025-12-21T11:37:25.848Z" hostname="MacBook-Pro-Piotr.local" tests="27" failures="18" errors="0" skipped="0" time="0.179718208">
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getIsolatedPath() &gt; should generate isolated path for organization and project" time="0.001345208">
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getIsolatedPath() &gt; should use &quot;global&quot; as project scope when projectId is null" time="0.000213542">
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getIsolatedPath() &gt; should throw error when orgId is missing" time="0.000419708">
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getIsolatedPath() &gt; should default type to &quot;global&quot; when not provided" time="0.000082458">
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; storeFile() &gt; should move file to isolated storage" time="0.001973083">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:110:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; storeFile() &gt; should sanitize filename" time="0.000907958">
            <failure message="ENOENT: no such file or directory, rename &apos;/tmp/file.txt&apos; -&gt; &apos;/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/uploads/org-test-123/global/type/1766317038395-my_file__2024_.pdf&apos;" type="Error">
Error: ENOENT: no such file or directory, rename &apos;/tmp/file.txt&apos; -&gt; &apos;/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/uploads/org-test-123/global/type/1766317038395-my_file__2024_.pdf&apos;
  StorageService.storeFile server/services/storageService.js:55:9
  tests/unit/backend/storageService.test.js:125:13


Serialized Error: { errno: -2, code: &apos;ENOENT&apos;, syscall: &apos;rename&apos;, path: &apos;/tmp/file.txt&apos;, dest: &apos;/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/uploads/org-test-123/global/type/1766317038395-my_file__2024_.pdf&apos; }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; storeFile() &gt; should create directory recursively" time="0.000328042">
            <failure message="ENOENT: no such file or directory, rename &apos;/tmp/file.txt&apos; -&gt; &apos;/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/uploads/org-test-123/global/type/1766317038396-file.txt&apos;" type="Error">
Error: ENOENT: no such file or directory, rename &apos;/tmp/file.txt&apos; -&gt; &apos;/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/uploads/org-test-123/global/type/1766317038396-file.txt&apos;
  StorageService.storeFile server/services/storageService.js:55:9
  tests/unit/backend/storageService.test.js:137:13


Serialized Error: { errno: -2, code: &apos;ENOENT&apos;, syscall: &apos;rename&apos;, path: &apos;/tmp/file.txt&apos;, dest: &apos;/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/uploads/org-test-123/global/type/1766317038396-file.txt&apos; }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; softDeleteFile() &gt; should move file to trash folder" time="0.000178833">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:151:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; softDeleteFile() &gt; should return false when file does not exist" time="0.000149542">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:167:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; softDeleteFile() &gt; should return false when path is null" time="0.000152666">
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getFileStats() &gt; should return file stats when file exists" time="0.000203708">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:190:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getFileStats() &gt; should return null when file does not exist" time="0.000140125">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:201:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getDirectorySize() &gt; should calculate directory size recursively" time="0.000125083">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:217:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getDirectorySize() &gt; should return 0 when directory does not exist" time="0.000101459">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:230:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getDirectorySize() &gt; should handle nested directories" time="0.00010625">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:246:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getUsageByOrganization() &gt; should return storage usage for organization" time="0.00009025">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:261:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getGlobalUsage() &gt; should return global usage stats with breakdown" time="0.000093292">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:277:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; getGlobalUsage() &gt; should handle missing base directory gracefully" time="0.000097458">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:289:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; listFiles() &gt; should list all files in organization directory" time="0.000084167">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:305:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; listFiles() &gt; should handle missing directory gracefully" time="0.00008225">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:319:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; listFiles() &gt; should include relative paths in file list" time="0.000085417">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:332:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; deleteFile() &gt; should delete file by relative path" time="0.000076375">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:353:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; deleteFile() &gt; should throw error for invalid path (path traversal attempt)" time="0.000335542">
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; deleteFile() &gt; should return false when file does not exist" time="0.000088416">
            <failure message="mockFs is not defined" type="ReferenceError">
ReferenceError: mockFs is not defined
  tests/unit/backend/storageService.test.js:375:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; Security &amp; Multi-Tenant Isolation &gt; should prevent path traversal attacks" time="0.00009">
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; Security &amp; Multi-Tenant Isolation &gt; should isolate files by organization ID" time="0.000393875">
        </testcase>
        <testcase classname="tests/unit/backend/storageService.test.js" name="StorageService &gt; Security &amp; Multi-Tenant Isolation &gt; should isolate files by project within organization" time="0.000172208">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/systemIntegrity.test.js" timestamp="2025-12-21T11:37:25.850Z" hostname="MacBook-Pro-Piotr.local" tests="1" failures="0" errors="0" skipped="0" time="0.189041584">
        <testcase classname="tests/unit/backend/systemIntegrity.test.js" name="System Integrity Service &gt; should perform integrity checks (DB interaction) [SKIPPED]" time="0.000484417">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/tokenBillingService.test.js" timestamp="2025-12-21T11:37:25.850Z" hostname="MacBook-Pro-Piotr.local" tests="15" failures="13" errors="0" skipped="0" time="0.202437875">
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; getBalance() &gt; should return user token balance" time="0.006876">
            <failure message="expected +0 to be 1000 // Object.is equality" type="AssertionError">
AssertionError: expected +0 to be 1000 // Object.is equality

- Expected
+ Received

- 1000
+ 0

  tests/unit/backend/tokenBillingService.test.js:51:45
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; getBalance() &gt; should return zero balance for new user" time="0.001166917">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; getBalance() &gt; should handle database errors" time="0.002324792">
            <failure message="promise resolved &quot;{ user_id: &apos;user-123&apos;, (4) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ user_id: &apos;user-123&apos;, (4) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;byok_usage_tokens&quot;: 0,
+   &quot;local_usage_tokens&quot;: 0,
+   &quot;platform_tokens&quot;: 0,
+   &quot;platform_tokens_bonus&quot;: 0,
+   &quot;user_id&quot;: &quot;user-123&quot;,
  }

  tests/unit/backend/tokenBillingService.test.js:82:14
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; hasSufficientBalance() &gt; should return true when balance is sufficient" time="0.001079958">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/tokenBillingService.test.js:99:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; hasSufficientBalance() &gt; should return false when balance is insufficient" time="0.00074325">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; hasSufficientBalance() &gt; should include bonus tokens in balance check" time="0.002130584">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/tokenBillingService.test.js:129:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; deductTokens() &gt; should deduct tokens from user balance" time="0.007910333">
            <failure message="SQLITE_CONSTRAINT: NOT NULL constraint failed: token_transactions.organization_id" type="Error">
Error: SQLITE_CONSTRAINT: NOT NULL constraint failed: token_transactions.organization_id

Serialized Error: { errno: 19, code: &apos;SQLITE_CONSTRAINT&apos; }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; deductTokens() &gt; should deduct from organization balance when organizationId provided" time="0.0028365">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/tokenBillingService.test.js:206:37
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; deductTokens() &gt; should handle insufficient balance" time="0.001430458">
            <failure message="SQLITE_CONSTRAINT: NOT NULL constraint failed: token_transactions.organization_id" type="Error">
Error: SQLITE_CONSTRAINT: NOT NULL constraint failed: token_transactions.organization_id

Serialized Error: { errno: 19, code: &apos;SQLITE_CONSTRAINT&apos; }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; deductTokens() &gt; should handle database errors" time="0.002622291">
            <failure message="expected [Function] to throw error including &apos;DB Error&apos; but got &apos;SQLITE_CONSTRAINT: NOT NULL constrain&apos;" type="AssertionError">
AssertionError: expected [Function] to throw error including &apos;DB Error&apos; but got &apos;SQLITE_CONSTRAINT: NOT NULL constrain&apos;

Expected: &quot;DB Error&quot;
Received: &quot;SQLITE_CONSTRAINT: NOT NULL constraint failed: token_transactions.organization_id&quot;

  tests/unit/backend/tokenBillingService.test.js:236:13
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; creditTokens() &gt; should credit tokens to user balance" time="0.002517125">
            <failure message="SQLITE_ERROR: table token_transactions has no column named package_id" type="Error">
Error: SQLITE_ERROR: table token_transactions has no column named package_id

Serialized Error: { errno: 1, code: &apos;SQLITE_ERROR&apos; }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; creditTokens() &gt; should credit to organization balance when organizationId provided" time="0.005220125">
            <failure message="SQLITE_ERROR: table token_transactions has no column named package_id" type="Error">
Error: SQLITE_ERROR: table token_transactions has no column named package_id

Serialized Error: { errno: 1, code: &apos;SQLITE_ERROR&apos; }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; Multi-Tenant Isolation &gt; should only deduct from specified organization" time="0.004955209">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/tokenBillingService.test.js:315:38
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; getMargins() &gt; should return all billing margins" time="0.000813959">
            <failure message="expected [ { source_type: &apos;byok&apos;, (5) }, (2) ] to have a length of 2 but got 3" type="AssertionError">
AssertionError: expected [ { source_type: &apos;byok&apos;, (5) }, (2) ] to have a length of 2 but got 3

- Expected
+ Received

- 2
+ 3

  tests/unit/backend/tokenBillingService.test.js:330:29
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService &gt; getMargin() &gt; should return margin for specific source type" time="0.000606792">
            <failure message="expected 30 to be 10 // Object.is equality" type="AssertionError">
AssertionError: expected 30 to be 10 // Object.is equality

- Expected
+ Received

- 10
+ 30

  tests/unit/backend/tokenBillingService.test.js:352:43
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/tokenLedger.enterprise.test.js" timestamp="2025-12-21T11:37:25.852Z" hostname="MacBook-Pro-Piotr.local" tests="7" failures="4" errors="0" skipped="0" time="0.128238084">
        <testcase classname="tests/unit/backend/tokenLedger.enterprise.test.js" name="Token Ledger Enterprise Tests &gt; Fail-Closed for TRIAL &gt; should deny access when org not found (fail-closed)" time="0.001393083">
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedger.enterprise.test.js" name="Token Ledger Enterprise Tests &gt; Fail-Closed for TRIAL &gt; should deny when TRIAL balance insufficient" time="0.004074875">
            <failure message="expected &apos;Balance check failed. Please retry.&apos; to contain &apos;Trial token limit reached&apos;" type="AssertionError">
AssertionError: expected &apos;Balance check failed. Please retry.&apos; to contain &apos;Trial token limit reached&apos;

Expected: &quot;Trial token limit reached&quot;
Received: &quot;Balance check failed. Please retry.&quot;

  tests/unit/backend/tokenLedger.enterprise.test.js:116:34
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedger.enterprise.test.js" name="Token Ledger Enterprise Tests &gt; Fail-Closed for TRIAL &gt; should allow when TRIAL balance is sufficient" time="0.00125175">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/tokenLedger.enterprise.test.js:124:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedger.enterprise.test.js" name="Token Ledger Enterprise Tests &gt; PAYGO Trigger &gt; should flag paygoTriggered when ACTIVE org has low balance" time="0.000753375">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/tokenLedger.enterprise.test.js:139:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedger.enterprise.test.js" name="Token Ledger Enterprise Tests &gt; Atomicity - Ledger Fail Rolls Back &gt; getOrgBalance uses async pattern" time="0.000398834">
            <failure message="Organization not found" type="Error">
Error: Organization not found
  TokenBillingService.getOrgBalance server/services/tokenBillingService.js:374:25
  tests/unit/backend/tokenLedger.enterprise.test.js:149:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedger.enterprise.test.js" name="Token Ledger Enterprise Tests &gt; Atomicity - Ledger Fail Rolls Back &gt; getOrgBalance throws on missing org" time="0.001488959">
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedger.enterprise.test.js" name="Token Ledger Enterprise Tests &gt; Ledger Summary &gt; returns aggregated values" time="0.0006625">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/tokenLedgerService.test.js" timestamp="2025-12-21T11:37:25.853Z" hostname="MacBook-Pro-Piotr.local" tests="7" failures="7" errors="0" skipped="0" time="0.170856084">
        <testcase classname="tests/unit/backend/tokenLedgerService.test.js" name="TokenBillingService - Ledger Functionality &gt; getOrgBalance &gt; should return organization balance and billing status" time="0.002092791">
            <failure message="Organization not found" type="Error">
Error: Organization not found
  TokenBillingService.getOrgBalance server/services/tokenBillingService.js:374:25
  tests/unit/backend/tokenLedgerService.test.js:51:28
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedgerService.test.js" name="TokenBillingService - Ledger Functionality &gt; hasOrgSufficientBalance &gt; should allow call when balance is sufficient" time="0.002949291">
            <failure message="expected false to be true // Object.is equality" type="AssertionError">
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

  tests/unit/backend/tokenLedgerService.test.js:63:36
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedgerService.test.js" name="TokenBillingService - Ledger Functionality &gt; hasOrgSufficientBalance &gt; should deny call when trial balance is insufficient" time="0.000764625">
            <failure message="Cannot find module &apos;../../server/database&apos;
Require stack:
- /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js" type="Error">
Error: Cannot find module &apos;../../server/database&apos;
Require stack:
- /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js
  tests/unit/backend/tokenLedgerService.test.js:69:24


Serialized Error: { code: &apos;MODULE_NOT_FOUND&apos;, requireStack: [ &apos;/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js&apos; ] }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedgerService.test.js" name="TokenBillingService - Ledger Functionality &gt; getLedger &gt; should return ledger entries for organization" time="0.001226">
            <failure message="expected +0 to be 2 // Object.is equality" type="AssertionError">
AssertionError: expected +0 to be 2 // Object.is equality

- Expected
+ Received

- 2
+ 0

  tests/unit/backend/tokenLedgerService.test.js:86:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedgerService.test.js" name="TokenBillingService - Ledger Functionality &gt; getLedgerSummary &gt; should return aggregated ledger summary" time="0.000565125">
            <failure message="Cannot find module &apos;../../server/database&apos;
Require stack:
- /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js" type="Error">
Error: Cannot find module &apos;../../server/database&apos;
Require stack:
- /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js
  tests/unit/backend/tokenLedgerService.test.js:94:24


Serialized Error: { code: &apos;MODULE_NOT_FOUND&apos;, requireStack: [ &apos;/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js&apos; ] }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedgerService.test.js" name="TokenBillingService - Ledger Functionality &gt; creditOrganization &gt; should add credit and create ledger entry" time="0.000575167">
            <failure message="Cannot find module &apos;../../server/database&apos;
Require stack:
- /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js" type="Error">
Error: Cannot find module &apos;../../server/database&apos;
Require stack:
- /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js
  tests/unit/backend/tokenLedgerService.test.js:110:24


Serialized Error: { code: &apos;MODULE_NOT_FOUND&apos;, requireStack: [ &apos;/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js&apos; ] }
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/tokenLedgerService.test.js" name="TokenBillingService - deductTokens with Ledger &gt; should create ledger entry when deducting from organization" time="0.001460792">
            <failure message="Cannot find module &apos;../../server/database&apos;
Require stack:
- /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js" type="Error">
Error: Cannot find module &apos;../../server/database&apos;
Require stack:
- /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js
  tests/unit/backend/tokenLedgerService.test.js:130:20


Serialized Error: { code: &apos;MODULE_NOT_FOUND&apos;, requireStack: [ &apos;/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/tokenLedgerService.test.js&apos; ] }
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/usageService.test.js" timestamp="2025-12-21T11:37:25.853Z" hostname="MacBook-Pro-Piotr.local" tests="21" failures="2" errors="0" skipped="0" time="0.184736125">
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; recordTokenUsage() &gt; should record token usage" time="0.005010708">
            <failure message="expected &apos;INSERT INTO usage_records (id, organi&apos; to contain &apos;type = \&apos;token\&apos;&apos;" type="AssertionError">
AssertionError: expected &apos;INSERT INTO usage_records (id, organi&apos; to contain &apos;type = \&apos;token\&apos;&apos;

- Expected
+ Received

- type = &apos;token&apos;
+ INSERT INTO usage_records (id, organization_id, user_id, type, amount, action, metadata)
+              VALUES (?, ?, ?, &apos;token&apos;, ?, ?, ?)

  Object.&lt;anonymous&gt; tests/unit/backend/usageService.test.js:51:31
  server/services/usageService.js:19:17
  Object.recordTokenUsage server/services/usageService.js:18:12
  tests/unit/backend/usageService.test.js:60:47
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; recordTokenUsage() &gt; should handle database errors" time="0.000715625">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; recordStorageUsage() &gt; should record storage usage" time="0.000574375">
            <failure message="expected &apos;INSERT INTO usage_records (id, organi&apos; to contain &apos;type = \&apos;storage\&apos;&apos;" type="AssertionError">
AssertionError: expected &apos;INSERT INTO usage_records (id, organi&apos; to contain &apos;type = \&apos;storage\&apos;&apos;

- Expected
+ Received

- type = &apos;storage&apos;
+ INSERT INTO usage_records (id, organization_id, user_id, type, amount, action, metadata)
+              VALUES (?, ?, NULL, &apos;storage&apos;, ?, ?, ?)

  Object.&lt;anonymous&gt; tests/unit/backend/usageService.test.js:88:31
  server/services/usageService.js:37:17
  Object.recordStorageUsage server/services/usageService.js:36:12
  tests/unit/backend/usageService.test.js:95:47
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; getCurrentUsage() &gt; should return current usage with token and storage limits" time="0.000358625">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; getCurrentUsage() &gt; should handle organizations without plan" time="0.00019475">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; getCurrentUsage() &gt; should calculate storage percentage correctly" time="0.000117291">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; getCurrentUsage() &gt; should ensure storage never goes below 0" time="0.000128209">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; checkQuota() &gt; should allow when quota available" time="0.000170792">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; checkQuota() &gt; should deny when quota exceeded and overage disabled" time="0.000110917">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; checkQuota() &gt; should allow when overage enabled even if quota exceeded" time="0.0001325">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; checkQuota() &gt; should allow unlimited when limit is 0" time="0.000096083">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; calculateOverage() &gt; should calculate overage charges correctly" time="0.000234833">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; calculateOverage() &gt; should return zero overage when within limits" time="0.000103625">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; updateUsageSummary() &gt; should create or update usage summary" time="0.000168167">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; getUsageHistory() &gt; should retrieve usage history" time="0.000295667">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; getUsageHistory() &gt; should respect limit parameter" time="0.000073334">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; getGlobalUsageStats() &gt; should return global usage statistics" time="0.000127459">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; checkProjectQuota() &gt; should check project storage quota" time="0.000138833">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; checkProjectQuota() &gt; should allow unlimited when limit is null" time="0.00007975">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; checkProjectQuota() &gt; should reject when project not found" time="0.000129833">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService &gt; Multi-Tenant Isolation &gt; should filter usage by organization_id" time="0.000221167">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/webhookService.test.js" timestamp="2025-12-21T11:37:25.854Z" hostname="MacBook-Pro-Piotr.local" tests="21" failures="0" errors="0" skipped="0" time="0.181905833">
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; trigger() &gt; should trigger webhooks for matching event type" time="0.001652916">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; trigger() &gt; should return zero triggered when no webhooks match" time="0.000196792">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; trigger() &gt; should handle multiple webhooks" time="0.000181417">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; trigger() &gt; should handle webhook failures gracefully" time="0.000284709">
            <system-err>
[Webhook] Failed to send to https://example.com/webhook: Network error

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; trigger() &gt; should handle database errors" time="0.002403166">
            <system-err>
[Webhook] Query error: Error: Database error
    at Object.&lt;anonymous&gt; (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/webhookService.test.js:144:26)
    at Object.Mock [as all] (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/spy/dist/index.js:285:34)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/webhookService.js:24:21
    at new Promise (&lt;anonymous&gt;)
    at WebhookService.trigger (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/webhookService.js:22:16)
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/webhookService.test.js:147:41
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; trigger() &gt; should only trigger webhooks for specified organization" time="0.000146667">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; sendWebhook() &gt; should send webhook with correct headers" time="0.000194833">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; sendWebhook() &gt; should include payload in body" time="0.000322042">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; sendWebhook() &gt; should throw on non-ok response" time="0.000158333">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; sendSlackNotification() &gt; should send Slack notification" time="0.000811417">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; sendSlackNotification() &gt; should handle Slack API errors" time="0.000090958">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; sendSlackNotification() &gt; should handle network errors" time="0.0002785">
            <system-err>
[Slack] Notification failed: Error: Network error
    at /Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/tests/unit/backend/webhookService.test.js:256:45
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/traces.U4xDYhzZ.js:115:27)
    at trace (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/node_modules/@vitest/runner/dist/index.js:1653:12)

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; Multi-tenant Isolation &gt; should not leak webhooks between organizations" time="0.000145042">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; Multi-tenant Isolation &gt; should filter webhooks by organization_id" time="0.000067042">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; Multi-tenant Isolation &gt; should only query active webhooks" time="0.00009425">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; Security &gt; should generate HMAC signature for each webhook" time="0.000106833">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; Security &gt; should include event type in headers" time="0.000074666">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; Security &gt; should generate different signatures for different secrets" time="0.000109292">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; formatInitiativeMessage() &gt; should format initiative message correctly" time="0.000146583">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; formatTaskMessage() &gt; should format task message with status emoji" time="0.000127709">
        </testcase>
        <testcase classname="tests/unit/backend/webhookService.test.js" name="WebhookService &gt; formatTaskMessage() &gt; should handle completed status" time="0.000059208">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/adminMiddleware.test.js" timestamp="2025-12-21T11:37:25.855Z" hostname="MacBook-Pro-Piotr.local" tests="4" failures="0" errors="0" skipped="0" time="0.226515291">
        <testcase classname="tests/unit/backend/middleware/adminMiddleware.test.js" name="AdminMiddleware &gt; should call next() if user is admin" time="0.002106">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/adminMiddleware.test.js" name="AdminMiddleware &gt; should call next() if user is superadmin" time="0.000370167">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/adminMiddleware.test.js" name="AdminMiddleware &gt; should return 403 if user is not admin" time="0.001063125">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/adminMiddleware.test.js" name="AdminMiddleware &gt; should return 401 if verify failed (bad signature)" time="0.000234">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/auditLog.test.js" timestamp="2025-12-21T11:37:25.856Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.246373292">
        <testcase classname="tests/unit/backend/middleware/auditLog.test.js" name="AuditLog Middleware &gt; should call next() and override res.end" time="0.006338584">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/auditLog.test.js" name="AuditLog Middleware &gt; should log activity when res.end is called for 2xx POST" time="0.051733625">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/auditLog.test.js" name="AuditLog Middleware &gt; should NOT log for GET requests" time="0.000686792">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/authMiddleware.test.js" timestamp="2025-12-21T11:37:25.856Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="4" time="0.08093775">
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should return 403 if no token provided" time="0.001556625">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should return 401 if token expired" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should return 401 if token invalid" time="0.000288875">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should call next() if token valid and no revocation check needed (no jti)" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should check revocation if jti is present" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should return 401 if token is revoked" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/planLimits.test.js" timestamp="2025-12-21T11:37:25.856Z" hostname="MacBook-Pro-Piotr.local" tests="8" failures="0" errors="0" skipped="0" time="0.195757625">
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should return 403 if no organization found in user" time="0.009151208">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should return 404 if organization does not exist in DB" time="0.000931333">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should allow request if within limit (Free plan)" time="0.001341167">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should block request if limit reached (Free plan)" time="0.001489375">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should allow request if within limit (Pro plan)" time="0.001334208">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should treat trial status as pro plan" time="0.001556834">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should handle undefined limits gracefully (warn and allow)" time="0.001110542">
            <system-err>
Limit key unknown_limit_key not found for plan free

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should check max_members limit" time="0.001544125">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" timestamp="2025-12-21T11:37:25.857Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.194064875">
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should skip check if no project_id provided" time="0.000939166">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should allow request if quota is sufficient" time="0.001244583">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should allow request if limit is NULL (unlimited)" time="0.0010015">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should block 429 if quota exceeded" time="0.001861084">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should cleanup temp file if quota exceeded" time="0.000880834">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should handle errors gracefully (e.g. project not found)" time="0.001055542">
            <system-err>
Project quota check error: Error: Project not found
    at Statement.&lt;anonymous&gt; (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/services/usageService.js:303:41)
    at Statement.replacement (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/node_modules/sqlite3/lib/trace.js:25:27)
    at Statement.replacement (/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/server/node_modules/sqlite3/lib/trace.js:25:27)

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/quotaMiddleware.test.js" timestamp="2025-12-21T11:37:25.857Z" hostname="MacBook-Pro-Piotr.local" tests="8" failures="0" errors="0" skipped="0" time="0.256656584">
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceTokenQuota &gt; should return 401 if no orgId" time="0.001068">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceTokenQuota &gt; should allow if usage is below limit" time="0.002791625">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceTokenQuota &gt; should block 429 if usage exceeds limit" time="0.002030834">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceTokenQuota &gt; should allow if overage is enabled even if exceeded" time="0.002490625">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceTokenQuota &gt; should set warning headers if &gt; 80%" time="0.003215834">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceStorageQuota &gt; should allow if allowed" time="0.003028416">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceStorageQuota &gt; should block 429 if exceeded" time="0.001769583">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; recordTokenUsageAfterResponse &gt; should insert usage record into DB" time="0.05149625">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/superAdminMiddleware.test.js" timestamp="2025-12-21T11:37:25.857Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.200510833">
        <testcase classname="tests/unit/backend/middleware/superAdminMiddleware.test.js" name="SuperAdminMiddleware &gt; should call next() if user is superadmin" time="0.002141834">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/superAdminMiddleware.test.js" name="SuperAdminMiddleware &gt; should return 403 if user is admin (not super)" time="0.0012045">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/superAdminMiddleware.test.js" name="SuperAdminMiddleware &gt; should return 401 if token is invalid (bad signature)" time="0.000275292">
        </testcase>
    </testsuite>
</testsuites>
