<?xml version="1.0" encoding="UTF-8" ?>
<testsuites name="vitest tests" tests="514" failures="17" errors="0" time="8.821774666">
    <testsuite name="tests/unit/aiResponsePostProcessor.test.js" timestamp="2025-12-20T16:07:59.259Z" hostname="MacBook-Pro-Piotr.local" tests="20" failures="0" errors="0" skipped="0" time="0.002683375">
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Memory Prefix &gt; should add memory prefix when memory count &gt; 0" time="0.000514667">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Memory Prefix &gt; should NOT add memory prefix when memory count is 0" time="0.000131959">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Memory Prefix &gt; should NOT duplicate memory prefix if already present" time="0.000058667">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; External Sources Prefix &gt; should add external prefix when external sources are used" time="0.000069208">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; External Sources Prefix &gt; should NOT add external prefix when no external sources" time="0.000061125">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; External Sources Prefix &gt; should NOT duplicate external prefix if already present" time="0.000046542">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Combined Prefixes &gt; should add both prefixes when both memory and external sources exist" time="0.0000605">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Combined Prefixes &gt; should maintain correct order: memory first, then external" time="0.000074292">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Edge Cases &gt; should handle empty response safely" time="0.000041792">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Edge Cases &gt; should handle null response safely" time="0.000045791">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Edge Cases &gt; should handle undefined context safely" time="0.000029375">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Edge Cases &gt; should handle null context safely" time="0.000024459">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Edge Cases &gt; should trim whitespace from response" time="0.000023167">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; getMemoryCount &gt; should count previous decisions" time="0.00002925">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; getMemoryCount &gt; should return memoryCount from projectMemory" time="0.000038">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; getMemoryCount &gt; should return 1 when PMO health snapshot exists" time="0.00002625">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; getExternalSources &gt; should return externalSourcesUsed array" time="0.000252083">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; getExternalSources &gt; should derive sources from fetchedData" time="0.000304208">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; stripPrefixes &gt; should remove memory and external prefixes" time="0.000079875">
        </testcase>
        <testcase classname="tests/unit/aiResponsePostProcessor.test.js" name="aiResponsePostProcessor &gt; Helper Functions &gt; stripPrefixes &gt; should handle text without prefixes" time="0.0000355">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/aiRoleGuard.test.js" timestamp="2025-12-20T16:07:59.261Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="12" errors="0" skipped="0" time="0.004323542">
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Role Definitions &gt; should define three roles in correct hierarchy" time="0.000687333">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Role Definitions &gt; should define capabilities for each role" time="0.00016525">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Role Descriptions &gt; should return correct description for each role" time="0.00010425">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Role Descriptions &gt; should default to ADVISOR description for unknown role" time="0.00004375">
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; ADVISOR Role &gt; should allow explain actions" time="0.00157">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:56:46
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; ADVISOR Role &gt; should block draft creation" time="0.000165458">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:67:46
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; ADVISOR Role &gt; should block execution actions" time="0.000113791">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:78:46
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; MANAGER Role &gt; should allow draft creation with approval required" time="0.000107875">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:90:46
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; MANAGER Role &gt; should block execution actions" time="0.000109084">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:101:46
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; OPERATOR Role &gt; should allow execution actions" time="0.000103709">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:113:46
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Action Capability Checks &gt; OPERATOR Role &gt; should allow entity modifications" time="0.000082417">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:124:46
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Mutation Validation &gt; should block all mutations for ADVISOR" time="0.000084417">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:137:42
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Mutation Validation &gt; should allow mutations as drafts for MANAGER" time="0.000073875">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:148:42
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; Mutation Validation &gt; should allow direct mutations for OPERATOR" time="0.000075334">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:160:42
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; isActionBlocked &gt; should return blocked with required role for insufficient permissions" time="0.000071125">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:173:42
            </failure>
        </testcase>
        <testcase classname="tests/unit/aiRoleGuard.test.js" name="AI Role Guard &gt; isActionBlocked &gt; should return not blocked for allowed actions" time="0.000063208">
            <failure message="jest is not defined" type="ReferenceError">
ReferenceError: jest is not defined
 ❯ tests/unit/aiRoleGuard.test.js:186:42
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/analytics.service.test.ts" timestamp="2025-12-20T16:07:59.264Z" hostname="MacBook-Pro-Piotr.local" tests="8" failures="0" errors="0" skipped="0" time="0.001872292">
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; calculateAnalytics &gt; calculates analytics for empty arrays" time="0.000526792">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; calculateAnalytics &gt; calculates completion rate correctly" time="0.000122417">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; calculateAnalytics &gt; calculates initiative statistics" time="0.000104708">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; calculateAnalytics &gt; calculates total cost and benefit" time="0.000066416">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; generateBurnDownData &gt; generates burn down data for date range" time="0.000229791">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; generateBurnDownData &gt; handles empty task list" time="0.000045542">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; generateVelocityData &gt; generates velocity data for specified weeks" time="0.000105334">
        </testcase>
        <testcase classname="tests/unit/analytics.service.test.ts" name="Service Test: Analytics &gt; generateVelocityData &gt; uses default 8 weeks when not specified" time="0.000052166">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/api.service.test.ts" timestamp="2025-12-20T16:07:59.264Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.004117375">
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; login: should store token and return user on success" time="0.002103042">
            <system-out>
Api.login called: { email: [32m&apos;test@test.com&apos;[39m, url: [32m&apos;/api/auth/login&apos;[39m }

Login response status: [90mundefined[39m

Login response data: { token: [32m&apos;abc-123&apos;[39m, user: { id: [32m&apos;1&apos;[39m, email: [32m&apos;test@test.com&apos;[39m } }

            </system-out>
        </testcase>
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; login: should throw error on failure" time="0.000716334">
            <system-out>
Api.login called: { email: [32m&apos;test@test.com&apos;[39m, url: [32m&apos;/api/auth/login&apos;[39m }

Login response status: [90mundefined[39m

Login response data: { error: [32m&apos;Invalid credentials&apos;[39m }

            </system-out>
        </testcase>
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; getUsers: should send Authorization header" time="0.000317375">
        </testcase>
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; getLLMProviders: should return list" time="0.000102083">
        </testcase>
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; indexKnowledgeFiles: should trigger indexing" time="0.00017225">
        </testcase>
        <testcase classname="tests/unit/api.service.test.ts" name="Api Service Unit Tests &gt; saveSession: should post data" time="0.000142708">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/drdStructure.test.ts" timestamp="2025-12-20T16:07:59.265Z" hostname="MacBook-Pro-Piotr.local" tests="7" failures="0" errors="0" skipped="0" time="0.005551375">
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; exports DRD_STRUCTURE as array" time="0.00045275">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; each axis has required properties" time="0.000345708">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; each area has required properties" time="0.000878458">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; each level has required properties" time="0.002958625">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; getQuestionsForAxis &gt; returns areas for valid axis ID" time="0.000073958">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; getQuestionsForAxis &gt; returns empty array for invalid axis ID" time="0.000230083">
        </testcase>
        <testcase classname="tests/unit/drdStructure.test.ts" name="Service Test: drdStructure &gt; getQuestionsForAxis &gt; returns areas for different axis IDs" time="0.000073333">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/pdfExport.test.ts" timestamp="2025-12-20T16:07:59.265Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.206826958">
        <testcase classname="tests/unit/pdfExport.test.ts" name="Service Test: pdfExport &gt; exportReportToPDF &gt; returns false when element is not found" time="0.001524667">
            <system-err>
Element with id non-existent not found

            </system-err>
        </testcase>
        <testcase classname="tests/unit/pdfExport.test.ts" name="Service Test: pdfExport &gt; exportReportToPDF &gt; exports PDF successfully" time="0.202961625">
            <system-err>
[vitest] The vi.fn() mock did not use &apos;function&apos; or &apos;class&apos; in its implementation, see https://vitest.dev/api/vi#vi-spyon for examples.
PDF Export failed: TypeError: () =&gt; new MockJsPDF() is not a constructor
    at new j [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:262:27[90m)[39m
    at Module.exportReportToPDF [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mservices/pdf/pdfExport.ts:30:21[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:103:5)[39m

            </system-err>
        </testcase>
        <testcase classname="tests/unit/pdfExport.test.ts" name="Service Test: pdfExport &gt; exportReportToPDF &gt; handles errors gracefully" time="0.000846958">
            <system-err>
PDF Export failed: Error: Canvas error
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/pdfExport.test.ts:79:52
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

            </system-err>
        </testcase>
        <testcase classname="tests/unit/pdfExport.test.ts" name="Service Test: pdfExport &gt; exportDashboardToPDF &gt; creates PDF with metadata" time="0.000442584">
            <system-err>
[vitest] The vi.fn() mock did not use &apos;function&apos; or &apos;class&apos; in its implementation, see https://vitest.dev/api/vi#vi-spyon for examples.
Dashboard PDF Export failed: TypeError: () =&gt; new MockJsPDF() is not a constructor
    at new j [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:262:27[90m)[39m
    at Module.exportDashboardToPDF [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mservices/pdf/pdfExport.ts:70:21[90m)[39m
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/pdfExport.test.ts:89:19
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m

            </system-err>
        </testcase>
        <testcase classname="tests/unit/pdfExport.test.ts" name="Service Test: pdfExport &gt; exportDashboardToPDF &gt; handles optional metadata" time="0.0003345">
            <system-err>
[vitest] The vi.fn() mock did not use &apos;function&apos; or &apos;class&apos; in its implementation, see https://vitest.dev/api/vi#vi-spyon for examples.
Dashboard PDF Export failed: TypeError: () =&gt; new MockJsPDF() is not a constructor
    at new j [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/spy[24m/dist/index.js:262:27[90m)[39m
    at Module.exportDashboardToPDF [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mservices/pdf/pdfExport.ts:70:21[90m)[39m
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/pdfExport.test.ts:100:19
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/regulatoryModeGuard.test.js" timestamp="2025-12-20T16:07:59.266Z" hostname="MacBook-Pro-Piotr.local" tests="31" failures="0" errors="0" skipped="0" time="0.004027625">
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Action Classification &gt; ALLOWED_ACTIONS &gt; should include all advisory-only actions" time="0.000814834">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Action Classification &gt; BLOCKED_ACTIONS &gt; should include all mutation actions" time="0.000222167">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should allow EXPLAIN_CONTEXT in regulatory mode" time="0.00009275">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should allow ANALYZE_RISKS in regulatory mode" time="0.000043333">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should allow EDUCATE in regulatory mode" time="0.000047792">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK CREATE_DRAFT_TASK in regulatory mode" time="0.00003625">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK CREATE_DRAFT_INITIATIVE in regulatory mode" time="0.00004175">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK UPDATE_STATUS in regulatory mode" time="0.000043667">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK EXECUTE_ACTION in regulatory mode" time="0.000037208">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK MODIFY_ENTITY in regulatory mode" time="0.000056416">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should BLOCK DELETE_ENTITY in regulatory mode" time="0.000031083">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should block actions containing mutation keywords" time="0.000081083">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should allow actions without mutation keywords" time="0.000045666">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; isActionAllowed &gt; should handle null/undefined action gracefully" time="0.000030583">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Regulatory Mode Prompt &gt; should contain prohibition statements" time="0.000050958">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Regulatory Mode Prompt &gt; should forbid action verbs" time="0.000037833">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Regulatory Mode Prompt &gt; should require advisory language" time="0.000032">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Regulatory Mode Prompt &gt; should include example responses" time="0.000025583">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Forbidden Verbs List &gt; should contain all dangerous verbs" time="0.000135708">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Advisory Phrases List &gt; should contain recommended advisory language" time="0.000048333">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should block CREATE_DRAFT_TASK when regulatory mode is enabled" time="0.000253125">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should block UPDATE_STATUS when regulatory mode is enabled" time="0.000063625">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should allow EXPLAIN_CONTEXT when regulatory mode is enabled" time="0.00005025">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should allow ANALYZE_RISKS when regulatory mode is enabled" time="0.000051375">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should NOT block actions when regulatory mode is disabled" time="0.000061292">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should NOT block when no projectId is provided" time="0.00003775">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; enforceRegulatoryMode (with mocked isEnabled) &gt; should log blocked attempts to audit trail" time="0.000493542">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; getStatus &gt; should return full status object when enabled" time="0.000099125">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; getStatus &gt; should return full status object when disabled" time="0.000042958">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Integration with AI Role System &gt; should override ANY role when regulatory mode is active" time="0.000124708">
        </testcase>
        <testcase classname="tests/unit/regulatoryModeGuard.test.js" name="Regulatory Mode Guard &gt; Safety: Fail-Safe Behavior &gt; should default to blocking when database error occurs" time="0.000023333">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/roi.test.ts" timestamp="2025-12-20T16:07:59.268Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.001110167">
        <testcase classname="tests/unit/roi.test.ts" name="Unit Test: ROI Calculation &gt; should calculate ROI correctly for positive values" time="0.000442">
        </testcase>
        <testcase classname="tests/unit/roi.test.ts" name="Unit Test: ROI Calculation &gt; should handle zero cost to avoid infinity" time="0.000068541">
        </testcase>
        <testcase classname="tests/unit/roi.test.ts" name="Unit Test: ROI Calculation &gt; should return 0 for break-even" time="0.00005225">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/store.test.ts" timestamp="2025-12-20T16:07:59.268Z" hostname="MacBook-Pro-Piotr.local" tests="19" failures="0" errors="0" skipped="0" time="0.00406325">
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; initializes with correct default values" time="0.000978584">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets current view" time="0.000159208">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets session mode" time="0.000106042">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets current user" time="0.000276">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; toggles sidebar open state" time="0.000115833">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; toggles sidebar collapse" time="0.0000925">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; adds chat message" time="0.000533459">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets chat messages" time="0.000152208">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; clears chat" time="0.0001295">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets bot typing state" time="0.000088291">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets current stream content" time="0.000062166">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; updates free session data" time="0.000072542">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; updates free session data with function" time="0.000071542">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; updates full session data" time="0.000093667">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets AI config" time="0.000091458">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; toggles theme" time="0.000074125">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; updates last chat message" time="0.000083792">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; logout resets state" time="0.000124125">
        </testcase>
        <testcase classname="tests/unit/store.test.ts" name="Store Test: useAppStore &gt; sets current project ID" time="0.000075333">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/transformationEngine.test.ts" timestamp="2025-12-20T16:07:59.269Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.004060416">
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; generates initiatives from session" time="0.00063775">
        </testcase>
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; generates initiatives with required properties" time="0.001586916">
        </testcase>
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; generates initiatives only for levels above current" time="0.000335208">
        </testcase>
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; handles session with no gaps" time="0.000073708">
        </testcase>
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; assigns priority based on current level" time="0.000076709">
        </testcase>
        <testcase classname="tests/unit/transformationEngine.test.ts" name="Service Test: transformationEngine &gt; assigns complexity based on target level" time="0.000721417">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/transformationScenarios.test.ts" timestamp="2025-12-20T16:07:59.269Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.00124725">
        <testcase classname="tests/unit/transformationScenarios.test.ts" name="Transformation Scenarios Logic &gt; should have 6 unique scenarios" time="0.000463875">
        </testcase>
        <testcase classname="tests/unit/transformationScenarios.test.ts" name="Transformation Scenarios Logic &gt; recommendScenario should return stabilize for high risk &amp; low budget" time="0.000077291">
        </testcase>
        <testcase classname="tests/unit/transformationScenarios.test.ts" name="Transformation Scenarios Logic &gt; recommendScenario should return quickwins for low risk &amp; low budget" time="0.000053041">
        </testcase>
        <testcase classname="tests/unit/transformationScenarios.test.ts" name="Transformation Scenarios Logic &gt; recommendScenario should return foundation for high risk &amp; high budget" time="0.000049459">
        </testcase>
        <testcase classname="tests/unit/transformationScenarios.test.ts" name="Transformation Scenarios Logic &gt; recommendScenario should default to hybrid" time="0.000046167">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/utils.test.ts" timestamp="2025-12-20T16:07:59.270Z" hostname="MacBook-Pro-Piotr.local" tests="1" failures="0" errors="0" skipped="0" time="0.000929625">
        <testcase classname="tests/unit/utils.test.ts" name="Unit Test: Utilities &gt; should have utility functions available" time="0.000410083">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/activityService.test.js" timestamp="2025-12-20T16:07:59.270Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.7270305">
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; log &gt; logs activity with all parameters" time="0.109790417">
        </testcase>
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; log &gt; handles optional parameters" time="0.101951">
        </testcase>
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; getRecent &gt; fetches recent activities with default limit" time="0.111268542">
        </testcase>
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; getRecent &gt; fetches recent activities with custom limit" time="0.102654375">
        </testcase>
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; getRecent &gt; handles database errors gracefully" time="0.000721958">
        </testcase>
        <testcase classname="tests/unit/backend/activityService.test.js" name="Backend Service Test: ActivityService &gt; getByOrganization &gt; fetches activities for organization" time="0.101710125">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiActions.test.js" timestamp="2025-12-20T16:07:59.270Z" hostname="MacBook-Pro-Piotr.local" tests="23" failures="0" errors="0" skipped="0" time="0.058219833">
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should have 7 action types" time="0.030468958">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define CREATE_DRAFT_TASK type" time="0.000177417">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define CREATE_DRAFT_INITIATIVE type" time="0.000083792">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define SUGGEST_ROADMAP_CHANGE type" time="0.000090209">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define GENERATE_REPORT type" time="0.00007975">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define PREPARE_DECISION_SUMMARY type" time="0.000056084">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define EXPLAIN_CONTEXT type" time="0.000044167">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_TYPES &gt; should define ANALYZE_RISKS type" time="0.0000455">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_STATUS &gt; should define PENDING status" time="0.000070583">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_STATUS &gt; should define APPROVED status" time="0.000063583">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_STATUS &gt; should define REJECTED status" time="0.000051667">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; ACTION_STATUS &gt; should define EXECUTED status" time="0.000036708">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export requestAction function" time="0.000030583">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export createDraft function" time="0.000030417">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export approveAction function" time="0.000026625">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export rejectAction function" time="0.0000295">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export getPendingActions function" time="0.00002525">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIActionExecutor &gt; Service Structure &gt; should export executeAction function" time="0.000024834">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIAuditLogger &gt; Service Structure &gt; should export logInteraction function" time="0.025888042">
            <system-out>
[DB:scwdxj] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIAuditLogger &gt; Service Structure &gt; should export logSuggestion function" time="0.000063667">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIAuditLogger &gt; Service Structure &gt; should export recordUserDecision function" time="0.000041958">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIAuditLogger &gt; Service Structure &gt; should export getAuditLogs function" time="0.000030958">
        </testcase>
        <testcase classname="tests/unit/backend/aiActions.test.js" name="AIAuditLogger &gt; Service Structure &gt; should export getAuditStats function" time="0.000028167">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiCoreLayer.test.js" timestamp="2025-12-20T16:07:59.272Z" hostname="MacBook-Pro-Piotr.local" tests="56" failures="0" errors="0" skipped="0" time="0.054001583">
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export buildContext function" time="0.018649291">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildPlatformContext function" time="0.000123917">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildOrganizationContext function" time="0.000069958">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildProjectContext function" time="0.000091625">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildExecutionContext function" time="0.000085041">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildKnowledgeContext function" time="0.00006">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _buildExternalContext function" time="0.000045625">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; Service Structure &gt; should export _generateHash function" time="0.0000435">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; _generateHash &gt; should generate consistent hash" time="0.000124042">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIContextBuilder &gt; _generateHash &gt; should generate different hash for different inputs" time="0.00030425">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; POLICY_LEVELS &gt; should define ADVISORY level" time="0.0268275">
            <system-out>
[DB:uet10s] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; POLICY_LEVELS &gt; should define ASSISTED level" time="0.000072667">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; POLICY_LEVELS &gt; should define PROACTIVE level" time="0.000039584">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; POLICY_LEVELS &gt; should define AUTOPILOT level" time="0.000032334">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; AI_ROLES &gt; should define ADVISOR role" time="0.000034917">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; AI_ROLES &gt; should define PMO_MANAGER role" time="0.000035208">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; AI_ROLES &gt; should define EXECUTOR role" time="0.000027125">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; AI_ROLES &gt; should define EDUCATOR role" time="0.0000255">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; Service Structure &gt; should export getEffectivePolicy function" time="0.000027375">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; Service Structure &gt; should export canPerformAction function" time="0.000030583">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; Service Structure &gt; should export getPolicySummary function" time="0.00003675">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIPolicyEngine &gt; Service Structure &gt; should export updatePolicy function" time="0.000036625">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; MEMORY_TYPES &gt; should define DECISION type" time="0.001695916">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; MEMORY_TYPES &gt; should define PHASE_TRANSITION type" time="0.000054042">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; MEMORY_TYPES &gt; should define RECOMMENDATION type" time="0.000033042">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; MEMORY_TYPES &gt; should define PATTERN type" time="0.000027667">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; createSession &gt; should create session with unique conversationId" time="0.000185584">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; createSession &gt; should create session with empty messages array" time="0.000076125">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; createSession &gt; should create session with startedAt timestamp" time="0.000033333">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; addMessage &gt; should add message to session" time="0.00035525">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; addMessage &gt; should add timestamp to message" time="0.000042916">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; Service Structure &gt; should export recordProjectMemory function" time="0.000033042">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; Service Structure &gt; should export getUserPreferences function" time="0.000025916">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIMemoryManager &gt; Service Structure &gt; should export updateUserPreferences function" time="0.000024">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; AI_ROLES &gt; should define all 4 roles" time="0.002917917">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; CHAT_MODES &gt; should define EXPLAIN mode" time="0.000065541">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; CHAT_MODES &gt; should define GUIDE mode" time="0.000036208">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; CHAT_MODES &gt; should define ANALYZE mode" time="0.000029417">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; CHAT_MODES &gt; should define DO mode" time="0.000026">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; CHAT_MODES &gt; should define TEACH mode" time="0.00002525">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect EXPLAIN intent" time="0.000071584">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect GUIDE intent" time="0.000038542">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect ANALYZE intent" time="0.00003325">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect DO intent" time="0.000034291">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect TEACH intent" time="0.000034084">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should default to EXPLAIN" time="0.000025417">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _selectRole &gt; should select ADVISOR for EXPLAIN intent" time="0.000049042">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _selectRole &gt; should select PMO_MANAGER for GUIDE intent" time="0.000032667">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _selectRole &gt; should select EXECUTOR for DO intent" time="0.00002775">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _selectRole &gt; should select EDUCATOR for TEACH intent" time="0.000026917">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; _selectRole &gt; should fallback to ADVISOR if role not active" time="0.000025917">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; getRoleDescription &gt; should return description for ADVISOR" time="0.000072958">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; getRoleDescription &gt; should return description for PMO_MANAGER" time="0.000030333">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; getRoleDescription &gt; should return description for EXECUTOR" time="0.000026959">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; getRoleDescription &gt; should return description for EDUCATOR" time="0.000026333">
        </testcase>
        <testcase classname="tests/unit/backend/aiCoreLayer.test.js" name="AIOrchestrator &gt; Service Structure &gt; should export processMessage function" time="0.000024125">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiExplainabilityService.test.js" timestamp="2025-12-20T16:07:59.275Z" hostname="MacBook-Pro-Piotr.local" tests="35" failures="0" errors="0" skipped="0" time="0.006385833">
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; returns LOW when context is null" time="0.000709542">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; returns LOW when context is empty" time="0.000173167">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; returns LOW when PMOHealthSnapshot is missing and no project data" time="0.000058833">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; returns MEDIUM when PMOHealthSnapshot exists with blockers" time="0.000273625">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; returns HIGH when full context with no blockers" time="0.0001885">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; computeConfidenceLevel &gt; penalizes conflicting signals (many blockers AND many pending decisions)" time="0.000328708">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildReasoningSummary &gt; returns default message when no health data" time="0.000514917">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildReasoningSummary &gt; includes overdue tasks in reasoning" time="0.000737333">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildReasoningSummary &gt; includes pending decisions in reasoning" time="0.000255333">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildReasoningSummary &gt; includes phase information" time="0.00007725">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildReasoningSummary &gt; includes project memory count when provided" time="0.000042709">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; extractConstraintsApplied &gt; includes AI role constraint" time="0.000103792">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; extractConstraintsApplied &gt; includes policy level constraint" time="0.0000465">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; extractConstraintsApplied &gt; includes phase gate constraint" time="0.00004975">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; extractConstraintsApplied &gt; includes regulatory mode constraint" time="0.000044542">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; identifyDataUsed &gt; returns projectData false when no project context" time="0.000051541">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; identifyDataUsed &gt; returns projectData true when project context exists" time="0.00002975">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; identifyDataUsed &gt; returns projectMemoryCount from options" time="0.000027">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; identifyDataUsed &gt; returns empty externalSources when internet disabled" time="0.000211334">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; identifyDataUsed &gt; returns external sources when internet enabled" time="0.000105333">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildAIExplanation &gt; generates valid AIExplanation object" time="0.000274458">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildAIExplanation &gt; includes all required fields in correct format" time="0.000103375">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildAIExplanation &gt; timestamp is ISO 8601 format" time="0.000068417">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildAIExplanation &gt; maps orchestrator roles to project roles correctly" time="0.000041916">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildExplainabilityFooter &gt; returns empty string when explanation is null" time="0.000045583">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildExplainabilityFooter &gt; formats human-readable footer" time="0.000065708">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildExplainabilityFooter &gt; shows max 3 constraints" time="0.000064791">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; buildExplainabilityFooter &gt; does not expose raw internals" time="0.000041417">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _countPopulatedLayers &gt; returns 0 for null context" time="0.000021041">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _countPopulatedLayers &gt; counts populated layers correctly" time="0.000031042">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _getBlockerCount &gt; returns 0 when no blockers" time="0.000021166">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _getBlockerCount &gt; counts blockers from PMO health snapshot" time="0.000023125">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _getBlockerCount &gt; counts blockers from execution context" time="0.000022541">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="AIExplainabilityService &gt; Internal Helpers &gt; _getBlockerCount &gt; sums blockers from both sources" time="0.000023666">
        </testcase>
        <testcase classname="tests/unit/backend/aiExplainabilityService.test.js" name="Sample Output &gt; generates sample AIExplanation matching the spec" time="0.00049725">
            <system-out>

========== SAMPLE AIExplanation JSON ==========
{
  &quot;aiRole&quot;: &quot;ADVISOR&quot;,
  &quot;regulatoryMode&quot;: false,
  &quot;confidenceLevel&quot;: &quot;HIGH&quot;,
  &quot;reasoningSummary&quot;: &quot;Based on 3 overdue task(s), 1 pending decision(s), current phase: Execution, 5 project memory item(s) consulted&quot;,
  &quot;dataUsed&quot;: {
    &quot;projectData&quot;: true,
    &quot;projectMemoryCount&quot;: 5,
    &quot;externalSources&quot;: []
  },
  &quot;constraintsApplied&quot;: [
    &quot;AI Role: ADVISOR (explain/suggest only, no mutations)&quot;,
    &quot;AI Policy: ADVISORY mode&quot;,
    &quot;Phase Gate: Execution&quot;
  ],
  &quot;timestamp&quot;: &quot;2025-12-20T16:07:56.324Z&quot;
}
================================================


            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiExternalData.test.js" timestamp="2025-12-20T16:07:59.276Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.00131275">
        <testcase classname="tests/unit/backend/aiExternalData.test.js" name="AI External Data Control &gt; Internet Toggle &gt; should block external sources when internetEnabled is false" time="0.00039175">
        </testcase>
        <testcase classname="tests/unit/backend/aiExternalData.test.js" name="AI External Data Control &gt; Internet Toggle &gt; should allow external sources when internetEnabled is true" time="0.000089417">
        </testcase>
        <testcase classname="tests/unit/backend/aiExternalData.test.js" name="AI External Data Control &gt; Internet Toggle &gt; should respect project-level internet toggle" time="0.000056084">
        </testcase>
        <testcase classname="tests/unit/backend/aiExternalData.test.js" name="AI External Data Control &gt; RAG Toggle (GAP-03) &gt; should disable RAG when rag_enabled is 0" time="0.000048084">
        </testcase>
        <testcase classname="tests/unit/backend/aiExternalData.test.js" name="AI External Data Control &gt; RAG Toggle (GAP-03) &gt; should enable RAG by default" time="0.000046625">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiOrchestrator.test.js" timestamp="2025-12-20T16:07:59.277Z" hostname="MacBook-Pro-Piotr.local" tests="14" failures="2" errors="0" skipped="0" time="0.132760584">
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect EXPLAIN intent correctly" time="0.074570209">
            <system-out>
[Database] Selected: SQLite

[DB:9peq9] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

Projects table created successfully (or already exists).

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect GUIDE intent correctly" time="0.000486166">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect ANALYZE intent correctly" time="0.000266292">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect DO intent correctly" time="0.000518833">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should detect TEACH intent correctly" time="0.000362584">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _detectIntent &gt; should default to EXPLAIN for unclear intent" time="0.000235292">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _selectRole &gt; should force ADVISOR role if regulatory mode is enabled" time="0.000257041">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _selectRole &gt; should select PMO_MANAGER for GUIDE intent" time="0.000198291">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; _selectRole &gt; should fallback to ADVISOR if selected role is not active" time="0.000194708">
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; processMessage &gt; should process a message successfully" time="0.041108125">
            <system-out>
Database initialization complete.

            </system-out>
            <system-err>
[AIContextBuilder] Failed to get PMO health snapshot: Project not found

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; processMessage &gt; should include regulatory prompt when regulatory mode is enabled" time="0.005610458">
            <system-err>
[AIContextBuilder] Failed to get PMO health snapshot: Project not found

            </system-err>
            <failure message="expected &apos;\n=== REGULATORY COMPLIANCE MODE ACTI…&apos; to contain &apos;Regulatory Prompt&apos;" type="AssertionError">
AssertionError: expected &apos;\n=== REGULATORY COMPLIANCE MODE ACTI…&apos; to contain &apos;Regulatory Prompt&apos;

- Expected
+ Received

- Regulatory Prompt
+
+ === REGULATORY COMPLIANCE MODE ACTIVE ===
+
+ You are operating in STRICT COMPLIANCE MODE for a regulated organization.
+
+ ABSOLUTE PROHIBITIONS (NEVER DO THESE):
+ - Do NOT use action verbs like: create, execute, update, delete, assign, modify, change, add, remove, submit, approve, reject, complete, start, finish
+ - Do NOT propose or suggest any executable actions
+ - Do NOT generate drafts, tasks, initiatives, or any data objects
+ - Do NOT offer to make changes to the system
+ - Do NOT use phrases like &quot;I will create...&quot;, &quot;Let me update...&quot;, &quot;I can execute...&quot;
+
+ REQUIRED BEHAVIOR:
+ - Use ONLY advisory language: &quot;consider&quot;, &quot;you may want to&quot;, &quot;we recommend evaluating&quot;, &quot;it would be advisable to&quot;
+ - Focus EXCLUSIVELY on: explanations, risk descriptions, educational content, context analysis
+ - Always clarify that the USER must take any action themselves
+ - When asked to do something, explain what SHOULD be done, not offer to do it
+
+ EXAMPLE RESPONSES:
+ ❌ WRONG: &quot;I&apos;ll create a task for this.&quot;
+ ✅ CORRECT: &quot;You may want to consider creating a task for this. The task should include...&quot;
+
+ ❌ WRONG: &quot;Let me update the status.&quot;
+ ✅ CORRECT: &quot;It would be advisable to update the status to reflect the current state.&quot;
+
+ This is a legal and compliance requirement. Violations may result in regulatory penalties.
+ === END REGULATORY MODE ===
+
+
+ You are an AI ADVISOR for an Enterprise Strategic Change Management System (SCMS).
+
+ CURRENT CONTEXT:
+ - User Role: USER
+ - Organization: Unknown
+ - Active Projects: 0
+ - Current Project: undefined
+ - Current Phase: Context (Phase 1/6)
+ - Initiatives: null/0 completed
+
+ YOUR ROLE: ADVISOR
+ Provide clear explanations and context. Be helpful but factual.
+
+ COMMUNICATION STYLE: EXPERT
+
+
+ RULES:
+ 1. Always reference the context you&apos;re using
+ 2. Never invent data - only use provided context
+ 3. Be transparent about uncertainty
+ 4. Respect governance boundaries
+ 5. State &quot;Based on: ...&quot; before significant statements
+
+ AI GOVERNANCE - ADVISOR MODE:
+ ⚠️ STRICT CONSTRAINTS:
+ - You MAY: explain, summarize, suggest, warn, analyze
+ - You MAY NOT: create, modify, delete, or change any data
+ - Output style: descriptive, educational, neutral
+ - Never propose action execution, only explain options
+ - If user asks to create/modify something, explain how they can do it themselves
+
+ USER MESSAGE: Execute this

 ❯ tests/unit/backend/aiOrchestrator.test.js:158:35
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; processMessage &gt; should handle context building errors gracefully" time="0.004673792">
            <system-err>
[AIContextBuilder] Failed to get PMO health snapshot: Project not found

            </system-err>
            <failure message="promise resolved &quot;{ responseContext: { …(11) }, …(6) }&quot; instead of rejecting" type="AssertionError">
AssertionError: promise resolved &quot;{ responseContext: { …(11) }, …(6) }&quot; instead of rejecting

- Expected
+ Received

- Error {
-   &quot;message&quot;: &quot;rejected promise&quot;,
+ {
+   &quot;contextSummary&quot;: &quot;Role: USER | Org: Unknown | Project: undefined (Context) | Tasks: 0 | Decisions: 0&quot;,
+   &quot;explanation&quot;: {
+     &quot;aiRole&quot;: &quot;ADVISOR&quot;,
+     &quot;confidenceLevel&quot;: &quot;MEDIUM&quot;,
+     &quot;constraintsApplied&quot;: [
+       &quot;AI Role: ADVISOR (explain/suggest only, no mutations)&quot;,
+       &quot;AI Policy: ADVISORY mode&quot;,
+     ],
+     &quot;dataUsed&quot;: {
+       &quot;externalSources&quot;: [],
+       &quot;projectData&quot;: true,
+       &quot;projectMemoryCount&quot;: 0,
+     },
+     &quot;reasoningSummary&quot;: &quot;Based on available project context&quot;,
+     &quot;regulatoryMode&quot;: false,
+     &quot;timestamp&quot;: &quot;2025-12-20T16:07:54.323Z&quot;,
+   },
+   &quot;intent&quot;: &quot;EXPLAIN&quot;,
+   &quot;policyAllows&quot;: true,
+   &quot;prompt&quot;: &quot;
+ === REGULATORY COMPLIANCE MODE ACTIVE ===
+
+ You are operating in STRICT COMPLIANCE MODE for a regulated organization.
+
+ ABSOLUTE PROHIBITIONS (NEVER DO THESE):
+ - Do NOT use action verbs like: create, execute, update, delete, assign, modify, change, add, remove, submit, approve, reject, complete, start, finish
+ - Do NOT propose or suggest any executable actions
+ - Do NOT generate drafts, tasks, initiatives, or any data objects
+ - Do NOT offer to make changes to the system
+ - Do NOT use phrases like \&quot;I will create...\&quot;, \&quot;Let me update...\&quot;, \&quot;I can execute...\&quot;
+
+ REQUIRED BEHAVIOR:
+ - Use ONLY advisory language: \&quot;consider\&quot;, \&quot;you may want to\&quot;, \&quot;we recommend evaluating\&quot;, \&quot;it would be advisable to\&quot;
+ - Focus EXCLUSIVELY on: explanations, risk descriptions, educational content, context analysis
+ - Always clarify that the USER must take any action themselves
+ - When asked to do something, explain what SHOULD be done, not offer to do it
+
+ EXAMPLE RESPONSES:
+ ❌ WRONG: \&quot;I&apos;ll create a task for this.\&quot;
+ ✅ CORRECT: \&quot;You may want to consider creating a task for this. The task should include...\&quot;
+
+ ❌ WRONG: \&quot;Let me update the status.\&quot;
+ ✅ CORRECT: \&quot;It would be advisable to update the status to reflect the current state.\&quot;
+
+ This is a legal and compliance requirement. Violations may result in regulatory penalties.
+ === END REGULATORY MODE ===
+
+
+ You are an AI ADVISOR for an Enterprise Strategic Change Management System (SCMS).
+
+ CURRENT CONTEXT:
+ - User Role: USER
+ - Organization: Unknown
+ - Active Projects: 0
+ - Current Project: undefined
+ - Current Phase: Context (Phase 1/6)
+ - Initiatives: null/0 completed
+
+ YOUR ROLE: ADVISOR
+ Provide clear explanations and context. Be helpful but factual.
+
+ COMMUNICATION STYLE: EXPERT
+
+
+ RULES:
+ 1. Always reference the context you&apos;re using
+ 2. Never invent data - only use provided context
+ 3. Be transparent about uncertainty
+ 4. Respect governance boundaries
+ 5. State \&quot;Based on: ...\&quot; before significant statements
+
+ AI GOVERNANCE - ADVISOR MODE:
+ ⚠️ STRICT CONSTRAINTS:
+ - You MAY: explain, summarize, suggest, warn, analyze
+ - You MAY NOT: create, modify, delete, or change any data
+ - Output style: descriptive, educational, neutral
+ - Never propose action execution, only explain options
+ - If user asks to create/modify something, explain how they can do it themselves
+
+ USER MESSAGE: msg&quot;,
+   &quot;responseContext&quot;: {
+     &quot;aiGovernance&quot;: {
+       &quot;activeRole&quot;: &quot;ADVISOR&quot;,
+       &quot;capabilities&quot;: {
+         &quot;canAnalyze&quot;: true,
+         &quot;canCreateDrafts&quot;: false,
+         &quot;canExecuteActions&quot;: false,
+         &quot;canExplain&quot;: true,
+         &quot;canModifyEntities&quot;: false,
+         &quot;canSuggest&quot;: true,
+         &quot;requiresApproval&quot;: false,
+       },
+       &quot;roleDescription&quot;: &quot;AI explains, suggests, and warns. Cannot modify any data.&quot;,
+     },
+     &quot;confidenceLevel&quot;: &quot;MEDIUM&quot;,
+     &quot;context&quot;: {
+       &quot;builtAt&quot;: &quot;2025-12-20T16:07:54.322Z&quot;,
+       &quot;contextHash&quot;: &quot;by1vLXAtMTc2NjI0&quot;,
+       &quot;currentScreen&quot;: null,
+       &quot;execution&quot;: {
+         &quot;blockers&quot;: [],
+         &quot;capacityStatus&quot;: &quot;HEALTHY&quot;,
+         &quot;pendingDecisions&quot;: [],
+         &quot;userId&quot;: &quot;u&quot;,
+         &quot;userInitiatives&quot;: [],
+         &quot;userTasks&quot;: [],
+       },
+       &quot;external&quot;: {
+         &quot;externalSourcesUsed&quot;: [],
+         &quot;internetEnabled&quot;: false,
+       },
+       &quot;knowledge&quot;: {
+         &quot;changeRequests&quot;: [],
+         &quot;lessonsLearned&quot;: [],
+         &quot;phaseHistory&quot;: [],
+         &quot;previousDecisions&quot;: [],
+         &quot;projectDocuments&quot;: [],
+       },
+       &quot;organization&quot;: {
+         &quot;activeProjectCount&quot;: 0,
+         &quot;activeProjectIds&quot;: [],
+         &quot;locations&quot;: [],
+         &quot;organizationId&quot;: &quot;o&quot;,
+         &quot;organizationName&quot;: &quot;Unknown&quot;,
+         &quot;pmoMaturityLevel&quot;: &quot;BASIC&quot;,
+       },
+       &quot;platform&quot;: {
+         &quot;globalPolicies&quot;: {
+           &quot;auditRequired&quot;: true,
+           &quot;internetEnabled&quot;: false,
+           &quot;maxPolicyLevel&quot;: &quot;ASSISTED&quot;,
+         },
+         &quot;policyLevel&quot;: &quot;ADVISORY&quot;,
+         &quot;role&quot;: &quot;USER&quot;,
+         &quot;tenantId&quot;: &quot;o&quot;,
+         &quot;userId&quot;: &quot;u&quot;,
+       },
+       &quot;pmo&quot;: {
+         &quot;healthSnapshot&quot;: null,
+       },
+       &quot;project&quot;: {
+         &quot;completedInitiatives&quot;: null,
+         &quot;currentPhase&quot;: &quot;Context&quot;,
+         &quot;governanceRules&quot;: {
+           &quot;aiPolicyOverride&quot;: null,
+           &quot;requireApprovalForPhaseTransition&quot;: false,
+           &quot;stageGatesEnabled&quot;: false,
+         },
+         &quot;initiativeCount&quot;: 0,
+         &quot;phaseNumber&quot;: 1,
+         &quot;projectId&quot;: &quot;p&quot;,
+         &quot;projectManagerId&quot;: undefined,
+         &quot;projectName&quot;: undefined,
+         &quot;roadmapStatus&quot;: undefined,
+         &quot;sponsorId&quot;: undefined,
+       },
+       &quot;selectedObjectId&quot;: null,
+       &quot;selectedObjectType&quot;: null,
+     },
+     &quot;dataSources&quot;: [
+       &quot;Platform Configuration&quot;,
+       &quot;Organization Data&quot;,
+       &quot;Project Data&quot;,
+       &quot;Phase: Context&quot;,
+     ],
+     &quot;explanation&quot;: {
+       &quot;aiRole&quot;: &quot;ADVISOR&quot;,
+       &quot;confidenceLevel&quot;: &quot;MEDIUM&quot;,
+       &quot;constraintsApplied&quot;: [
+         &quot;AI Role: ADVISOR (explain/suggest only, no mutations)&quot;,
+         &quot;AI Policy: ADVISORY mode&quot;,
+       ],
+       &quot;dataUsed&quot;: {
+         &quot;externalSources&quot;: [],
+         &quot;projectData&quot;: true,
+         &quot;projectMemoryCount&quot;: 0,
+       },
+       &quot;reasoningSummary&quot;: &quot;Based on available project context&quot;,
+       &quot;regulatoryMode&quot;: false,
+       &quot;timestamp&quot;: &quot;2025-12-20T16:07:54.323Z&quot;,
+     },
+     &quot;id&quot;: &quot;a6359d81-9ec1-4d92-866b-4c3610ee5dab&quot;,
+     &quot;intent&quot;: &quot;EXPLAIN&quot;,
+     &quot;policy&quot;: {
+       &quot;activeRoles&quot;: [
+         &quot;ADVISOR&quot;,
+       ],
+       &quot;auditRequired&quot;: true,
+       &quot;defaultRole&quot;: &quot;ADVISOR&quot;,
+       &quot;educationMode&quot;: false,
+       &quot;internetEnabled&quot;: false,
+       &quot;maxPolicyLevel&quot;: &quot;ADVISORY&quot;,
+       &quot;policyLevel&quot;: &quot;ADVISORY&quot;,
+       &quot;projectAIRole&quot;: &quot;ADVISOR&quot;,
+       &quot;regulatoryModeEnabled&quot;: true,
+       &quot;regulatoryModePrompt&quot;: &quot;
+ === REGULATORY COMPLIANCE MODE ACTIVE ===
+
+ You are operating in STRICT COMPLIANCE MODE for a regulated organization.
+
+ ABSOLUTE PROHIBITIONS (NEVER DO THESE):
+ - Do NOT use action verbs like: create, execute, update, delete, assign, modify, change, add, remove, submit, approve, reject, complete, start, finish
+ - Do NOT propose or suggest any executable actions
+ - Do NOT generate drafts, tasks, initiatives, or any data objects
+ - Do NOT offer to make changes to the system
+ - Do NOT use phrases like \&quot;I will create...\&quot;, \&quot;Let me update...\&quot;, \&quot;I can execute...\&quot;
+
+ REQUIRED BEHAVIOR:
+ - Use ONLY advisory language: \&quot;consider\&quot;, \&quot;you may want to\&quot;, \&quot;we recommend evaluating\&quot;, \&quot;it would be advisable to\&quot;
+ - Focus EXCLUSIVELY on: explanations, risk descriptions, educational content, context analysis
+ - Always clarify that the USER must take any action themselves
+ - When asked to do something, explain what SHOULD be done, not offer to do it
+
+ EXAMPLE RESPONSES:
+ ❌ WRONG: \&quot;I&apos;ll create a task for this.\&quot;
+ ✅ CORRECT: \&quot;You may want to consider creating a task for this. The task should include...\&quot;
+
+ ❌ WRONG: \&quot;Let me update the status.\&quot;
+ ✅ CORRECT: \&quot;It would be advisable to update the status to reflect the current state.\&quot;
+
+ This is a legal and compliance requirement. Violations may result in regulatory penalties.
+ === END REGULATORY MODE ===
+ &quot;,
+       &quot;roleCapabilities&quot;: {
+         &quot;canCreateDrafts&quot;: false,
+         &quot;canExecute&quot;: false,
+         &quot;canExplain&quot;: true,
+         &quot;canModify&quot;: false,
+       },
+       &quot;roleDescription&quot;: &quot;Regulatory Mode: Advisory-only&quot;,
+       &quot;userTone&quot;: &quot;EXPERT&quot;,
+     },
+     &quot;preferences&quot;: {
+       &quot;education_mode&quot;: 0,
+       &quot;preferred_language&quot;: &quot;en&quot;,
+       &quot;preferred_tone&quot;: &quot;EXPERT&quot;,
+       &quot;proactive_notifications&quot;: 1,
+       &quot;user_id&quot;: &quot;u&quot;,
+     },
+     &quot;projectMemory&quot;: {
+       &quot;aiRecommendations&quot;: [],
+       &quot;majorDecisions&quot;: [],
+       &quot;memoryCount&quot;: 0,
+       &quot;phaseTransitions&quot;: [],
+       &quot;projectId&quot;: &quot;p&quot;,
+     },
+     &quot;role&quot;: &quot;ADVISOR&quot;,
+   },
+   &quot;role&quot;: &quot;ADVISOR&quot;,
  }

 ❯ tests/unit/backend/aiOrchestrator.test.js:163:78
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; processMessage &gt; should default to ADVISOR if role selection returns null" time="0.002125459">
            <system-err>
[AIContextBuilder] Failed to get PMO health snapshot: Project not found

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiOrchestrator.test.js" name="AIOrchestrator &gt; processMessage &gt; should handle missing project ID (General Chat)" time="0.001295458">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/aiService.test.js" timestamp="2025-12-20T16:07:59.278Z" hostname="MacBook-Pro-Piotr.local" tests="36" failures="0" errors="0" skipped="4" time="0.071515083">
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; callLLM &gt; should use Google Gemini by default if checks pass" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; callLLM &gt; should block if balance is insufficient" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; callLLM &gt; should call OpenAI via fetch when provider is openai" time="0.001752125">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; callLLM &gt; should call Anthropic via fetch when provider is anthropic" time="0.000168458">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; generateInitiatives &gt; should parse JSON response correctly" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; generateInitiatives &gt; should return empty array on JSON parse error" time="0.006836417">
            <system-err>
LLM Call Error Error: AI Provider not configured.
    at Object.callLLM [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mserver/services/aiService.js:172:41[90m)[39m
    at Object.generateInitiatives [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mserver/services/aiService.js:655:29[90m)[39m
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/backend/aiService.test.js:213:33
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; streamLLM &gt; should yield chunks from Gemini stream" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; streamLLM &gt; should handle errors in stream" time="0.055066291">
            <system-out>
Projects table created successfully (or already exists).

Database initialization complete.

            </system-out>
            <system-err>
Stream LLM Error Error: AI Provider not configured.
    at Object.streamLLM [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mserver/services/aiService.js:398:41[90m)[39m
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/backend/aiService.test.js:241:30
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; buildRoadmap &gt; should return roadmap object on success" time="0.00035925">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; buildRoadmap &gt; should return empty object on error" time="0.000133541">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; suggestTasks &gt; should return tasks array on success" time="0.000360292">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; deepDiagnose &gt; should execute chain of thought and return diagnosis" time="0.000186708">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; enrichInitiative &gt; should maintain structure and fallback to LLM" time="0.00028675">
            <system-err>
Web Search failed, using LLM knowledge Error: Web Fail
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/backend/aiService.test.js:311:59
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; generateObservations &gt; should return observations from feedback" time="0.00022525">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Generation Methods &gt; testProviderConnection &gt; should test OpenAI connection" time="0.000224291">
            <system-out>
[AiService] Testing connection for: openai

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; enhancePrompt &gt; should return base system role when no extras found" time="0.000067292">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; enhancePrompt &gt; should inject global strategies" time="0.000065167">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; enhancePrompt &gt; should inject client context when orgId provided" time="0.000152125">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Queue Operations &gt; should enqueue task and return jobId" time="0.000218084">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Queue Operations &gt; should get job status" time="0.000074584">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Queue Operations &gt; should return null for non-existent job" time="0.000042083">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Vision Capabilities &gt; should format payload correctly for OpenAI Vision" time="0.00014075">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Vision Capabilities &gt; should use Gemini 1.5 Flash for vision fallback" time="0.000507208">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Advanced Streaming &gt; should parse OpenAI SSE stream correctly" time="0.000223167">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Advanced Streaming &gt; should handle OpenAI stream error" time="0.000531333">
            <system-err>
Stream LLM Error Error: Stream Error
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/backend/aiService.test.js:237:69
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="AIService Unit Tests &gt; Provider Integrations &gt; should generate JWT for Zhipu AI provider" time="0.001469542">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateTaskInsight &gt; should return parsed insights when LLM returns valid JSON" time="0.000263833">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateTaskInsight &gt; should return fallback object on LLM failure/JSON error" time="0.00024725">
            <system-err>
Task Insight Error Error: LLM Fail
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/backend/aiService.test.js:630:42
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateExecutionStrategy &gt; should return strategy object on success" time="0.000124208">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateExecutionStrategy &gt; should return empty structure on error" time="0.0001595">
            <system-err>
Execution Gen Error SyntaxError: Unexpected token &apos;N&apos;, &quot;Not JSON&quot; is not valid JSON
    at JSON.parse (&lt;anonymous&gt;)
    at Object.generateExecutionStrategy [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mserver/services/aiService.js:802:25[90m)[39m
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/backend/aiService.test.js:658:28
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateInsights (Pre-Mortem) &gt; should return insights on success" time="0.00008625">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateInsights (Pre-Mortem) &gt; should return fallback on error" time="0.000177167">
            <system-err>
Insights Gen Error Error: Fail
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/backend/aiService.test.js:679:42
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateStrategicFit &gt; should return fit analysis on success" time="0.000082333">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; generateStrategicFit &gt; should return fallback on error" time="0.000113167">
            <system-err>
Fit Check Error SyntaxError: Unexpected token &apos;B&apos;, &quot;Bad JSON&quot; is not valid JSON
    at JSON.parse (&lt;anonymous&gt;)
    at Object.generateStrategicFit [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mserver/services/aiService.js:864:25[90m)[39m
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/backend/aiService.test.js:704:28
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:20

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; simulateEconomics &gt; should combine financial simulation with AI commentary" time="0.000094">
        </testcase>
        <testcase classname="tests/unit/backend/aiService.test.js" name="Extended AI Capabilities &gt; simulateEconomics &gt; should return just simulation if AI fails" time="0.000057083">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/analyticsService.test.js" timestamp="2025-12-20T16:07:59.280Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.102551958">
        <testcase classname="tests/unit/backend/analyticsService.test.js" name="AnalyticsService - Integration &gt; logUsage &gt; should log AI usage to the database without errors" time="0.000704375">
        </testcase>
        <testcase classname="tests/unit/backend/analyticsService.test.js" name="AnalyticsService - Integration &gt; getStats &gt; should retrieve aggregated stats from real database" time="0.000333084">
        </testcase>
        <testcase classname="tests/unit/backend/analyticsService.test.js" name="AnalyticsService - Integration &gt; getTopTopics &gt; should retrieve top topics from real database" time="0.000233125">
        </testcase>
        <testcase classname="tests/unit/backend/analyticsService.test.js" name="AnalyticsService - Integration &gt; saveMaturityScore &gt; should save maturity score without errors" time="0.000145125">
        </testcase>
        <testcase classname="tests/unit/backend/analyticsService.test.js" name="AnalyticsService - Integration &gt; getIndustryBenchmarks &gt; should retrieve industry benchmarks from real database" time="0.000246375">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/billingService.test.js" timestamp="2025-12-20T16:07:59.280Z" hostname="MacBook-Pro-Piotr.local" tests="4" failures="0" errors="0" skipped="0" time="0.095161042">
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService (Unit) &gt; getPlans &gt; should return all available plans from database" time="0.001510167">
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService (Unit) &gt; getPlans &gt; should handle database errors gracefully" time="0.000161792">
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService (Unit) &gt; createPlan &gt; should create a new plan successfully" time="0.000203709">
        </testcase>
        <testcase classname="tests/unit/backend/billingService.test.js" name="BillingService (Unit) &gt; getOrganizationBilling &gt; should return billing info from database" time="0.0002385">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/criticalPathService.test.js" timestamp="2025-12-20T16:07:59.281Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="1" errors="0" skipped="0" time="0.047124583">
        <testcase classname="tests/unit/backend/criticalPathService.test.js" name="CriticalPathService &gt; calculateCriticalPath &gt; should calculate path" time="0.019531583">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/criticalPathService.test.js" name="CriticalPathService &gt; detectSchedulingConflicts &gt; should detect conflicts" time="0.026611292">
            <system-out>
[DB:iiotk] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

            </system-out>
            <failure message="SQLITE_ERROR: no such table: initiative_dependencies" type="Error">
Error: SQLITE_ERROR: no such table: initiative_dependencies
 ❯ server/services/dependencyService.js:76:16
 ❯ Object.buildDependencyGraph server/services/dependencyService.js:65:16
 ❯ Object.detectSchedulingConflicts server/services/criticalPathService.js:135:46
 ❯ tests/unit/backend/criticalPathService.test.js:47:54

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { errno: 1, code: &apos;SQLITE_ERROR&apos;, __augmented: true }
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/dependencyService.test.js" timestamp="2025-12-20T16:07:59.281Z" hostname="MacBook-Pro-Piotr.local" tests="4" failures="1" errors="0" skipped="0" time="5.028862959">
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; addDependency &gt; should prevent self-dependency" time="5.025202959">
            <system-out>
[Database] Selected: SQLite

[DB:9xy7ot] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

Projects table created successfully (or already exists).

Database initialization complete.

            </system-out>
            <failure message="Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with &quot;testTimeout&quot;." type="Error">
Error: Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with &quot;testTimeout&quot;.
 ❯ tests/unit/backend/dependencyService.test.js:20:11
            </failure>
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; addDependency &gt; should insert dependency correctly" time="0.001103958">
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; buildDependencyGraph &gt; should return graph" time="0.000980541">
        </testcase>
        <testcase classname="tests/unit/backend/dependencyService.test.js" name="DependencyService &gt; detectDeadlocks &gt; should detect cycles" time="0.000674083">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/emailService.test.js" timestamp="2025-12-20T16:07:59.282Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.118034625">
        <testcase classname="tests/unit/backend/emailService.test.js" name="Backend Service Test: EmailService &gt; sendEmail &gt; sends email with default config" time="0.002078334">
        </testcase>
        <testcase classname="tests/unit/backend/emailService.test.js" name="Backend Service Test: EmailService &gt; sendEmail &gt; uses SMTP settings from database" time="0.051612416">
        </testcase>
        <testcase classname="tests/unit/backend/emailService.test.js" name="Backend Service Test: EmailService &gt; sendEmail &gt; handles database errors gracefully" time="0.000548667">
        </testcase>
        <testcase classname="tests/unit/backend/emailService.test.js" name="Backend Service Test: EmailService &gt; sendEmail &gt; logs email details" time="0.000689417">
        </testcase>
        <testcase classname="tests/unit/backend/emailService.test.js" name="Backend Service Test: EmailService &gt; sendEmail &gt; uses environment variables when database settings are missing" time="0.001035833">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/feedbackService.test.js" timestamp="2025-12-20T16:07:59.282Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.626774167">
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; saveFeedback &gt; saves feedback with all parameters" time="0.104615542">
        </testcase>
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; saveFeedback &gt; saves feedback without correction" time="0.102256666">
        </testcase>
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; getLearningExamples &gt; retrieves learning examples for context" time="0.11199875">
        </testcase>
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; getLearningExamples &gt; handles empty results" time="0.001085208">
        </testcase>
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; getLearningExamples &gt; handles database errors gracefully" time="0.000605459">
        </testcase>
        <testcase classname="tests/unit/backend/feedbackService.test.js" name="Backend Service Test: FeedbackService &gt; getLearningExamples &gt; only returns examples with rating &gt;= 4" time="0.10231775">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/financialService.test.js" timestamp="2025-12-20T16:07:59.282Z" hostname="MacBook-Pro-Piotr.local" tests="10" failures="0" errors="0" skipped="0" time="0.002854791">
        <testcase classname="tests/unit/backend/financialService.test.js" name="Backend Service Test: FinancialService &gt; estimateCost &gt; returns correct cost for High complexity" time="0.0007255">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="Backend Service Test: FinancialService &gt; estimateCost &gt; returns correct cost for Medium complexity" time="0.00007725">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="Backend Service Test: FinancialService &gt; estimateCost &gt; returns correct cost for Low complexity" time="0.000058625">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="Backend Service Test: FinancialService &gt; estimateBenefit &gt; calculates benefit for High priority" time="0.000076958">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="Backend Service Test: FinancialService &gt; estimateBenefit &gt; calculates benefit for Medium priority" time="0.000067166">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="Backend Service Test: FinancialService &gt; estimateBenefit &gt; calculates benefit for Low priority" time="0.000048625">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="Backend Service Test: FinancialService &gt; estimateBenefit &gt; returns High benefit range for large benefits" time="0.000038958">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="Backend Service Test: FinancialService &gt; simulatePortfolio &gt; calculates portfolio economics correctly" time="0.000461167">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="Backend Service Test: FinancialService &gt; simulatePortfolio &gt; handles empty portfolio" time="0.000116334">
        </testcase>
        <testcase classname="tests/unit/backend/financialService.test.js" name="Backend Service Test: FinancialService &gt; simulatePortfolio &gt; uses custom revenue base" time="0.000058208">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/knowledgeService.test.js" timestamp="2025-12-20T16:07:59.283Z" hostname="MacBook-Pro-Piotr.local" tests="11" failures="0" errors="0" skipped="0" time="0.122168542">
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Candidate Management &gt; should add a candidate idea without throwing" time="0.001109125">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Candidate Management &gt; should get candidates without throwing" time="0.0005825">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Strategies &gt; should add a global strategy without throwing" time="0.000288792">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Strategies &gt; should get active strategies without throwing" time="0.000172708">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Client Context &gt; should set and get client context" time="0.000828083">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Client Context &gt; should update existing client context" time="0.000630458">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Candidate Status &gt; should update candidate status" time="0.000459667">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Process Document (RAG) &gt; should process document chunks" time="0.01323125">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Access Control &gt; should restrict user access to project docs" time="0.001206333">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Strategies Toggle &gt; should toggle strategy active status" time="0.00091475">
        </testcase>
        <testcase classname="tests/unit/backend/knowledgeService.test.js" name="KnowledgeService - Integration &gt; Document Lifecycle &gt; should soft delete document" time="0.001559584">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/myWorkService.test.js" timestamp="2025-12-20T16:07:59.283Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="0" errors="0" skipped="0" time="0.026015458">
        <testcase classname="tests/unit/backend/myWorkService.test.js" name="MyWorkService &gt; getMyWork &gt; should aggregate work" time="0.024732375">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/myWorkService.test.js" name="MyWorkService &gt; errors &gt; should propagate db error" time="0.000757083">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/pmoDomainRegistry.test.js" timestamp="2025-12-20T16:07:59.283Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="1" errors="0" skipped="0" time="0.033723958">
        <testcase classname="tests/unit/backend/pmoDomainRegistry.test.js" name="PMODomainRegistry &gt; getAllDomains &gt; should return domains" time="0.027845125">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/pmoDomainRegistry.test.js" name="PMODomainRegistry &gt; getDomain &gt; should return domain" time="0.005243458">
            <failure message="Unknown PMO domain: d1" type="Error">
Error: Unknown PMO domain: d1
 ❯ server/services/pmoDomainRegistry.js:195:24
 ❯ Object.getDomain server/services/pmoDomainRegistry.js:192:16
 ❯ tests/unit/backend/pmoDomainRegistry.test.js:30:49
            </failure>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/pmoHealthService.test.js" timestamp="2025-12-20T16:07:59.284Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="0" errors="0" skipped="0" time="0.056519792">
        <testcase classname="tests/unit/backend/pmoHealthService.test.js" name="PMOHealthService &gt; getHealthSnapshot &gt; should return complete snapshot" time="0.053789375">
            <system-out>
[Database] Selected: SQLite

[DB:kmtck4] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

[PMOHealthService] Snapshot generated in 0ms for project proj1

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/pmoHealthService.test.js" name="PMOHealthService &gt; getHealthSnapshot &gt; should handle DB errors" time="0.002167834">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/pmoStandardsMapping.test.js" timestamp="2025-12-20T16:07:59.284Z" hostname="MacBook-Pro-Piotr.local" tests="7" failures="0" errors="0" skipped="0" time="0.048939791">
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; getMapping &gt; should return mapping for known concept" time="0.046404209">
            <system-out>
[Database] Selected: SQLite

[DB:k6gkad] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; getMapping &gt; should return null for unknown concept" time="0.000409042">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; getStandardTerm &gt; should return ISO 21500 term correctly" time="0.000377959">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; getStandardTerm &gt; should return PMBOK 7 term correctly" time="0.000333666">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; isNeutralTerm &gt; should identify neutral terms" time="0.000285167">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; isNeutralTerm &gt; should identify vendor-specific terms as non-neutral" time="0.000211292">
        </testcase>
        <testcase classname="tests/unit/backend/pmoStandardsMapping.test.js" name="PMOStandardsMapping &gt; getConceptsByDomain &gt; should return all concepts for a given domain" time="0.000259166">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/ragService.test.js" timestamp="2025-12-20T16:07:59.284Z" hostname="MacBook-Pro-Piotr.local" tests="5" failures="0" errors="0" skipped="0" time="0.126389208">
        <testcase classname="tests/unit/backend/ragService.test.js" name="RagService - Integration &gt; generateEmbedding &gt; should return null if no provider configured in database" time="0.033738">
            <system-out>
[DB:54z10p] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/ragService.test.js" name="RagService - Integration &gt; getContext &gt; should return context string without throwing" time="0.060042708">
            <system-out>
Projects table created successfully (or already exists).

Database initialization complete.

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/ragService.test.js" name="RagService - Integration &gt; getContext &gt; should accept limit parameter" time="0.00027175">
        </testcase>
        <testcase classname="tests/unit/backend/ragService.test.js" name="RagService - Integration &gt; getContextKeyword &gt; should perform keyword search without throwing" time="0.000134041">
        </testcase>
        <testcase classname="tests/unit/backend/ragService.test.js" name="RagService - Integration &gt; getAxisDefinitions &gt; should retrieve axis definitions without throwing" time="0.000318791">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/scmsGovernance.test.js" timestamp="2025-12-20T16:07:59.284Z" hostname="MacBook-Pro-Piotr.local" tests="17" failures="0" errors="0" skipped="0" time="0.005472917">
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should allow DRAFT to PLANNED transition" time="0.003693292">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should allow PLANNED to APPROVED transition" time="0.000124084">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should allow APPROVED to IN_EXECUTION transition" time="0.000078583">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should allow IN_EXECUTION to BLOCKED transition" time="0.000096584">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should allow IN_EXECUTION to COMPLETED transition" time="0.00008325">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should disallow COMPLETED to DRAFT transition" time="0.000059875">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Initiative Status Transitions &gt; should disallow invalid status transition" time="0.0000475">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Task Status Transitions &gt; should allow TODO to IN_PROGRESS transition" time="0.000062541">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Task Status Transitions &gt; should allow IN_PROGRESS to DONE transition" time="0.000058334">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Task Status Transitions &gt; should allow IN_PROGRESS to BLOCKED transition" time="0.000071">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Task Status Transitions &gt; should allow BLOCKED to IN_PROGRESS transition" time="0.000049458">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Task Status Transitions &gt; should disallow direct DONE to TODO transition" time="0.000043083">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Blocked Status Validation &gt; should require blocked reason for BLOCKED initiative status" time="0.000126375">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Blocked Status Validation &gt; should accept blocked reason for BLOCKED status" time="0.000054708">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Status Constants &gt; should export INITIATIVE_STATUSES" time="0.00005125">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Status Constants &gt; should export TASK_STATUSES" time="0.000036459">
        </testcase>
        <testcase classname="tests/unit/backend/scmsGovernance.test.js" name="StatusMachine &gt; Status Constants &gt; should export DECISION_STATUSES" time="0.000037917">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/scmsLifecycle.test.js" timestamp="2025-12-20T16:07:59.285Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="0" errors="0" skipped="0" time="0.024471834">
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Types &gt; should define READINESS_GATE" time="0.022211584">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Types &gt; should define DESIGN_GATE" time="0.000130375">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Types &gt; should define PLANNING_GATE" time="0.000080458">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Types &gt; should define EXECUTION_GATE" time="0.000095541">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Types &gt; should define CLOSURE_GATE" time="0.000082625">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Service Structure &gt; should export getGateType function" time="0.000060916">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Service Structure &gt; should export evaluateGate function" time="0.000045416">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Service Structure &gt; should export passGate function" time="0.000042375">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Mapping &gt; should map Context to Assessment with READINESS_GATE" time="0.000068">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Mapping &gt; should map Roadmap to Execution with EXECUTION_GATE" time="0.000066417">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Mapping &gt; should map Assessment to Initiatives with DESIGN_GATE" time="0.000050167">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Mapping &gt; should map Initiatives to Roadmap with PLANNING_GATE" time="0.000041541">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="StageGateService &gt; Gate Mapping &gt; should map Execution to Stabilization with CLOSURE_GATE" time="0.000038416">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="Phase Constants &gt; should have 6 phases in SCMS lifecycle" time="0.000334959">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="Phase Constants &gt; should have Context as first phase" time="0.000035834">
        </testcase>
        <testcase classname="tests/unit/backend/scmsLifecycle.test.js" name="Phase Constants &gt; should have Stabilization as last phase" time="0.000025625">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/scmsServices.test.js" timestamp="2025-12-20T16:07:59.286Z" hostname="MacBook-Pro-Piotr.local" tests="39" failures="0" errors="0" skipped="0" time="0.0961665">
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; NOTIFICATION_TYPES &gt; should have notification types defined" time="0.025350833">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; NOTIFICATION_TYPES &gt; should include TASK_ASSIGNED type" time="0.000152458">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; NOTIFICATION_TYPES &gt; should include DECISION_REQUIRED type" time="0.000077417">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; NOTIFICATION_TYPES &gt; should include AI_RISK_DETECTED type" time="0.000089416">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; SEVERITY &gt; should define INFO severity" time="0.000084417">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; SEVERITY &gt; should define WARNING severity" time="0.000058542">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NotificationService &gt; SEVERITY &gt; should define CRITICAL severity" time="0.000046291">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="MyWorkService &gt; Service Structure &gt; should export getMyWork function" time="0.0243115">
            <system-out>
[DB:yncbff] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="MyWorkService &gt; Service Structure &gt; should export _getMyTasks helper function" time="0.000076541">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="MyWorkService &gt; Service Structure &gt; should export _getMyAlerts helper function" time="0.0000635">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="ExecutionMonitorService &gt; Service Structure &gt; should export runDailyMonitor function" time="0.0109095">
            <system-out>
Projects table created successfully (or already exists).

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="ExecutionMonitorService &gt; Service Structure &gt; should export generateExecutionSummary function" time="0.000066584">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EscalationService &gt; Service Structure &gt; should export createEscalation function" time="0.004098334">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EscalationService &gt; Service Structure &gt; should export getEscalations function" time="0.000056625">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EscalationService &gt; Service Structure &gt; should export acknowledgeEscalation function" time="0.00003275">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EscalationService &gt; Service Structure &gt; should export resolveEscalation function" time="0.00003325">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EscalationService &gt; Service Structure &gt; should export runAutoEscalation function" time="0.000027416">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; STABILIZATION_STATUSES &gt; should define STABILIZED status" time="0.010578084">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; STABILIZATION_STATUSES &gt; should define PARTIALLY_STABILIZED status" time="0.000118125">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; STABILIZATION_STATUSES &gt; should define UNSTABLE status" time="0.000072125">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; STABILIZATION_STATUSES &gt; should define NOT_APPLICABLE status" time="0.000065875">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; Service Structure &gt; should export checkEntryCriteria function" time="0.00011725">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; Service Structure &gt; should export checkExitCriteria function" time="0.000081666">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="StabilizationService &gt; Service Structure &gt; should export closeProject function" time="0.00123025">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should have 5 value types" time="0.007028959">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should define COST_REDUCTION type" time="0.000079">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should define REVENUE_INCREASE type" time="0.00004125">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should define RISK_REDUCTION type" time="0.000032042">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should define EFFICIENCY type" time="0.000027583">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; VALUE_TYPES &gt; should define STRATEGIC_OPTION type" time="0.000025709">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; Service Structure &gt; should export createValueHypothesis function" time="0.000025083">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; Service Structure &gt; should export getValueSummary function" time="0.000024042">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="EconomicsService &gt; Service Structure &gt; should export detectMissingValueHypotheses function" time="0.000025167">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="ReportingService &gt; Service Structure &gt; should export generateExecutiveOverview function" time="0.00489875">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="ReportingService &gt; Service Structure &gt; should export generateProjectHealthReport function" time="0.000066458">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="ReportingService &gt; Service Structure &gt; should export generateGovernanceReport function" time="0.000042125">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NarrativeService &gt; Service Structure &gt; should export generateWeeklySummary function" time="0.004696125">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NarrativeService &gt; Service Structure &gt; should export generateExecutiveMemo function" time="0.0001565">
        </testcase>
        <testcase classname="tests/unit/backend/scmsServices.test.js" name="NarrativeService &gt; Service Structure &gt; should export generateProgressNarrative function" time="0.000052333">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/stageGateService.test.js" timestamp="2025-12-20T16:07:59.288Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.028383333">
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; getGateType &gt; should return correct gate type" time="0.024921042">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; evaluateGate &gt; should evaluate criteria correctly (All Met)" time="0.000572541">
        </testcase>
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; evaluateGate &gt; should return NOT_READY if one criterion fails" time="0.000441333">
        </testcase>
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; evaluateGate &gt; should fail gate if context JSON is invalid" time="0.000405167">
        </testcase>
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; passGate &gt; should pass gate" time="0.000572167">
        </testcase>
        <testcase classname="tests/unit/backend/stageGateService.test.js" name="StageGateService &gt; passGate &gt; should handle db error" time="0.000804208">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/tokenBillingService.test.js" timestamp="2025-12-20T16:07:59.288Z" hostname="MacBook-Pro-Piotr.local" tests="16" failures="0" errors="0" skipped="0" time="0.200681791">
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Margins &gt; should get margins without throwing" time="0.000702833">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Margins &gt; should get specific margin by source type" time="0.000440208">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Packages &gt; should get packages without throwing" time="0.000189458">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Packages &gt; should upsert package without throwing" time="0.00096925">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Balance &gt; should get balance without throwing" time="0.000196125">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Balance &gt; should ensure balance creates record" time="0.000236417">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Balance &gt; should credit tokens to user" time="0.001055">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Balance Check &gt; should check sufficient balance" time="0.000430208">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Margin Updates &gt; should update margin and persist changes" time="0.001005833">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Token Deduction / Usage &gt; should deduct tokens correctly for platform usage" time="0.001214042">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Token Deduction / Usage &gt; should handle markup multipliers" time="0.001572875">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; User API Keys (BYOK) &gt; should add, get and delete user API keys" time="0.047123542">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Source Determination &gt; should prefer BYOK if available and requested" time="0.043767333">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Source Determination &gt; should fallback to platform if no BYOK key" time="0.00057975">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Analytics &gt; should retrieve revenue analytics" time="0.0004345">
        </testcase>
        <testcase classname="tests/unit/backend/tokenBillingService.test.js" name="TokenBillingService - Integration &gt; Analytics &gt; should retrieve transactions for user" time="0.001244792">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/usageService.test.js" timestamp="2025-12-20T16:07:59.289Z" hostname="MacBook-Pro-Piotr.local" tests="4" failures="0" errors="0" skipped="0" time="0.114923375">
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService - Integration &gt; Record Usage &gt; should record token usage without throwing" time="0.001849125">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService - Integration &gt; Record Usage &gt; should record storage usage without throwing" time="0.000255042">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService - Integration &gt; Get Usage &gt; should get current usage without throwing" time="0.000585709">
        </testcase>
        <testcase classname="tests/unit/backend/usageService.test.js" name="UsageService - Integration &gt; Check Quota &gt; should check quota without throwing" time="0.000376459">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/hooks/useAIStream.test.ts" timestamp="2025-12-20T16:07:59.289Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.025701084">
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; initializes with correct default values" time="0.005972">
        </testcase>
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; calls API with correct parameters" time="0.005598458">
            <system-out>
[DEBUG-D] startStream entry: {
  msgLength: [33m12[39m,
  historyLength: [33m0[39m,
  hasSystemPrompt: [33mtrue[39m,
  hasContext: [33mfalse[39m
}
[DEBUG-A,C] startStream onDone: { responseLength: [33m11[39m }

            </system-out>
        </testcase>
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; updates stream content as chunks arrive" time="0.00146275">
            <system-out>
[DEBUG-D] startStream entry: {
  msgLength: [33m4[39m,
  historyLength: [33m0[39m,
  hasSystemPrompt: [33mfalse[39m,
  hasContext: [33mfalse[39m
}
[DEBUG-A,C] startStream onDone: { responseLength: [33m11[39m }

            </system-out>
        </testcase>
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; calls onStreamDone callback when stream completes" time="0.003506792">
            <system-out>
[DEBUG-D] startStream entry: {
  msgLength: [33m4[39m,
  historyLength: [33m0[39m,
  hasSystemPrompt: [33mfalse[39m,
  hasContext: [33mfalse[39m
}
[DEBUG-A,C] startStream onDone: { responseLength: [33m8[39m }

            </system-out>
        </testcase>
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; handles stream errors" time="0.004817083">
            <system-out>
[DEBUG-D] startStream entry: {
  msgLength: [33m4[39m,
  historyLength: [33m0[39m,
  hasSystemPrompt: [33mfalse[39m,
  hasContext: [33mfalse[39m
}

[DEBUG-A,C] startStream error: { errorMsg: [32m&apos;Error: Stream failed&apos;[39m }

            </system-out>
            <system-err>
AI Stream Error: Error: Stream failed
    at [90m/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mtests/unit/hooks/useAIStream.test.ts:87:23
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (&lt;anonymous&gt;)
    at runWithTimeout [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:37
    at Traces.$ [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/traces.U4xDYhzZ.js:115:27[90m)[39m
    at trace [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4mvitest[24m/dist/chunks/test.B8ej_ZHS.js:239:21[90m)[39m
    at runTest [90m(file:///Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mnode_modules/[4m@vitest/runner[24m/dist/index.js:1653:12[90m)[39m

            </system-err>
        </testcase>
        <testcase classname="tests/unit/hooks/useAIStream.test.ts" name="Hook Test: useAIStream &gt; sets bot typing state correctly" time="0.003434792">
            <system-out>
[DEBUG-D] startStream entry: {
  msgLength: [33m4[39m,
  historyLength: [33m0[39m,
  hasSystemPrompt: [33mfalse[39m,
  hasContext: [33mfalse[39m
}
[DEBUG-A,C] startStream onDone: { responseLength: [33m11[39m }

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/hooks/useIndependentAI.test.ts" timestamp="2025-12-20T16:07:59.289Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.00956325">
        <testcase classname="tests/unit/hooks/useIndependentAI.test.ts" name="useIndependentAI &gt; initializes with default state" time="0.005698167">
        </testcase>
        <testcase classname="tests/unit/hooks/useIndependentAI.test.ts" name="useIndependentAI &gt; callAI manages loading state and accumulates stream" time="0.001372208">
        </testcase>
        <testcase classname="tests/unit/hooks/useIndependentAI.test.ts" name="useIndependentAI &gt; refineText calls callAI with correct prompt and system instruction" time="0.001801208">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/hooks/useScreenContext.test.ts" timestamp="2025-12-20T16:07:59.290Z" hostname="MacBook-Pro-Piotr.local" tests="2" failures="0" errors="0" skipped="0" time="0.01059825">
        <testcase classname="tests/unit/hooks/useScreenContext.test.ts" name="Hook Test: useScreenContext &gt; sets screen context on mount after debounce" time="0.007534167">
        </testcase>
        <testcase classname="tests/unit/hooks/useScreenContext.test.ts" name="Hook Test: useScreenContext &gt; updates context when data changes" time="0.002365416">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/adminMiddleware.test.js" timestamp="2025-12-20T16:07:59.290Z" hostname="MacBook-Pro-Piotr.local" tests="4" failures="0" errors="0" skipped="0" time="0.004418083">
        <testcase classname="tests/unit/backend/middleware/adminMiddleware.test.js" name="AdminMiddleware &gt; should call next() if user is admin" time="0.002181333">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/adminMiddleware.test.js" name="AdminMiddleware &gt; should call next() if user is superadmin" time="0.000364583">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/adminMiddleware.test.js" name="AdminMiddleware &gt; should return 403 if user is not admin" time="0.001065166">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/adminMiddleware.test.js" name="AdminMiddleware &gt; should return 401 if verify failed (bad signature)" time="0.000252125">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/auditLog.test.js" timestamp="2025-12-20T16:07:59.290Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.167502584">
        <testcase classname="tests/unit/backend/middleware/auditLog.test.js" name="AuditLog Middleware &gt; should call next() and override res.end" time="0.114125541">
            <system-out>
[Database] Selected: SQLite

[DB:zzrzk9] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

Projects table created successfully (or already exists).

Database initialization complete.

[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/auditLog.test.js" name="AuditLog Middleware &gt; should log activity when res.end is called for 2xx POST" time="0.052130042">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/auditLog.test.js" name="AuditLog Middleware &gt; should NOT log for GET requests" time="0.000641">
            <system-out>
[Database] Selected: SQLite

            </system-out>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/authMiddleware.test.js" timestamp="2025-12-20T16:07:59.290Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="4" time="0.002398208">
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should return 403 if no token provided" time="0.001510334">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should return 401 if token expired" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should return 401 if token invalid" time="0.000297709">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should call next() if token valid and no revocation check needed (no jti)" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should check revocation if jti is present" time="0">
            <skipped/>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/authMiddleware.test.js" name="AuthMiddleware &gt; should return 401 if token is revoked" time="0">
            <skipped/>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/planLimits.test.js" timestamp="2025-12-20T16:07:59.290Z" hostname="MacBook-Pro-Piotr.local" tests="8" failures="0" errors="0" skipped="0" time="0.112928542">
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should return 403 if no organization found in user" time="0.104344333">
            <system-out>
[Database] Selected: SQLite

[DB:oy88] Initializing database at :memory:
Connected to the SQLite database.
Created billing tables and seeded default subscription plans.
Seeded SuperAdmin and DBR77 Users.

Projects table created successfully (or already exists).

Database initialization complete.

[Database] Selected: SQLite

            </system-out>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should return 404 if organization does not exist in DB" time="0.000983667">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should allow request if within limit (Free plan)" time="0.001186416">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should block request if limit reached (Free plan)" time="0.00164475">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should allow request if within limit (Pro plan)" time="0.001079375">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should treat trial status as pro plan" time="0.001085792">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should handle undefined limits gracefully (warn and allow)" time="0.000910334">
            <system-err>
Limit key unknown_limit_key not found for plan free

            </system-err>
        </testcase>
        <testcase classname="tests/unit/backend/middleware/planLimits.test.js" name="PlanLimits Middleware &gt; should check max_members limit" time="0.001060875">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" timestamp="2025-12-20T16:07:59.291Z" hostname="MacBook-Pro-Piotr.local" tests="6" failures="0" errors="0" skipped="0" time="0.12273925">
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should skip check if no project_id provided" time="0.001047583">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should allow request if quota is sufficient" time="0.001123667">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should allow request if limit is NULL (unlimited)" time="0.000669125">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should block 429 if quota exceeded" time="0.001668959">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should cleanup temp file if quota exceeded" time="0.000733292">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/projectQuotaMiddleware.test.js" name="Project Quota Middleware (Integration) &gt; should handle errors gracefully (e.g. project not found)" time="0.001157958">
            <system-err>
Project quota check error: Error: Project not found
    at Statement.&lt;anonymous&gt; [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mserver/services/usageService.js:300:41[90m)[39m
    at Statement.replacement [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mserver/node_modules/[4msqlite3[24m/lib/trace.js:25:27[90m)[39m
    at Statement.replacement [90m(/Users/piotrwisniewski/Documents/Antygracity/DRD/consultify/[39mserver/node_modules/[4msqlite3[24m/lib/trace.js:25:27[90m)[39m

            </system-err>
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/quotaMiddleware.test.js" timestamp="2025-12-20T16:07:59.291Z" hostname="MacBook-Pro-Piotr.local" tests="8" failures="0" errors="0" skipped="0" time="0.164419542">
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceTokenQuota &gt; should return 401 if no orgId" time="0.000955">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceTokenQuota &gt; should allow if usage is below limit" time="0.002269125">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceTokenQuota &gt; should block 429 if usage exceeds limit" time="0.001450042">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceTokenQuota &gt; should allow if overage is enabled even if exceeded" time="0.001193417">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceTokenQuota &gt; should set warning headers if &gt; 80%" time="0.0014775">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceStorageQuota &gt; should allow if allowed" time="0.001191834">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; enforceStorageQuota &gt; should block 429 if exceeded" time="0.000758541">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/quotaMiddleware.test.js" name="Quota Middleware (Integration) &gt; recordTokenUsageAfterResponse &gt; should insert usage record into DB" time="0.053142583">
        </testcase>
    </testsuite>
    <testsuite name="tests/unit/backend/middleware/superAdminMiddleware.test.js" timestamp="2025-12-20T16:07:59.292Z" hostname="MacBook-Pro-Piotr.local" tests="3" failures="0" errors="0" skipped="0" time="0.004245833">
        <testcase classname="tests/unit/backend/middleware/superAdminMiddleware.test.js" name="SuperAdminMiddleware &gt; should call next() if user is superadmin" time="0.002191916">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/superAdminMiddleware.test.js" name="SuperAdminMiddleware &gt; should return 403 if user is admin (not super)" time="0.00121325">
        </testcase>
        <testcase classname="tests/unit/backend/middleware/superAdminMiddleware.test.js" name="SuperAdminMiddleware &gt; should return 401 if token is invalid (bad signature)" time="0.000279167">
        </testcase>
    </testsuite>
</testsuites>
